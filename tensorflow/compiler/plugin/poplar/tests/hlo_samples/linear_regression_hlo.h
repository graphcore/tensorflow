/* Copyright 2022 The TensorFlow Authors. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
==============================================================================*/

#ifndef TENSORFLOW_COMPILER_PLUGIN_POPLAR_TESTS_HLO_SAMPLES_LINEAR_REGRESSION_HLO_H_
#define TENSORFLOW_COMPILER_PLUGIN_POPLAR_TESTS_HLO_SAMPLES_LINEAR_REGRESSION_HLO_H_

const char* linear_regression_hlo = R"(
HloModule a_inference_train_function_640__XlaMustCompile_true_config_proto___n_007_n_0...02_001_000__executor_type____.412

%region_0.38 (Arg_0.39: f32[], Arg_1.40: f32[]) -> f32[] {
  %Arg_0.39 = f32[] parameter(0)
  %Arg_1.40 = f32[] parameter(1)
  ROOT %add.41 = f32[] add(f32[] %Arg_0.39, f32[] %Arg_1.40), metadata={op_name="gradient_tape/while/sequential/dense/BiasAdd/BiasAddGrad"}
}

%sum.42 (x.43: f16[], y.44: f16[]) -> f16[] {
  %x.43 = f16[] parameter(0)
  %y.44 = f16[] parameter(1)
  ROOT %add.45 = f16[] add(f16[] %x.43, f16[] %y.44)
}

%sum.46 (x.47: f16[], y.48: f16[]) -> f16[] {
  %x.47 = f16[] parameter(0)
  %y.48 = f16[] parameter(1)
  ROOT %add.49 = f16[] add(f16[] %x.47, f16[] %y.48)
}

%while_mean_absolute_error_Mean-reduction.50 (x.51: f32[], y.52: f32[]) -> f32[] {
  %x.51 = f32[] parameter(0)
  %y.52 = f32[] parameter(1)
  ROOT %add.53 = f32[] add(f32[] %x.51, f32[] %y.52)
}

%while_mean_absolute_error_weighted_loss_Sum-reduction.54 (x.55: f32[], y.56: f32[]) -> f32[] {
  %x.55 = f32[] parameter(0)
  %y.56 = f32[] parameter(1)
  ROOT %add.57 = f32[] add(f32[] %x.55, f32[] %y.56)
}

%while_body_428_const_0_rearrange_0__.58 (arg_tuple.59: (s32[], s32[], s32[], s32[], f16[1,1], /*index=5*/f16[1,1], s32[], f16[1,1], f16[1], f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1], f16[1,1], f16[1], f16[1])) -> (s32[], s32[], s32[], s32[], f16[1,1], /*index=5*/f16[1,1], s32[], f16[1,1], f16[1], f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1], f16[1,1], f16[1], f16[1]) {
  %constant.79 = s32[] constant(1), metadata={op_type="Maximum" op_name="gradient_tape/while/mean_absolute_error/Maximum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.80 = s32[2]{0} broadcast(s32[] %constant.79), dimensions={}, metadata={op_type="Maximum" op_name="gradient_tape/while/mean_absolute_error/Maximum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.81 = s32[] constant(1), metadata={op_type="Maximum" op_name="gradient_tape/while/mean_absolute_error/Maximum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.87 = s32[] constant(1), metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_absolute_error/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.88 = s32[2]{0} broadcast(s32[] %constant.87), dimensions={}, metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_absolute_error/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.89 = s32[] constant(1), metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_absolute_error/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.90 = s32[2]{0} broadcast(s32[] %constant.89), dimensions={}, metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_absolute_error/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.82 = s32[] constant(1), metadata={op_type="Maximum" op_name="gradient_tape/while/mean_absolute_error/Maximum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.83 = s32[2]{0} broadcast(s32[] %constant.82), dimensions={}, metadata={op_type="Maximum" op_name="gradient_tape/while/mean_absolute_error/Maximum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.84 = s32[] constant(1), metadata={op_type="Maximum" op_name="gradient_tape/while/mean_absolute_error/Maximum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.85 = s32[2]{0} broadcast(s32[] %constant.84), dimensions={}, metadata={op_type="Maximum" op_name="gradient_tape/while/mean_absolute_error/Maximum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %maximum.86 = s32[2]{0} maximum(s32[2]{0} %broadcast.83, s32[2]{0} %broadcast.85), metadata={op_type="Maximum" op_name="gradient_tape/while/mean_absolute_error/Maximum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %divide.93 = s32[2]{0} divide(s32[2]{0} %broadcast.90, s32[2]{0} %maximum.86), metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_absolute_error/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %multiply.99 = s32[2]{0} multiply(s32[2]{0} %divide.93, s32[2]{0} %maximum.86), metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_absolute_error/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %compare.100 = pred[2]{0} compare(s32[2]{0} %multiply.99, s32[2]{0} %broadcast.90), direction=NE, metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_absolute_error/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.91 = s32[] constant(0), metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_absolute_error/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.96 = s32[2]{0} broadcast(s32[] %constant.91), dimensions={}, metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_absolute_error/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %compare.97 = pred[2]{0} compare(s32[2]{0} %broadcast.90, s32[2]{0} %broadcast.96), direction=LT, metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_absolute_error/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.94 = s32[2]{0} broadcast(s32[] %constant.91), dimensions={}, metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_absolute_error/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %compare.95 = pred[2]{0} compare(s32[2]{0} %maximum.86, s32[2]{0} %broadcast.94), direction=LT, metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_absolute_error/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %compare.98 = pred[2]{0} compare(pred[2]{0} %compare.97, pred[2]{0} %compare.95), direction=NE, metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_absolute_error/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %and.101 = pred[2]{0} and(pred[2]{0} %compare.100, pred[2]{0} %compare.98), metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_absolute_error/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.92 = s32[] constant(1), metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_absolute_error/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.102 = s32[2]{0} broadcast(s32[] %constant.92), dimensions={}, metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_absolute_error/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %subtract.103 = s32[2]{0} subtract(s32[2]{0} %divide.93, s32[2]{0} %broadcast.102), metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_absolute_error/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %select.104 = s32[2]{0} select(pred[2]{0} %and.101, s32[2]{0} %subtract.103, s32[2]{0} %divide.93), metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_absolute_error/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.114 = f16[] constant(1), metadata={op_type="Sub" op_name="while/Adam/sub_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=141}
  %constant.115 = f16[] constant(1), metadata={op_type="Sub" op_name="while/Adam/sub_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=141}
  %arg_tuple.59 = (s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.73 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.59), index=13
  %convert.113 = f16[] convert(f32[] %get-tuple-element.73), metadata={op_type="Cast" op_name="while/Adam/Cast_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=793}
  %subtract.116 = f16[] subtract(f16[] %constant.115, f16[] %convert.113), metadata={op_type="Sub" op_name="while/Adam/sub_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=141}
  %constant.118 = f16[] constant(1), metadata={op_type="Sub" op_name="while/Adam/sub_3" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=144}
  %constant.119 = f16[] constant(1), metadata={op_type="Sub" op_name="while/Adam/sub_3" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=144}
  %get-tuple-element.74 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.59), index=14
  %convert.117 = f16[] convert(f32[] %get-tuple-element.74), metadata={op_type="Cast" op_name="while/Adam/Cast_3" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=793}
  %subtract.120 = f16[] subtract(f16[] %constant.119, f16[] %convert.117), metadata={op_type="Sub" op_name="while/Adam/sub_3" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=144}
  %constant.122 = s64[] constant(1), metadata={op_type="AddV2" op_name="while/Adam/add" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=127}
  %constant.127 = f16[] constant(1), metadata={op_type="Sub" op_name="while/Adam/sub_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=133}
  %constant.131 = f16[] constant(1), metadata={op_type="Sub" op_name="while/Adam/sub" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=133}
  %get-tuple-element.71 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.59), index=11
  %convert.121 = f16[] convert(f32[] %get-tuple-element.71), metadata={op_type="Cast" op_name="while/Adam/Cast" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=793}
  %constant.132 = f16[] constant(1), metadata={op_type="Sub" op_name="while/Adam/sub" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=133}
  %get-tuple-element.72 = s64[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.59), index=12
  %constant.123 = s64[] constant(1), metadata={op_type="AddV2" op_name="while/Adam/add" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=127}
  %add.124 = s64[] add(s64[] %get-tuple-element.72, s64[] %constant.123), metadata={op_type="AddV2" op_name="while/Adam/add" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=127}
  %convert.125 = f16[] convert(s64[] %add.124), metadata={op_type="Cast" op_name="while/Adam/Cast_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=127}
  %power.130 = f16[] power(f16[] %convert.117, f16[] %convert.125), metadata={op_type="Pow" op_name="while/Adam/Pow_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=131}
  %subtract.133 = f16[] subtract(f16[] %constant.132, f16[] %power.130), metadata={op_type="Sub" op_name="while/Adam/sub" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=133}
  %sqrt.134 = f16[] sqrt(f16[] %subtract.133), metadata={op_name="while/Adam/Sqrt"}
  %constant.128 = f16[] constant(1), metadata={op_type="Sub" op_name="while/Adam/sub_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=133}
  %power.126 = f16[] power(f16[] %convert.113, f16[] %convert.125), metadata={op_type="Pow" op_name="while/Adam/Pow" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=130}
  %subtract.129 = f16[] subtract(f16[] %constant.128, f16[] %power.126), metadata={op_type="Sub" op_name="while/Adam/sub_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=133}
  %divide.135 = f16[] divide(f16[] %sqrt.134, f16[] %subtract.129), metadata={op_type="RealDiv" op_name="while/Adam/truediv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=133}
  %multiply.136 = f16[] multiply(f16[] %convert.121, f16[] %divide.135), metadata={op_type="Mul" op_name="while/Adam/mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=133}
  %constant.137 = s32[] constant(1), metadata={op_type="AddV2" op_name="while/add" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.141 = f16[] constant(1.1921e-07), metadata={op_type="Maximum" op_name="while/sequential/normalization/Maximum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/preprocessing/normalization.py" source_line=253}
  %constant.153 = f16[1,1]{1,0} constant({ {1} }), metadata={op_type="Mul" op_name="gradient_tape/while/mean_absolute_error/Abs/mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.154 = f16[1,1]{1,0} constant({ {1} }), metadata={op_type="Mul" op_name="gradient_tape/while/mean_absolute_error/Abs/mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %after-all.105 = token[] after-all(), metadata={op_type="PopDatastreamInfeedDequeue" op_name="while/PopDatastreamInfeedDequeue" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_pop_datastream_ops.py" source_line=1198}
  %infeed.106 = ((f16[1]{0}, f32[1]{0}), token[]) infeed(token[] %after-all.105), infeed_config="\022\0011\"\002\023\001(\003", metadata={op_type="PopDatastreamInfeedDequeue" op_name="while/PopDatastreamInfeedDequeue" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_pop_datastream_ops.py" source_line=1198}
  %get-tuple-element.107 = (f16[1]{0}, f32[1]{0}) get-tuple-element(((f16[1]{0}, f32[1]{0}), token[]) %infeed.106), index=0, metadata={op_type="PopDatastreamInfeedDequeue" op_name="while/PopDatastreamInfeedDequeue" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_pop_datastream_ops.py" source_line=1198}
  %get-tuple-element.108 = f16[1]{0} get-tuple-element((f16[1]{0}, f32[1]{0}) %get-tuple-element.107), index=0, metadata={op_type="PopDatastreamInfeedDequeue" op_name="while/PopDatastreamInfeedDequeue" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_pop_datastream_ops.py" source_line=1198}
  %reshape.110 = f16[1,1]{1,0} reshape(f16[1]{0} %get-tuple-element.108), metadata={op_type="ExpandDims" op_name="while/ExpandDims" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/engine/data_adapter.py" source_line=1449}
  %get-tuple-element.64 = f16[1,1]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.59), index=4
  %subtract.145 = f16[1,1]{1,0} subtract(f16[1,1]{1,0} %reshape.110, f16[1,1]{1,0} %get-tuple-element.64), metadata={op_type="Sub" op_name="while/sequential/normalization/sub" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/preprocessing/normalization.py" source_line=252}
  %get-tuple-element.65 = f16[1,1]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.59), index=5
  %sqrt.140 = f16[1,1]{1,0} sqrt(f16[1,1]{1,0} %get-tuple-element.65), metadata={op_name="while/sequential/normalization/Sqrt"}
  %constant.142 = f16[] constant(1.1921e-07), metadata={op_type="Maximum" op_name="while/sequential/normalization/Maximum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/preprocessing/normalization.py" source_line=253}
  %broadcast.143 = f16[1,1]{1,0} broadcast(f16[] %constant.142), dimensions={}, metadata={op_type="Maximum" op_name="while/sequential/normalization/Maximum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/preprocessing/normalization.py" source_line=253}
  %maximum.144 = f16[1,1]{1,0} maximum(f16[1,1]{1,0} %sqrt.140, f16[1,1]{1,0} %broadcast.143), metadata={op_type="Maximum" op_name="while/sequential/normalization/Maximum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/preprocessing/normalization.py" source_line=253}
  %divide.146 = f16[1,1]{1,0} divide(f16[1,1]{1,0} %subtract.145, f16[1,1]{1,0} %maximum.144), metadata={op_type="RealDiv" op_name="while/sequential/normalization/truediv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/preprocessing/normalization.py" source_line=253}
  %get-tuple-element.67 = f16[1,1]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.59), index=7
  %dot.147 = f16[1,1]{1,0} dot(f16[1,1]{1,0} %divide.146, f16[1,1]{1,0} %get-tuple-element.67), lhs_contracting_dims={1}, rhs_contracting_dims={0}, metadata={op_type="MatMul" op_name="while/sequential/dense/MatMul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/core.py" source_line=1229}
  %transpose.148 = f16[1,1]{1,0} transpose(f16[1,1]{1,0} %dot.147), dimensions={0,1}, metadata={op_type="MatMul" op_name="while/sequential/dense/MatMul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/core.py" source_line=1229}
  %get-tuple-element.68 = f16[1]{0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.59), index=8
  %broadcast.149 = f16[1,1]{1,0} broadcast(f16[1]{0} %get-tuple-element.68), dimensions={1}, metadata={op_type="BiasAdd" op_name="while/sequential/dense/BiasAdd" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/core.py" source_line=1240}
  %add.150 = f16[1,1]{1,0} add(f16[1,1]{1,0} %transpose.148, f16[1,1]{1,0} %broadcast.149), metadata={op_type="BiasAdd" op_name="while/sequential/dense/BiasAdd" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/core.py" source_line=1240}
  %get-tuple-element.109 = f32[1]{0} get-tuple-element((f16[1]{0}, f32[1]{0}) %get-tuple-element.107), index=1, metadata={op_type="PopDatastreamInfeedDequeue" op_name="while/PopDatastreamInfeedDequeue" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_pop_datastream_ops.py" source_line=1198}
  %reshape.111 = f32[1,1]{1,0} reshape(f32[1]{0} %get-tuple-element.109), metadata={op_type="ExpandDims" op_name="while/ExpandDims_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/engine/data_adapter.py" source_line=1449}
  %convert.112 = f16[1,1]{1,0} convert(f32[1,1]{1,0} %reshape.111), metadata={op_type="Cast" op_name="while/Cast" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/engine/compile_utils.py" source_line=682}
  %subtract.151 = f16[1,1]{1,0} subtract(f16[1,1]{1,0} %add.150, f16[1,1]{1,0} %convert.112), metadata={op_type="Sub" op_name="while/mean_absolute_error/sub" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/losses.py" source_line=1332}
  %sign.152 = f16[1,1]{1,0} sign(f16[1,1]{1,0} %subtract.151), metadata={op_name="gradient_tape/while/mean_absolute_error/Abs/Sign"}
  %multiply.155 = f16[1,1]{1,0} multiply(f16[1,1]{1,0} %constant.154, f16[1,1]{1,0} %sign.152), metadata={op_type="Mul" op_name="gradient_tape/while/mean_absolute_error/Abs/mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %negate.156 = f16[1,1]{1,0} negate(f16[1,1]{1,0} %multiply.155), metadata={op_type="Neg" op_name="gradient_tape/while/mean_absolute_error/sub/Neg" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.232 = f32[] constant(1), metadata={op_type="Mul" op_name="while/mean_absolute_error/weighted_loss/Mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=321}
  %constant.242 = f32[] constant(1), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_absolute_error/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.250 = f32[] constant(1), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_absolute_error/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.258 = f32[] constant(1), metadata={op_type="Mul" op_name="gradient_tape/while/mean_absolute_error/weighted_loss/value/mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.261 = s32[0]{0} constant({}), metadata={op_type="Reshape" op_name="gradient_tape/while/mean_absolute_error/weighted_loss/value/Reshape_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.259 = f32[] constant(1), metadata={op_type="Mul" op_name="gradient_tape/while/mean_absolute_error/weighted_loss/value/mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.251 = f32[] constant(1), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_absolute_error/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.252 = f32[] constant(0), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_absolute_error/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %compare.253 = pred[] compare(f32[] %constant.251, f32[] %constant.252), direction=EQ, metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_absolute_error/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.254 = f32[] constant(0), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_absolute_error/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.255 = f32[] broadcast(f32[] %constant.254), dimensions={}, metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_absolute_error/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.243 = f32[] constant(1), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_absolute_error/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.244 = f32[] constant(0), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_absolute_error/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %compare.245 = pred[] compare(f32[] %constant.243, f32[] %constant.244), direction=EQ, metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_absolute_error/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.246 = f32[] constant(0), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_absolute_error/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.247 = f32[] broadcast(f32[] %constant.246), dimensions={}, metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_absolute_error/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %abs.221 = f16[1,1]{1,0} abs(f16[1,1]{1,0} %subtract.151), metadata={op_name="while/mean_absolute_error/Abs"}
  %convert.222 = f32[1,1]{1,0} convert(f16[1,1]{1,0} %abs.221), metadata={op_type="Mean" op_name="while/mean_absolute_error/Mean" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=2423}
  %constant.223 = f32[] constant(0), metadata={op_type="Mean" op_name="while/mean_absolute_error/Mean" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=2423}
  %convert.224 = f32[] convert(f32[] %constant.223), metadata={op_type="Mean" op_name="while/mean_absolute_error/Mean" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=2423}
  %reduce.225 = f32[1]{0} reduce(f32[1,1]{1,0} %convert.222, f32[] %convert.224), dimensions={1}, to_apply=%while_mean_absolute_error_Mean-reduction.50, metadata={op_type="Mean" op_name="while/mean_absolute_error/Mean" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=2423}
  %constant.226 = s32[] constant(1), metadata={op_type="Mean" op_name="while/mean_absolute_error/Mean" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=2423}
  %convert.227 = f32[] convert(s32[] %constant.226), metadata={op_type="Mean" op_name="while/mean_absolute_error/Mean" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=2423}
  %broadcast.228 = f32[1]{0} broadcast(f32[] %convert.227), dimensions={}, metadata={op_type="Mean" op_name="while/mean_absolute_error/Mean" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=2423}
  %divide.229 = f32[1]{0} divide(f32[1]{0} %reduce.225, f32[1]{0} %broadcast.228), metadata={op_type="Mean" op_name="while/mean_absolute_error/Mean" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=2423}
  %convert.230 = f16[1]{0} convert(f32[1]{0} %divide.229), metadata={op_type="Mean" op_name="while/mean_absolute_error/Mean" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=2423}
  %convert.231 = f32[1]{0} convert(f16[1]{0} %convert.230), metadata={op_type="Cast" op_name="while/mean_absolute_error/weighted_loss/Cast" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=316}
  %constant.233 = f32[] constant(1), metadata={op_type="Mul" op_name="while/mean_absolute_error/weighted_loss/Mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=321}
  %broadcast.234 = f32[1]{0} broadcast(f32[] %constant.233), dimensions={}, metadata={op_type="Mul" op_name="while/mean_absolute_error/weighted_loss/Mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=321}
  %multiply.235 = f32[1]{0} multiply(f32[1]{0} %convert.231, f32[1]{0} %broadcast.234), metadata={op_type="Mul" op_name="while/mean_absolute_error/weighted_loss/Mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=321}
  %convert.236 = f32[1]{0} convert(f32[1]{0} %multiply.235), metadata={op_type="Sum" op_name="while/mean_absolute_error/weighted_loss/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=265}
  %constant.237 = f32[] constant(0), metadata={op_type="Sum" op_name="while/mean_absolute_error/weighted_loss/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=265}
  %convert.238 = f32[] convert(f32[] %constant.237), metadata={op_type="Sum" op_name="while/mean_absolute_error/weighted_loss/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=265}
  %reduce.239 = f32[] reduce(f32[1]{0} %convert.236, f32[] %convert.238), dimensions={0}, to_apply=%while_mean_absolute_error_weighted_loss_Sum-reduction.54, metadata={op_type="Sum" op_name="while/mean_absolute_error/weighted_loss/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=265}
  %convert.240 = f32[] convert(f32[] %reduce.239), metadata={op_type="Sum" op_name="while/mean_absolute_error/weighted_loss/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=265}
  %negate.241 = f32[] negate(f32[] %convert.240), metadata={op_type="Neg" op_name="gradient_tape/while/mean_absolute_error/weighted_loss/value/Neg" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %divide.248 = f32[] divide(f32[] %negate.241, f32[] %constant.243), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_absolute_error/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %select.249 = f32[] select(pred[] %compare.245, f32[] %broadcast.247, f32[] %divide.248), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_absolute_error/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %divide.256 = f32[] divide(f32[] %select.249, f32[] %constant.251), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_absolute_error/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %select.257 = f32[] select(pred[] %compare.253, f32[] %broadcast.255, f32[] %divide.256), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_absolute_error/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %multiply.260 = f32[] multiply(f32[] %constant.259, f32[] %select.257), metadata={op_type="Mul" op_name="gradient_tape/while/mean_absolute_error/weighted_loss/value/mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reshape.262 = f32[] reshape(f32[] %multiply.260), metadata={op_type="Reshape" op_name="gradient_tape/while/mean_absolute_error/weighted_loss/value/Reshape_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.263 = f32[] constant(1), metadata={op_type="DivNoNan" op_name="while/mean_absolute_error/weighted_loss/value" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=250}
  %constant.272 = f16[] constant(1), metadata={op_type="Mul" op_name="while/Mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=421}
  %get-tuple-element.70 = f16[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.59), index=10
  %constant.276 = f16[] constant(1), metadata={op_type="AssignAddVariableOp" op_name="while/AssignAddVariableOp_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=444}
  %add.277 = f16[] add(f16[] %get-tuple-element.70, f16[] %constant.276), metadata={op_type="AssignAddVariableOp" op_name="while/AssignAddVariableOp_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=444}
  %constant.278 = f16[] constant(0), metadata={op_type="DivNoNan" op_name="while/div_no_nan" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=453}
  %compare.279 = pred[] compare(f16[] %add.277, f16[] %constant.278), direction=EQ, metadata={op_type="DivNoNan" op_name="while/div_no_nan" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=453}
  %constant.280 = f16[] constant(0), metadata={op_type="DivNoNan" op_name="while/div_no_nan" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=453}
  %broadcast.281 = f16[] broadcast(f16[] %constant.280), dimensions={}, metadata={op_type="DivNoNan" op_name="while/div_no_nan" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=453}
  %get-tuple-element.69 = f16[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.59), index=9
  %constant.264 = f32[] constant(1), metadata={op_type="DivNoNan" op_name="while/mean_absolute_error/weighted_loss/value" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=250}
  %constant.265 = f32[] constant(0), metadata={op_type="DivNoNan" op_name="while/mean_absolute_error/weighted_loss/value" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=250}
  %compare.266 = pred[] compare(f32[] %constant.264, f32[] %constant.265), direction=EQ, metadata={op_type="DivNoNan" op_name="while/mean_absolute_error/weighted_loss/value" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=250}
  %constant.267 = f32[] constant(0), metadata={op_type="DivNoNan" op_name="while/mean_absolute_error/weighted_loss/value" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=250}
  %broadcast.268 = f32[] broadcast(f32[] %constant.267), dimensions={}, metadata={op_type="DivNoNan" op_name="while/mean_absolute_error/weighted_loss/value" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=250}
  %divide.269 = f32[] divide(f32[] %convert.240, f32[] %constant.264), metadata={op_type="DivNoNan" op_name="while/mean_absolute_error/weighted_loss/value" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=250}
  %select.270 = f32[] select(pred[] %compare.266, f32[] %broadcast.268, f32[] %divide.269), metadata={op_type="DivNoNan" op_name="while/mean_absolute_error/weighted_loss/value" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=250}
  %convert.271 = f16[] convert(f32[] %select.270), metadata={op_type="Cast" op_name="while/mean_absolute_error/weighted_loss/Cast_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=326}
  %constant.273 = f16[] constant(1), metadata={op_type="Mul" op_name="while/Mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=421}
  %multiply.274 = f16[] multiply(f16[] %convert.271, f16[] %constant.273), metadata={op_type="Mul" op_name="while/Mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=421}
  %add.275 = f16[] add(f16[] %get-tuple-element.69, f16[] %multiply.274), metadata={op_type="AssignAddVariableOp" op_name="while/AssignAddVariableOp" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=425}
  %divide.282 = f16[] divide(f16[] %add.275, f16[] %add.277), metadata={op_type="DivNoNan" op_name="while/div_no_nan" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=453}
  %select.283 = f16[] select(pred[] %compare.279, f16[] %broadcast.281, f16[] %divide.282), metadata={op_type="DivNoNan" op_name="while/div_no_nan" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=453}
  %after-all.284 = token[] after-all(), metadata={op_type="PopDatastreamOutfeedEnqueue" op_name="while/PopDatastreamOutfeedEnqueue" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_pop_datastream_ops.py" source_line=1519}
  %outfeed.285 = token[] outfeed(f16[] %select.283, token[] %after-all.284), outfeed_shape=f16[], outfeed_config="\022\0012\"\001\023(\003", metadata={op_type="PopDatastreamOutfeedEnqueue" op_name="while/PopDatastreamOutfeedEnqueue" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_pop_datastream_ops.py" source_line=1519}
  %constant.286 = s32[] constant(1), metadata={op_type="AddV2" op_name="while/add_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.60 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.59), index=0
  %constant.287 = s32[] constant(1), metadata={op_type="AddV2" op_name="while/add_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %add.288 = s32[] add(s32[] %get-tuple-element.60, s32[] %constant.287), metadata={op_type="AddV2" op_name="while/add_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.61 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.59), index=1
  %get-tuple-element.62 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.59), index=2
  %constant.138 = s32[] constant(1), metadata={op_type="AddV2" op_name="while/add" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %add.139 = s32[] add(s32[] %get-tuple-element.62, s32[] %constant.138), metadata={op_type="AddV2" op_name="while/add" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.63 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.59), index=3
  %get-tuple-element.66 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.59), index=6
  %get-tuple-element.75 = f16[1,1]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.59), index=15
  %broadcast.202 = f16[1,1]{1,0} broadcast(f16[] %convert.113), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %multiply.203 = f16[1,1]{1,0} multiply(f16[1,1]{1,0} %get-tuple-element.75, f16[1,1]{1,0} %broadcast.202), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %dot.189 = f16[1,1]{1,0} dot(f16[1,1]{1,0} %divide.146, f16[1,1]{1,0} %multiply.155), lhs_contracting_dims={0}, rhs_contracting_dims={0}, metadata={op_type="MatMul" op_name="gradient_tape/while/sequential/dense/MatMul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %transpose.190 = f16[1,1]{1,0} transpose(f16[1,1]{1,0} %dot.189), dimensions={0,1}, metadata={op_type="MatMul" op_name="gradient_tape/while/sequential/dense/MatMul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %all-reduce.191 = f16[1,1]{1,0} all-reduce(f16[1,1]{1,0} %transpose.190), replica_groups={}, to_apply=%sum.46, metadata={op_type="IpuCrossReplicaSum" op_name="while/Adam/IpuCrossReplicaSum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_popops_ops.py" source_line=486}
  %constant.193 = f16[] constant(1), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %subtract.199 = f16[] subtract(f16[] %constant.193, f16[] %convert.113), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %broadcast.200 = f16[1,1]{1,0} broadcast(f16[] %subtract.199), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %multiply.201 = f16[1,1]{1,0} multiply(f16[1,1]{1,0} %all-reduce.191, f16[1,1]{1,0} %broadcast.200), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %add.204 = f16[1,1]{1,0} add(f16[1,1]{1,0} %multiply.203, f16[1,1]{1,0} %multiply.201), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %subtract.195 = f16[] subtract(f16[] %constant.193, f16[] %power.130), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %sqrt.196 = f16[] sqrt(f16[] %subtract.195), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %multiply.197 = f16[] multiply(f16[] %convert.121, f16[] %sqrt.196), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %subtract.194 = f16[] subtract(f16[] %constant.193, f16[] %power.126), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %divide.198 = f16[] divide(f16[] %multiply.197, f16[] %subtract.194), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %broadcast.215 = f16[1,1]{1,0} broadcast(f16[] %divide.198), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %multiply.216 = f16[1,1]{1,0} multiply(f16[1,1]{1,0} %add.204, f16[1,1]{1,0} %broadcast.215), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %get-tuple-element.76 = f16[1,1]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.59), index=16
  %broadcast.209 = f16[1,1]{1,0} broadcast(f16[] %convert.117), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %multiply.210 = f16[1,1]{1,0} multiply(f16[1,1]{1,0} %get-tuple-element.76, f16[1,1]{1,0} %broadcast.209), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %multiply.206 = f16[1,1]{1,0} multiply(f16[1,1]{1,0} %all-reduce.191, f16[1,1]{1,0} %all-reduce.191), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %subtract.205 = f16[] subtract(f16[] %constant.193, f16[] %convert.117), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %broadcast.207 = f16[1,1]{1,0} broadcast(f16[] %subtract.205), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %multiply.208 = f16[1,1]{1,0} multiply(f16[1,1]{1,0} %multiply.206, f16[1,1]{1,0} %broadcast.207), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %add.211 = f16[1,1]{1,0} add(f16[1,1]{1,0} %multiply.210, f16[1,1]{1,0} %multiply.208), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %sqrt.212 = f16[1,1]{1,0} sqrt(f16[1,1]{1,0} %add.211), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %constant.192 = f16[] constant(1.1921e-07), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %broadcast.213 = f16[1,1]{1,0} broadcast(f16[] %constant.192), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %add.214 = f16[1,1]{1,0} add(f16[1,1]{1,0} %sqrt.212, f16[1,1]{1,0} %broadcast.213), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %divide.217 = f16[1,1]{1,0} divide(f16[1,1]{1,0} %multiply.216, f16[1,1]{1,0} %add.214), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %subtract.218 = f16[1,1]{1,0} subtract(f16[1,1]{1,0} %get-tuple-element.67, f16[1,1]{1,0} %divide.217), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %tuple.289 = (f16[1,1]{1,0}) tuple(f16[1,1]{1,0} %subtract.218), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.290 = f16[1,1]{1,0} get-tuple-element((f16[1,1]{1,0}) %tuple.289), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.77 = f16[1]{0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.59), index=17
  %broadcast.172 = f16[1]{0} broadcast(f16[] %convert.113), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %multiply.173 = f16[1]{0} multiply(f16[1]{0} %get-tuple-element.77, f16[1]{0} %broadcast.172), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %convert.158 = f32[1,1]{1,0} convert(f16[1,1]{1,0} %multiply.155), metadata={op_name="gradient_tape/while/sequential/dense/BiasAdd/BiasAddGrad"}
  %constant.157 = f32[] constant(0), metadata={op_type="BiasAddGrad" op_name="gradient_tape/while/sequential/dense/BiasAdd/BiasAddGrad" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reduce.159 = f32[1]{0} reduce(f32[1,1]{1,0} %convert.158, f32[] %constant.157), dimensions={0}, to_apply=%region_0.38, metadata={op_name="gradient_tape/while/sequential/dense/BiasAdd/BiasAddGrad"}
  %convert.160 = f16[1]{0} convert(f32[1]{0} %reduce.159), metadata={op_name="gradient_tape/while/sequential/dense/BiasAdd/BiasAddGrad"}
  %all-reduce.161 = f16[1]{0} all-reduce(f16[1]{0} %convert.160), replica_groups={}, to_apply=%sum.42, metadata={op_type="IpuCrossReplicaSum" op_name="while/Adam/IpuCrossReplicaSum_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_popops_ops.py" source_line=486}
  %constant.163 = f16[] constant(1), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %subtract.169 = f16[] subtract(f16[] %constant.163, f16[] %convert.113), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %broadcast.170 = f16[1]{0} broadcast(f16[] %subtract.169), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %multiply.171 = f16[1]{0} multiply(f16[1]{0} %all-reduce.161, f16[1]{0} %broadcast.170), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %add.174 = f16[1]{0} add(f16[1]{0} %multiply.173, f16[1]{0} %multiply.171), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %subtract.165 = f16[] subtract(f16[] %constant.163, f16[] %power.130), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %sqrt.166 = f16[] sqrt(f16[] %subtract.165), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %multiply.167 = f16[] multiply(f16[] %convert.121, f16[] %sqrt.166), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %subtract.164 = f16[] subtract(f16[] %constant.163, f16[] %power.126), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %divide.168 = f16[] divide(f16[] %multiply.167, f16[] %subtract.164), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %broadcast.185 = f16[1]{0} broadcast(f16[] %divide.168), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %multiply.186 = f16[1]{0} multiply(f16[1]{0} %add.174, f16[1]{0} %broadcast.185), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %get-tuple-element.78 = f16[1]{0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.59), index=18
  %broadcast.179 = f16[1]{0} broadcast(f16[] %convert.117), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %multiply.180 = f16[1]{0} multiply(f16[1]{0} %get-tuple-element.78, f16[1]{0} %broadcast.179), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %multiply.176 = f16[1]{0} multiply(f16[1]{0} %all-reduce.161, f16[1]{0} %all-reduce.161), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %subtract.175 = f16[] subtract(f16[] %constant.163, f16[] %convert.117), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %broadcast.177 = f16[1]{0} broadcast(f16[] %subtract.175), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %multiply.178 = f16[1]{0} multiply(f16[1]{0} %multiply.176, f16[1]{0} %broadcast.177), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %add.181 = f16[1]{0} add(f16[1]{0} %multiply.180, f16[1]{0} %multiply.178), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %sqrt.182 = f16[1]{0} sqrt(f16[1]{0} %add.181), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %constant.162 = f16[] constant(1.1921e-07), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %broadcast.183 = f16[1]{0} broadcast(f16[] %constant.162), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %add.184 = f16[1]{0} add(f16[1]{0} %sqrt.182, f16[1]{0} %broadcast.183), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %divide.187 = f16[1]{0} divide(f16[1]{0} %multiply.186, f16[1]{0} %add.184), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %subtract.188 = f16[1]{0} subtract(f16[1]{0} %get-tuple-element.68, f16[1]{0} %divide.187), metadata={op_type="ResourceApplyAdam" op_name="while/Adam/Adam/update_1/ResourceApplyAdam" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/adam.py" source_line=176}
  %tuple.291 = (f16[1]{0}) tuple(f16[1]{0} %subtract.188), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.292 = f16[1]{0} get-tuple-element((f16[1]{0}) %tuple.291), index=0, metadata={op_name="XLA_Retvals"}
  %tuple.293 = (f16[]) tuple(f16[] %add.275), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.294 = f16[] get-tuple-element((f16[]) %tuple.293), index=0, metadata={op_name="XLA_Retvals"}
  %tuple.295 = (f16[]) tuple(f16[] %add.277), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.296 = f16[] get-tuple-element((f16[]) %tuple.295), index=0, metadata={op_name="XLA_Retvals"}
  %tuple.297 = (f32[]) tuple(f32[] %get-tuple-element.71), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.298 = f32[] get-tuple-element((f32[]) %tuple.297), index=0, metadata={op_name="XLA_Retvals"}
  %constant.219 = s64[] constant(1), metadata={op_type="AssignAddVariableOp" op_name="while/Adam/Adam/AssignAddVariableOp" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=725}
  %add.220 = s64[] add(s64[] %get-tuple-element.72, s64[] %constant.219), metadata={op_type="AssignAddVariableOp" op_name="while/Adam/Adam/AssignAddVariableOp" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=725}
  %tuple.299 = (s64[]) tuple(s64[] %add.220), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.300 = s64[] get-tuple-element((s64[]) %tuple.299), index=0, metadata={op_name="XLA_Retvals"}
  %tuple.301 = (f32[]) tuple(f32[] %get-tuple-element.73), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.302 = f32[] get-tuple-element((f32[]) %tuple.301), index=0, metadata={op_name="XLA_Retvals"}
  %tuple.303 = (f32[]) tuple(f32[] %get-tuple-element.74), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.304 = f32[] get-tuple-element((f32[]) %tuple.303), index=0, metadata={op_name="XLA_Retvals"}
  %tuple.305 = (f16[1,1]{1,0}) tuple(f16[1,1]{1,0} %add.204), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.306 = f16[1,1]{1,0} get-tuple-element((f16[1,1]{1,0}) %tuple.305), index=0, metadata={op_name="XLA_Retvals"}
  %tuple.307 = (f16[1,1]{1,0}) tuple(f16[1,1]{1,0} %add.211), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.308 = f16[1,1]{1,0} get-tuple-element((f16[1,1]{1,0}) %tuple.307), index=0, metadata={op_name="XLA_Retvals"}
  %tuple.309 = (f16[1]{0}) tuple(f16[1]{0} %add.174), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.310 = f16[1]{0} get-tuple-element((f16[1]{0}) %tuple.309), index=0, metadata={op_name="XLA_Retvals"}
  %tuple.311 = (f16[1]{0}) tuple(f16[1]{0} %add.181), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.312 = f16[1]{0} get-tuple-element((f16[1]{0}) %tuple.311), index=0, metadata={op_name="XLA_Retvals"}
  ROOT %tuple.313 = (s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) tuple(s32[] %add.288, s32[] %get-tuple-element.61, s32[] %add.139, s32[] %get-tuple-element.63, f16[1,1]{1,0} %get-tuple-element.64, /*index=5*/f16[1,1]{1,0} %get-tuple-element.65, s32[] %get-tuple-element.66, f16[1,1]{1,0} %get-tuple-element.290, f16[1]{0} %get-tuple-element.292, f16[] %get-tuple-element.294, /*index=10*/f16[] %get-tuple-element.296, f32[] %get-tuple-element.298, s64[] %get-tuple-element.300, f32[] %get-tuple-element.302, f32[] %get-tuple-element.304, /*index=15*/f16[1,1]{1,0} %get-tuple-element.306, f16[1,1]{1,0} %get-tuple-element.308, f16[1]{0} %get-tuple-element.310, f16[1]{0} %get-tuple-element.312), metadata={op_name="XLA_Retvals"}
}

%while_cond_427_const_0_rearrange_0__.314 (arg_tuple.315: (s32[], s32[], s32[], s32[], f16[1,1], /*index=5*/f16[1,1], s32[], f16[1,1], f16[1], f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1], f16[1,1], f16[1], f16[1])) -> (pred[]) {
  %arg_tuple.315 = (s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.317 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.315), index=1
  %get-tuple-element.319 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.315), index=3
  %get-tuple-element.320 = f16[1,1]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.315), index=4
  %get-tuple-element.321 = f16[1,1]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.315), index=5
  %get-tuple-element.322 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.315), index=6
  %get-tuple-element.323 = f16[1,1]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.315), index=7
  %get-tuple-element.324 = f16[1]{0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.315), index=8
  %get-tuple-element.325 = f16[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.315), index=9
  %get-tuple-element.326 = f16[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.315), index=10
  %get-tuple-element.327 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.315), index=11
  %get-tuple-element.328 = s64[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.315), index=12
  %get-tuple-element.329 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.315), index=13
  %get-tuple-element.330 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.315), index=14
  %get-tuple-element.331 = f16[1,1]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.315), index=15
  %get-tuple-element.332 = f16[1,1]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.315), index=16
  %get-tuple-element.333 = f16[1]{0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.315), index=17
  %get-tuple-element.334 = f16[1]{0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.315), index=18
  %constant.335 = s32[] constant(80), metadata={op_type="Less" op_name="while/Less" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.338 = s32[] constant(80), metadata={op_type="Less" op_name="while/Less_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.316 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.315), index=0
  %constant.339 = s32[] constant(80), metadata={op_type="Less" op_name="while/Less_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %compare.340 = pred[] compare(s32[] %get-tuple-element.316, s32[] %constant.339), direction=LT, metadata={op_type="Less" op_name="while/Less_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.318 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %arg_tuple.315), index=2
  %constant.336 = s32[] constant(80), metadata={op_type="Less" op_name="while/Less" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %compare.337 = pred[] compare(s32[] %get-tuple-element.318, s32[] %constant.336), direction=LT, metadata={op_type="Less" op_name="while/Less" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %and.341 = pred[] and(pred[] %compare.340, pred[] %compare.337), metadata={op_type="LogicalAnd" op_name="while/LogicalAnd" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  ROOT %tuple.342 = (pred[]) tuple(pred[] %and.341), metadata={op_name="XLA_Retvals"}
}

%cond_wrapper.343 (inputs.344: (s32[], s32[], s32[], s32[], f16[1,1], /*index=5*/f16[1,1], s32[], f16[1,1], f16[1], f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1], f16[1,1], f16[1], f16[1])) -> pred[] {
  %inputs.344 = (s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) parameter(0)
  %call.345 = (pred[]) call((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %inputs.344), to_apply=%while_cond_427_const_0_rearrange_0__.314
  ROOT %get-tuple-element.346 = pred[] get-tuple-element((pred[]) %call.345), index=0
}

ENTRY %a_inference_train_function_640__XlaMustCompile_true_config_proto___n_007_n_0...02_001_000__executor_type____.412 (arg0.1: f16[1,1], arg1.2: f16[1,1], arg2.3: f16[1,1], arg3.4: f16[1], arg4.5: f16[], arg5.6: f16[], arg6.7: f32[], arg7.8: s64[], arg8.9: f32[], arg9.10: f32[], arg10.11: f16[1,1], arg11.12: f16[1,1], arg12.13: f16[1], arg13.14: f16[1]) -> (f16[1,1], f16[1], f16[], f16[], s64[], /*index=5*/f16[1,1], f16[1,1], f16[1], f16[1]) {
  %constant.17 = s32[] constant(0), metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.18 = s32[] constant(80), metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.19 = s32[] constant(1), metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.24 = s32[] constant(0), metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %broadcast.25 = s32[80]{0} broadcast(s32[] %constant.24), dimensions={}, metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.21 = s32[] constant(1), metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %broadcast.22 = s32[80]{0} broadcast(s32[] %constant.21), dimensions={}, metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %iota.20 = s32[80]{0} iota(), iota_dimension=0, metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %multiply.23 = s32[80]{0} multiply(s32[80]{0} %broadcast.22, s32[80]{0} %iota.20), metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %add.26 = s32[80]{0} add(s32[80]{0} %broadcast.25, s32[80]{0} %multiply.23), metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.27 = s32[] constant(0), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.28 = s32[] constant(80), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.29 = s32[] constant(0), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.30 = s32[] constant(80), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.31 = s32[] constant(1), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.32 = s32[] constant(0), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.33 = s32[] constant(80), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.34 = s32[] constant(0), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.35 = s32[] constant(80), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %arg0.1 = f16[1,1]{1,0} parameter(0), parameter_replication={false}, metadata={op_name="XLA_Args/dummy_input"}
  %reshape.15 = f16[1,1]{1,0} reshape(f16[1,1]{1,0} %arg0.1)
  %arg1.2 = f16[1,1]{1,0} parameter(1), parameter_replication={false}, metadata={op_name="XLA_Args/dummy_input"}
  %reshape.16 = f16[1,1]{1,0} reshape(f16[1,1]{1,0} %arg1.2)
  %constant.36 = s32[] constant(1), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %arg2.3 = f16[1,1]{1,0} parameter(2), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar6"}
  %arg3.4 = f16[1]{0} parameter(3), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar7"}
  %arg4.5 = f16[] parameter(4), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar8"}
  %arg5.6 = f16[] parameter(5), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar9"}
  %arg6.7 = f32[] parameter(6), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar15"}
  %arg7.8 = s64[] parameter(7), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar11"}
  %arg8.9 = f32[] parameter(8), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar12"}
  %arg9.10 = f32[] parameter(9), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar13"}
  %arg10.11 = f16[1,1]{1,0} parameter(10), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar16"}
  %arg11.12 = f16[1,1]{1,0} parameter(11), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar18"}
  %arg12.13 = f16[1]{0} parameter(12), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar17"}
  %arg13.14 = f16[1]{0} parameter(13), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar19"}
  %tuple.37 = (s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) tuple(s32[] %constant.32, s32[] %constant.33, s32[] %constant.34, s32[] %constant.35, f16[1,1]{1,0} %reshape.15, /*index=5*/f16[1,1]{1,0} %reshape.16, s32[] %constant.36, f16[1,1]{1,0} %arg2.3, f16[1]{0} %arg3.4, f16[] %arg4.5, /*index=10*/f16[] %arg5.6, f32[] %arg6.7, s64[] %arg7.8, f32[] %arg8.9, f32[] %arg9.10, /*index=15*/f16[1,1]{1,0} %arg10.11, f16[1,1]{1,0} %arg11.12, f16[1]{0} %arg12.13, f16[1]{0} %arg13.14), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %while.347 = (s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) while((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %tuple.37), condition=%cond_wrapper.343, body=%while_body_428_const_0_rearrange_0__.58, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.348 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %while.347), index=0, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.349 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %while.347), index=1, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.350 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %while.347), index=2, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.351 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %while.347), index=3, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.352 = f16[1,1]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %while.347), index=4, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.353 = f16[1,1]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %while.347), index=5, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.354 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %while.347), index=6, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.355 = f16[1,1]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %while.347), index=7, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.356 = f16[1]{0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %while.347), index=8, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.357 = f16[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %while.347), index=9, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.358 = f16[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %while.347), index=10, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.359 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %while.347), index=11, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.360 = s64[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %while.347), index=12, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.361 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %while.347), index=13, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.362 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %while.347), index=14, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.363 = f16[1,1]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %while.347), index=15, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.364 = f16[1,1]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %while.347), index=16, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.365 = f16[1]{0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %while.347), index=17, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.366 = f16[1]{0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %while.347), index=18, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %tuple.367 = (s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) tuple(s32[] %get-tuple-element.348, s32[] %get-tuple-element.349, s32[] %get-tuple-element.350, s32[] %get-tuple-element.351, f16[1,1]{1,0} %get-tuple-element.352, /*index=5*/f16[1,1]{1,0} %get-tuple-element.353, s32[] %get-tuple-element.354, f16[1,1]{1,0} %get-tuple-element.355, f16[1]{0} %get-tuple-element.356, f16[] %get-tuple-element.357, /*index=10*/f16[] %get-tuple-element.358, f32[] %get-tuple-element.359, s64[] %get-tuple-element.360, f32[] %get-tuple-element.361, f32[] %get-tuple-element.362, /*index=15*/f16[1,1]{1,0} %get-tuple-element.363, f16[1,1]{1,0} %get-tuple-element.364, f16[1]{0} %get-tuple-element.365, f16[1]{0} %get-tuple-element.366), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.368 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %tuple.367), index=0, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.369 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %tuple.367), index=1, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.370 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %tuple.367), index=2, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.371 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %tuple.367), index=3, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.372 = f16[1,1]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %tuple.367), index=4, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.373 = f16[1,1]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %tuple.367), index=5, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.374 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %tuple.367), index=6, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.375 = f16[1,1]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %tuple.367), index=7, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %reshape.384 = f16[1,1]{1,0} reshape(f16[1,1]{1,0} %get-tuple-element.375), metadata={op_name="XLA_Retvals"}
  %tuple.385 = (f16[1,1]{1,0}) tuple(f16[1,1]{1,0} %reshape.384), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.386 = f16[1,1]{1,0} get-tuple-element((f16[1,1]{1,0}) %tuple.385), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.376 = f16[1]{0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %tuple.367), index=8, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %reshape.387 = f16[1]{0} reshape(f16[1]{0} %get-tuple-element.376), metadata={op_name="XLA_Retvals"}
  %tuple.388 = (f16[1]{0}) tuple(f16[1]{0} %reshape.387), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.389 = f16[1]{0} get-tuple-element((f16[1]{0}) %tuple.388), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.377 = f16[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %tuple.367), index=9, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %reshape.390 = f16[] reshape(f16[] %get-tuple-element.377), metadata={op_name="XLA_Retvals"}
  %tuple.391 = (f16[]) tuple(f16[] %reshape.390), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.392 = f16[] get-tuple-element((f16[]) %tuple.391), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.378 = f16[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %tuple.367), index=10, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %reshape.393 = f16[] reshape(f16[] %get-tuple-element.378), metadata={op_name="XLA_Retvals"}
  %tuple.394 = (f16[]) tuple(f16[] %reshape.393), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.395 = f16[] get-tuple-element((f16[]) %tuple.394), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.379 = s64[] get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %tuple.367), index=12, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %reshape.396 = s64[] reshape(s64[] %get-tuple-element.379), metadata={op_name="XLA_Retvals"}
  %tuple.397 = (s64[]) tuple(s64[] %reshape.396), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.398 = s64[] get-tuple-element((s64[]) %tuple.397), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.380 = f16[1,1]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %tuple.367), index=15, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %reshape.399 = f16[1,1]{1,0} reshape(f16[1,1]{1,0} %get-tuple-element.380), metadata={op_name="XLA_Retvals"}
  %tuple.400 = (f16[1,1]{1,0}) tuple(f16[1,1]{1,0} %reshape.399), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.401 = f16[1,1]{1,0} get-tuple-element((f16[1,1]{1,0}) %tuple.400), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.381 = f16[1,1]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %tuple.367), index=16, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %reshape.402 = f16[1,1]{1,0} reshape(f16[1,1]{1,0} %get-tuple-element.381), metadata={op_name="XLA_Retvals"}
  %tuple.403 = (f16[1,1]{1,0}) tuple(f16[1,1]{1,0} %reshape.402), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.404 = f16[1,1]{1,0} get-tuple-element((f16[1,1]{1,0}) %tuple.403), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.382 = f16[1]{0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %tuple.367), index=17, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %reshape.405 = f16[1]{0} reshape(f16[1]{0} %get-tuple-element.382), metadata={op_name="XLA_Retvals"}
  %tuple.406 = (f16[1]{0}) tuple(f16[1]{0} %reshape.405), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.407 = f16[1]{0} get-tuple-element((f16[1]{0}) %tuple.406), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.383 = f16[1]{0} get-tuple-element((s32[], s32[], s32[], s32[], f16[1,1]{1,0}, /*index=5*/f16[1,1]{1,0}, s32[], f16[1,1]{1,0}, f16[1]{0}, f16[], /*index=10*/f16[], f32[], s64[], f32[], f32[], /*index=15*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) %tuple.367), index=18, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %reshape.408 = f16[1]{0} reshape(f16[1]{0} %get-tuple-element.383), metadata={op_name="XLA_Retvals"}
  %tuple.409 = (f16[1]{0}) tuple(f16[1]{0} %reshape.408), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.410 = f16[1]{0} get-tuple-element((f16[1]{0}) %tuple.409), index=0, metadata={op_name="XLA_Retvals"}
  ROOT %tuple.411 = (f16[1,1]{1,0}, f16[1]{0}, f16[], f16[], s64[], /*index=5*/f16[1,1]{1,0}, f16[1,1]{1,0}, f16[1]{0}, f16[1]{0}) tuple(f16[1,1]{1,0} %get-tuple-element.386, f16[1]{0} %get-tuple-element.389, f16[] %get-tuple-element.392, f16[] %get-tuple-element.395, s64[] %get-tuple-element.398, /*index=5*/f16[1,1]{1,0} %get-tuple-element.401, f16[1,1]{1,0} %get-tuple-element.404, f16[1]{0} %get-tuple-element.407, f16[1]{0} %get-tuple-element.410), metadata={op_name="XLA_Retvals"}
}
)";

#endif  // TENSORFLOW_COMPILER_PLUGIN_POPLAR_TESTS_HLO_SAMPLES_LINEAR_REGRESSION_HLO_H_
