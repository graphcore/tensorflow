/* Copyright 2022 The TensorFlow Authors. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
==============================================================================*/

#ifndef TENSORFLOW_COMPILER_PLUGIN_POPLAR_TESTS_HLO_SAMPLES_ALS_SIMPLE_TRAINING_ADAM_HLO_H_
#define TENSORFLOW_COMPILER_PLUGIN_POPLAR_TESTS_HLO_SAMPLES_ALS_SIMPLE_TRAINING_ADAM_HLO_H_

const char* als_simple_training_adam_hlo = R"(
HloModule a_inference_train_function_1161__XlaMustCompile_true_config_proto___n_007_n_0...02_001_000__executor_type____.739

%while_mean_squared_error_Mean-reduction.40 (x.41: f32[], y.42: f32[]) -> f32[] {
  %x.41 = f32[] parameter(0)
  %y.42 = f32[] parameter(1)
  ROOT %add.43 = f32[] add(f32[] %x.41, f32[] %y.42)
}

%while_mean_squared_error_weighted_loss_Sum-reduction.44 (x.45: f32[], y.46: f32[]) -> f32[] {
  %x.45 = f32[] parameter(0)
  %y.46 = f32[] parameter(1)
  ROOT %add.47 = f32[] add(f32[] %x.45, f32[] %y.46)
}

%while_cond_4_true_962__.48 (arg_tuple.49: (s32[])) -> (s32[]) {
  %arg_tuple.49 = (s32[]) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.50 = s32[] get-tuple-element((s32[]) %arg_tuple.49), index=0
  %constant.51 = s32[] constant(1)
  ROOT %tuple.52 = (s32[]) tuple(s32[] %constant.51), metadata={op_name="XLA_Retvals"}
}

%while_cond_4_false_963__.53 (arg_tuple.54: (s32[])) -> (s32[]) {
  %constant.56 = s32[] constant(1), metadata={op_type="AddV2" op_name="while/cond_4/add" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %arg_tuple.54 = (s32[]) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.55 = s32[] get-tuple-element((s32[]) %arg_tuple.54), index=0
  %constant.57 = s32[] constant(1), metadata={op_type="AddV2" op_name="while/cond_4/add" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %add.58 = s32[] add(s32[] %get-tuple-element.55, s32[] %constant.57), metadata={op_type="AddV2" op_name="while/cond_4/add" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  ROOT %tuple.59 = (s32[]) tuple(s32[] %add.58), metadata={op_name="XLA_Retvals"}
}

%a_inference_f_999__.60 (arg0.61: s32[], arg1.62: s32[]) -> (s32[], s32[]) {
  %arg0.61 = s32[] parameter(0), metadata={op_name="XLA_Args/_AnonymousVar1"}
  %arg1.62 = s32[] parameter(1), metadata={op_name="XLA_Args"}
  %tuple.63 = (s32[]) tuple(s32[] %arg1.62), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.64 = s32[] get-tuple-element((s32[]) %tuple.63), index=0, metadata={op_name="XLA_Retvals"}
  ROOT %tuple.65 = (s32[], s32[]) tuple(s32[] %arg1.62, s32[] %get-tuple-element.64), metadata={op_name="XLA_Retvals"}
}

%region_0.66 (Arg_0.67: f32[], Arg_1.68: f32[]) -> f32[] {
  %Arg_0.67 = f32[] parameter(0)
  %Arg_1.68 = f32[] parameter(1)
  ROOT %add.69 = f32[] add(f32[] %Arg_0.67, f32[] %Arg_1.68), metadata={op_name="gradient_tape/while/model/dense/BiasAdd/BiasAddGrad"}
}

%while_cond_true_805__.70 (arg_tuple.71: (f16[4,128], f32[2], f32[1])) -> (f32[2]) {
  %constant.76 = s32[1]{0} constant({-1}), metadata={op_type="Reshape" op_name="while/cond/Reshape" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %arg_tuple.71 = (f16[4,128]{1,0}, f32[2]{0}, f32[1]{0}) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.73 = f32[2]{0} get-tuple-element((f16[4,128]{1,0}, f32[2]{0}, f32[1]{0}) %arg_tuple.71), index=1
  %get-tuple-element.72 = f16[4,128]{1,0} get-tuple-element((f16[4,128]{1,0}, f32[2]{0}, f32[1]{0}) %arg_tuple.71), index=0
  %convert.75 = f32[4,128]{1,0} convert(f16[4,128]{1,0} %get-tuple-element.72), metadata={op_type="Cast" op_name="while/cond/Cast" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reshape.77 = f32[512]{0} reshape(f32[4,128]{1,0} %convert.75), metadata={op_type="Reshape" op_name="while/cond/Reshape" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.74 = f32[1]{0} get-tuple-element((f16[4,128]{1,0}, f32[2]{0}, f32[1]{0}) %arg_tuple.71), index=2
  %custom-call.78 = f32[2]{0} custom-call(f32[2]{0} %get-tuple-element.73, f32[512]{0} %reshape.77, f32[1]{0} %get-tuple-element.74), custom_call_target="HistogramUpdate", metadata={op_type="IpuHistogramUpdate" op_name="while/cond/IpuHistogramUpdate" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}, backend_config="{\n\t\"absolute_of_input\" : true\n}"
  ROOT %tuple.79 = (f32[2]{0}) tuple(f32[2]{0} %custom-call.78), metadata={op_name="XLA_Retvals"}
}

%while_cond_false_806__.80 (arg_tuple.81: (f16[4,128], f32[2], f32[1])) -> (f32[2]) {
  %arg_tuple.81 = (f16[4,128]{1,0}, f32[2]{0}, f32[1]{0}) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.82 = f16[4,128]{1,0} get-tuple-element((f16[4,128]{1,0}, f32[2]{0}, f32[1]{0}) %arg_tuple.81), index=0
  %get-tuple-element.84 = f32[1]{0} get-tuple-element((f16[4,128]{1,0}, f32[2]{0}, f32[1]{0}) %arg_tuple.81), index=2
  %get-tuple-element.83 = f32[2]{0} get-tuple-element((f16[4,128]{1,0}, f32[2]{0}, f32[1]{0}) %arg_tuple.81), index=1
  ROOT %tuple.85 = (f32[2]{0}) tuple(f32[2]{0} %get-tuple-element.83), metadata={op_name="XLA_Retvals"}
}

%a_inference_f_831__.86 (arg0.87: f32[2], arg1.88: f32[2]) -> (f32[2], f32[2]) {
  %arg0.87 = f32[2]{0} parameter(0), metadata={op_name="XLA_Args/_AnonymousVar0"}
  %arg1.88 = f32[2]{0} parameter(1), metadata={op_name="XLA_Args"}
  %tuple.89 = (f32[2]{0}) tuple(f32[2]{0} %arg1.88), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.90 = f32[2]{0} get-tuple-element((f32[2]{0}) %tuple.89), index=0, metadata={op_name="XLA_Retvals"}
  ROOT %tuple.91 = (f32[2]{0}, f32[2]{0}) tuple(f32[2]{0} %arg1.88, f32[2]{0} %get-tuple-element.90), metadata={op_name="XLA_Retvals"}
}

%while_cond_1_true_839__.92 (arg_tuple.93: (f16[128], f32[2], f32[1])) -> (f32[2]) {
  %constant.98 = s32[1]{0} constant({-1}), metadata={op_type="Reshape" op_name="while/cond_1/Reshape" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %arg_tuple.93 = (f16[128]{0}, f32[2]{0}, f32[1]{0}) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.95 = f32[2]{0} get-tuple-element((f16[128]{0}, f32[2]{0}, f32[1]{0}) %arg_tuple.93), index=1
  %get-tuple-element.94 = f16[128]{0} get-tuple-element((f16[128]{0}, f32[2]{0}, f32[1]{0}) %arg_tuple.93), index=0
  %convert.97 = f32[128]{0} convert(f16[128]{0} %get-tuple-element.94), metadata={op_type="Cast" op_name="while/cond_1/Cast" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reshape.99 = f32[128]{0} reshape(f32[128]{0} %convert.97), metadata={op_type="Reshape" op_name="while/cond_1/Reshape" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.96 = f32[1]{0} get-tuple-element((f16[128]{0}, f32[2]{0}, f32[1]{0}) %arg_tuple.93), index=2
  %custom-call.100 = f32[2]{0} custom-call(f32[2]{0} %get-tuple-element.95, f32[128]{0} %reshape.99, f32[1]{0} %get-tuple-element.96), custom_call_target="HistogramUpdate", metadata={op_type="IpuHistogramUpdate" op_name="while/cond_1/IpuHistogramUpdate" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}, backend_config="{\n\t\"absolute_of_input\" : true\n}"
  ROOT %tuple.101 = (f32[2]{0}) tuple(f32[2]{0} %custom-call.100), metadata={op_name="XLA_Retvals"}
}

%while_cond_1_false_840__.102 (arg_tuple.103: (f16[128], f32[2], f32[1])) -> (f32[2]) {
  %arg_tuple.103 = (f16[128]{0}, f32[2]{0}, f32[1]{0}) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.104 = f16[128]{0} get-tuple-element((f16[128]{0}, f32[2]{0}, f32[1]{0}) %arg_tuple.103), index=0
  %get-tuple-element.106 = f32[1]{0} get-tuple-element((f16[128]{0}, f32[2]{0}, f32[1]{0}) %arg_tuple.103), index=2
  %get-tuple-element.105 = f32[2]{0} get-tuple-element((f16[128]{0}, f32[2]{0}, f32[1]{0}) %arg_tuple.103), index=1
  ROOT %tuple.107 = (f32[2]{0}) tuple(f32[2]{0} %get-tuple-element.105), metadata={op_name="XLA_Retvals"}
}

%a_inference_f_865__.108 (arg0.109: f32[2], arg1.110: f32[2]) -> (f32[2], f32[2]) {
  %arg0.109 = f32[2]{0} parameter(0), metadata={op_name="XLA_Args/_AnonymousVar0"}
  %arg1.110 = f32[2]{0} parameter(1), metadata={op_name="XLA_Args"}
  %tuple.111 = (f32[2]{0}) tuple(f32[2]{0} %arg1.110), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.112 = f32[2]{0} get-tuple-element((f32[2]{0}) %tuple.111), index=0, metadata={op_name="XLA_Retvals"}
  ROOT %tuple.113 = (f32[2]{0}, f32[2]{0}) tuple(f32[2]{0} %arg1.110, f32[2]{0} %get-tuple-element.112), metadata={op_name="XLA_Retvals"}
}

%while_cond_3_true_951__.114 (arg_tuple.115: (f32[2])) -> (f32[2]) {
  %arg_tuple.115 = (f32[2]{0}) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.116 = f32[2]{0} get-tuple-element((f32[2]{0}) %arg_tuple.115), index=0
  %constant.117 = f32[] constant(0), metadata={op_type="Const" op_name="while/cond_3/zeros_like" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.118 = f32[2]{0} broadcast(f32[] %constant.117), dimensions={}, metadata={op_type="Const" op_name="while/cond_3/zeros_like" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  ROOT %tuple.119 = (f32[2]{0}) tuple(f32[2]{0} %broadcast.118), metadata={op_name="XLA_Retvals"}
}

%while_cond_3_false_952__.120 (arg_tuple.121: (f32[2])) -> (f32[2]) {
  %arg_tuple.121 = (f32[2]{0}) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.122 = f32[2]{0} get-tuple-element((f32[2]{0}) %arg_tuple.121), index=0
  ROOT %tuple.123 = (f32[2]{0}) tuple(f32[2]{0} %get-tuple-element.122), metadata={op_name="XLA_Retvals"}
}

%a_inference_f_990__.124 (arg0.125: f32[2], arg1.126: f32[2]) -> (f32[2], f32[2]) {
  %arg0.125 = f32[2]{0} parameter(0), metadata={op_name="XLA_Args/_AnonymousVar0"}
  %arg1.126 = f32[2]{0} parameter(1), metadata={op_name="XLA_Args"}
  %tuple.127 = (f32[2]{0}) tuple(f32[2]{0} %arg1.126), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.128 = f32[2]{0} get-tuple-element((f32[2]{0}) %tuple.127), index=0, metadata={op_name="XLA_Retvals"}
  ROOT %tuple.129 = (f32[2]{0}, f32[2]{0}) tuple(f32[2]{0} %arg1.126, f32[2]{0} %get-tuple-element.128), metadata={op_name="XLA_Retvals"}
}

%while_cond_2_Sum-reduction.130 (x.131: f32[], y.132: f32[]) -> f32[] {
  %x.131 = f32[] parameter(0)
  %y.132 = f32[] parameter(1)
  ROOT %add.133 = f32[] add(f32[] %x.131, f32[] %y.132)
}

%while_cond_2_cond_true_888__.134 (arg_tuple.135: (f32[])) -> (f32[]) {
  %constant.137 = f32[] constant(0.25), metadata={op_type="Mul" op_name="while/cond_2/cond/mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %arg_tuple.135 = (f32[]) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.136 = f32[] get-tuple-element((f32[]) %arg_tuple.135), index=0
  %constant.138 = f32[] constant(0.25), metadata={op_type="Mul" op_name="while/cond_2/cond/mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.139 = f32[] multiply(f32[] %get-tuple-element.136, f32[] %constant.138), metadata={op_type="Mul" op_name="while/cond_2/cond/mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  ROOT %tuple.140 = (f32[]) tuple(f32[] %multiply.139), metadata={op_name="XLA_Retvals"}
}

%while_cond_2_cond_false_889__.141 (arg_tuple.142: (f32[])) -> (f32[]) {
  %constant.144 = f32[] constant(4), metadata={op_type="Mul" op_name="while/cond_2/cond/mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %arg_tuple.142 = (f32[]) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.143 = f32[] get-tuple-element((f32[]) %arg_tuple.142), index=0
  %constant.145 = f32[] constant(4), metadata={op_type="Mul" op_name="while/cond_2/cond/mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.146 = f32[] multiply(f32[] %get-tuple-element.143, f32[] %constant.145), metadata={op_type="Mul" op_name="while/cond_2/cond/mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  ROOT %tuple.147 = (f32[]) tuple(f32[] %multiply.146), metadata={op_name="XLA_Retvals"}
}

%while_cond_2_cond_1_true_904__.148 (arg_tuple.149: (f32[], f32[])) -> (f32[]) {
  %arg_tuple.149 = (f32[], f32[]) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.151 = f32[] get-tuple-element((f32[], f32[]) %arg_tuple.149), index=1
  %get-tuple-element.150 = f32[] get-tuple-element((f32[], f32[]) %arg_tuple.149), index=0
  ROOT %tuple.152 = (f32[]) tuple(f32[] %get-tuple-element.150), metadata={op_name="XLA_Retvals"}
}

%while_cond_2_cond_1_false_905__.153 (arg_tuple.154: (f32[], f32[])) -> (f32[]) {
  %arg_tuple.154 = (f32[], f32[]) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.155 = f32[] get-tuple-element((f32[], f32[]) %arg_tuple.154), index=0
  %get-tuple-element.156 = f32[] get-tuple-element((f32[], f32[]) %arg_tuple.154), index=1
  ROOT %tuple.157 = (f32[]) tuple(f32[] %get-tuple-element.156), metadata={op_name="XLA_Retvals"}
}

%while_cond_2_cond_2_true_918__.158 (arg_tuple.159: (f32[], f32[])) -> (f32[]) {
  %arg_tuple.159 = (f32[], f32[]) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.161 = f32[] get-tuple-element((f32[], f32[]) %arg_tuple.159), index=1
  %get-tuple-element.160 = f32[] get-tuple-element((f32[], f32[]) %arg_tuple.159), index=0
  ROOT %tuple.162 = (f32[]) tuple(f32[] %get-tuple-element.160), metadata={op_name="XLA_Retvals"}
}

%while_cond_2_cond_2_false_919__.163 (arg_tuple.164: (f32[], f32[])) -> (f32[]) {
  %arg_tuple.164 = (f32[], f32[]) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.165 = f32[] get-tuple-element((f32[], f32[]) %arg_tuple.164), index=0
  %get-tuple-element.166 = f32[] get-tuple-element((f32[], f32[]) %arg_tuple.164), index=1
  ROOT %tuple.167 = (f32[]) tuple(f32[] %get-tuple-element.166), metadata={op_name="XLA_Retvals"}
}

%while_cond_2_cond_3_true_932__.168 (arg_tuple.169: (f32[], f32[])) -> (f32[]) {
  %arg_tuple.169 = (f32[], f32[]) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.171 = f32[] get-tuple-element((f32[], f32[]) %arg_tuple.169), index=1
  %get-tuple-element.170 = f32[] get-tuple-element((f32[], f32[]) %arg_tuple.169), index=0
  ROOT %tuple.172 = (f32[]) tuple(f32[] %get-tuple-element.170), metadata={op_name="XLA_Retvals"}
}

%while_cond_2_cond_3_false_933__.173 (arg_tuple.174: (f32[], f32[])) -> (f32[]) {
  %arg_tuple.174 = (f32[], f32[]) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.175 = f32[] get-tuple-element((f32[], f32[]) %arg_tuple.174), index=0
  %get-tuple-element.176 = f32[] get-tuple-element((f32[], f32[]) %arg_tuple.174), index=1
  ROOT %tuple.177 = (f32[]) tuple(f32[] %get-tuple-element.176), metadata={op_name="XLA_Retvals"}
}

%while_cond_2_true_875__.178 (arg_tuple.179: (f32[2], f32[])) -> (f32[]) {
  %constant.187 = s32[1]{0} constant({1}), metadata={op_type="StridedSlice" op_name="while/cond_2/strided_slice" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.188 = s32[1]{0} constant({2}), metadata={op_type="StridedSlice" op_name="while/cond_2/strided_slice" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.189 = s32[1]{0} constant({1}), metadata={op_type="StridedSlice" op_name="while/cond_2/strided_slice" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.193 = f32[] constant(1e-05), metadata={op_type="Greater" op_name="while/cond_2/Greater" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.203 = f32[] constant(32768), metadata={op_type="Less" op_name="while/cond_2/Less" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.209 = f32[] constant(1), metadata={op_type="GreaterEqual" op_name="while/cond_2/GreaterEqual" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %arg_tuple.179 = (f32[2]{0}, f32[]) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.180 = f32[2]{0} get-tuple-element((f32[2]{0}, f32[]) %arg_tuple.179), index=0
  %slice.190 = f32[1]{0} slice(f32[2]{0} %get-tuple-element.180), slice={[1:2]}, metadata={op_type="StridedSlice" op_name="while/cond_2/strided_slice" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reshape.191 = f32[] reshape(f32[1]{0} %slice.190), metadata={op_type="StridedSlice" op_name="while/cond_2/strided_slice" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.182 = f32[2]{0} convert(f32[2]{0} %get-tuple-element.180), metadata={op_type="Sum" op_name="while/cond_2/Sum" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.183 = f32[] constant(0), metadata={op_type="Sum" op_name="while/cond_2/Sum" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.184 = f32[] convert(f32[] %constant.183), metadata={op_type="Sum" op_name="while/cond_2/Sum" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reduce.185 = f32[] reduce(f32[2]{0} %convert.182, f32[] %convert.184), dimensions={0}, to_apply=%while_cond_2_Sum-reduction.130, metadata={op_type="Sum" op_name="while/cond_2/Sum" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.186 = f32[] convert(f32[] %reduce.185), metadata={op_type="Sum" op_name="while/cond_2/Sum" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %divide.192 = f32[] divide(f32[] %reshape.191, f32[] %convert.186), metadata={op_type="RealDiv" op_name="while/cond_2/truediv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.194 = f32[] constant(1e-05), metadata={op_type="Greater" op_name="while/cond_2/Greater" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %compare.195 = pred[] compare(f32[] %divide.192, f32[] %constant.194), direction=GT, metadata={op_type="Greater" op_name="while/cond_2/Greater" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.181 = f32[] get-tuple-element((f32[2]{0}, f32[]) %arg_tuple.179), index=1
  %tuple.196 = (f32[]) tuple(f32[] %get-tuple-element.181), metadata={op_type="StatelessIf" op_name="while/cond_2/cond" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %conditional.197 = (f32[]) conditional(pred[] %compare.195, (f32[]) %tuple.196, (f32[]) %tuple.196), true_computation=%while_cond_2_cond_true_888__.134, false_computation=%while_cond_2_cond_false_889__.141, metadata={op_type="StatelessIf" op_name="while/cond_2/cond" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.198 = f32[] get-tuple-element((f32[]) %conditional.197), index=0, metadata={op_type="StatelessIf" op_name="while/cond_2/cond" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %is-finite.199 = pred[] is-finite(f32[] %get-tuple-element.198), metadata={op_name="while/cond_2/IsFinite"}
  %tuple.200 = (f32[], f32[]) tuple(f32[] %get-tuple-element.198, f32[] %get-tuple-element.181), metadata={op_type="StatelessIf" op_name="while/cond_2/cond_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %conditional.201 = (f32[]) conditional(pred[] %is-finite.199, (f32[], f32[]) %tuple.200, (f32[], f32[]) %tuple.200), true_computation=%while_cond_2_cond_1_true_904__.148, false_computation=%while_cond_2_cond_1_false_905__.153, metadata={op_type="StatelessIf" op_name="while/cond_2/cond_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.202 = f32[] get-tuple-element((f32[]) %conditional.201), index=0, metadata={op_type="StatelessIf" op_name="while/cond_2/cond_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.204 = f32[] constant(32768), metadata={op_type="Less" op_name="while/cond_2/Less" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %compare.205 = pred[] compare(f32[] %get-tuple-element.202, f32[] %constant.204), direction=LT, metadata={op_type="Less" op_name="while/cond_2/Less" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %tuple.206 = (f32[], f32[]) tuple(f32[] %get-tuple-element.202, f32[] %get-tuple-element.181), metadata={op_type="StatelessIf" op_name="while/cond_2/cond_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %conditional.207 = (f32[]) conditional(pred[] %compare.205, (f32[], f32[]) %tuple.206, (f32[], f32[]) %tuple.206), true_computation=%while_cond_2_cond_2_true_918__.158, false_computation=%while_cond_2_cond_2_false_919__.163, metadata={op_type="StatelessIf" op_name="while/cond_2/cond_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.208 = f32[] get-tuple-element((f32[]) %conditional.207), index=0, metadata={op_type="StatelessIf" op_name="while/cond_2/cond_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.210 = f32[] constant(1), metadata={op_type="GreaterEqual" op_name="while/cond_2/GreaterEqual" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %compare.211 = pred[] compare(f32[] %get-tuple-element.208, f32[] %constant.210), direction=GE, metadata={op_type="GreaterEqual" op_name="while/cond_2/GreaterEqual" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %tuple.212 = (f32[], f32[]) tuple(f32[] %get-tuple-element.208, f32[] %get-tuple-element.181), metadata={op_type="StatelessIf" op_name="while/cond_2/cond_3" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %conditional.213 = (f32[]) conditional(pred[] %compare.211, (f32[], f32[]) %tuple.212, (f32[], f32[]) %tuple.212), true_computation=%while_cond_2_cond_3_true_932__.168, false_computation=%while_cond_2_cond_3_false_933__.173, metadata={op_type="StatelessIf" op_name="while/cond_2/cond_3" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.214 = f32[] get-tuple-element((f32[]) %conditional.213), index=0, metadata={op_type="StatelessIf" op_name="while/cond_2/cond_3" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  ROOT %tuple.215 = (f32[]) tuple(f32[] %get-tuple-element.214), metadata={op_name="XLA_Retvals"}
}

%while_cond_2_false_876__.216 (arg_tuple.217: (f32[2], f32[])) -> (f32[]) {
  %arg_tuple.217 = (f32[2]{0}, f32[]) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.218 = f32[2]{0} get-tuple-element((f32[2]{0}, f32[]) %arg_tuple.217), index=0
  %get-tuple-element.219 = f32[] get-tuple-element((f32[2]{0}, f32[]) %arg_tuple.217), index=1
  ROOT %tuple.220 = (f32[]) tuple(f32[] %get-tuple-element.219), metadata={op_name="XLA_Retvals"}
}

%a_inference_f_981__.221 (arg0.222: f32[], arg1.223: f32[]) -> (f32[], f32[]) {
  %arg0.222 = f32[] parameter(0), metadata={op_name="XLA_Args/_AnonymousVar2"}
  %arg1.223 = f32[] parameter(1), metadata={op_name="XLA_Args"}
  %tuple.224 = (f32[]) tuple(f32[] %arg1.223), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.225 = f32[] get-tuple-element((f32[]) %tuple.224), index=0, metadata={op_name="XLA_Retvals"}
  ROOT %tuple.226 = (f32[], f32[]) tuple(f32[] %arg1.223, f32[] %get-tuple-element.225), metadata={op_name="XLA_Retvals"}
}

%while_body_678_const_0_rearrange_0__.227 (arg_tuple.228: (s32[], s32[], s32[], s32[], f32[1], /*index=5*/s32[], f16[4,128], f16[128], f32[], f32[], /*index=10*/f32[], s32[], f32[2], f32[], s64[], /*index=15*/f32[], f32[], f16[4,128], f16[4,128], f16[128], /*index=20*/f16[128], s64[])) -> (s32[], s32[], s32[], s32[], f32[1], /*index=5*/s32[], f16[4,128], f16[128], f32[], f32[], /*index=10*/f32[], s32[], f32[2], f32[], s64[], /*index=15*/f32[], f32[], f16[4,128], f16[4,128], f16[128], /*index=20*/f16[128], s64[]) {
  %constant.251 = s32[] constant(1), metadata={op_type="Maximum" op_name="gradient_tape/while/mean_squared_error/Maximum" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.252 = s32[2]{0} broadcast(s32[] %constant.251), dimensions={}, metadata={op_type="Maximum" op_name="gradient_tape/while/mean_squared_error/Maximum" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.253 = s32[] constant(1), metadata={op_type="Maximum" op_name="gradient_tape/while/mean_squared_error/Maximum" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.259 = s32[2]{0} constant({1, 128}), metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_squared_error/floordiv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.260 = s32[2]{0} constant({1, 128}), metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_squared_error/floordiv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.254 = s32[] constant(1), metadata={op_type="Maximum" op_name="gradient_tape/while/mean_squared_error/Maximum" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.255 = s32[2]{0} broadcast(s32[] %constant.254), dimensions={}, metadata={op_type="Maximum" op_name="gradient_tape/while/mean_squared_error/Maximum" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.256 = s32[] constant(1), metadata={op_type="Maximum" op_name="gradient_tape/while/mean_squared_error/Maximum" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.257 = s32[2]{0} broadcast(s32[] %constant.256), dimensions={}, metadata={op_type="Maximum" op_name="gradient_tape/while/mean_squared_error/Maximum" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %maximum.258 = s32[2]{0} maximum(s32[2]{0} %broadcast.255, s32[2]{0} %broadcast.257), metadata={op_type="Maximum" op_name="gradient_tape/while/mean_squared_error/Maximum" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %divide.263 = s32[2]{0} divide(s32[2]{0} %constant.260, s32[2]{0} %maximum.258), metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_squared_error/floordiv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.269 = s32[2]{0} multiply(s32[2]{0} %divide.263, s32[2]{0} %maximum.258), metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_squared_error/floordiv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %compare.270 = pred[2]{0} compare(s32[2]{0} %multiply.269, s32[2]{0} %constant.260), direction=NE, metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_squared_error/floordiv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.261 = s32[] constant(0), metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_squared_error/floordiv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.266 = s32[2]{0} broadcast(s32[] %constant.261), dimensions={}, metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_squared_error/floordiv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %compare.267 = pred[2]{0} compare(s32[2]{0} %constant.260, s32[2]{0} %broadcast.266), direction=LT, metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_squared_error/floordiv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.264 = s32[2]{0} broadcast(s32[] %constant.261), dimensions={}, metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_squared_error/floordiv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %compare.265 = pred[2]{0} compare(s32[2]{0} %maximum.258, s32[2]{0} %broadcast.264), direction=LT, metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_squared_error/floordiv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %compare.268 = pred[2]{0} compare(pred[2]{0} %compare.267, pred[2]{0} %compare.265), direction=NE, metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_squared_error/floordiv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %and.271 = pred[2]{0} and(pred[2]{0} %compare.270, pred[2]{0} %compare.268), metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_squared_error/floordiv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.262 = s32[] constant(1), metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_squared_error/floordiv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.272 = s32[2]{0} broadcast(s32[] %constant.262), dimensions={}, metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_squared_error/floordiv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.273 = s32[2]{0} subtract(s32[2]{0} %divide.263, s32[2]{0} %broadcast.272), metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_squared_error/floordiv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %select.274 = s32[2]{0} select(pred[2]{0} %and.271, s32[2]{0} %subtract.273, s32[2]{0} %divide.263), metadata={op_type="FloorDiv" op_name="gradient_tape/while/mean_squared_error/floordiv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.275 = s32[0]{0} constant({}), metadata={op_type="BroadcastGradientArgs" op_name="gradient_tape/while/mul_1/BroadcastGradientArgs" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.276 = s32[0]{0} constant({}), metadata={op_type="BroadcastGradientArgs" op_name="gradient_tape/while/mul_1/BroadcastGradientArgs" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.285 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/sub_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.286 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/sub_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %arg_tuple.228 = (s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.244 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.228), index=15
  %convert.284 = f16[] convert(f32[] %get-tuple-element.244), metadata={op_type="Cast" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/Cast_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.287 = f16[] subtract(f16[] %constant.286, f16[] %convert.284), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/sub_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.289 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/sub_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.290 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/sub_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.288 = f16[] convert(f32[] %get-tuple-element.244), metadata={op_type="Cast" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/Cast_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.291 = f16[] subtract(f16[] %constant.290, f16[] %convert.288), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/sub_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.293 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/sub_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.294 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/sub_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.292 = f16[] convert(f32[] %get-tuple-element.244), metadata={op_type="Cast" op_name="while/AutomaticLossScalingOptimizer/Cast_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.295 = f16[] subtract(f16[] %constant.294, f16[] %convert.292), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/sub_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.297 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/sub_3" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.298 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/sub_3" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.245 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.228), index=16
  %convert.296 = f16[] convert(f32[] %get-tuple-element.245), metadata={op_type="Cast" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/Cast_3" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.299 = f16[] subtract(f16[] %constant.298, f16[] %convert.296), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/sub_3" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.301 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/sub_3" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.302 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/sub_3" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.300 = f16[] convert(f32[] %get-tuple-element.245), metadata={op_type="Cast" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/Cast_3" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.303 = f16[] subtract(f16[] %constant.302, f16[] %convert.300), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/sub_3" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.305 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/sub_3" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.306 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/sub_3" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.304 = f16[] convert(f32[] %get-tuple-element.245), metadata={op_type="Cast" op_name="while/AutomaticLossScalingOptimizer/Cast_3" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.307 = f16[] subtract(f16[] %constant.306, f16[] %convert.304), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/sub_3" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.311 = s64[] constant(1), metadata={op_type="AddV2" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/add" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.316 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/sub_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.320 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/sub" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.242 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.228), index=13
  %convert.308 = f16[] convert(f32[] %get-tuple-element.242), metadata={op_type="Cast" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/Cast" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.321 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/sub" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.243 = s64[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.228), index=14
  %constant.312 = s64[] constant(1), metadata={op_type="AddV2" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/add" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %add.313 = s64[] add(s64[] %get-tuple-element.243, s64[] %constant.312), metadata={op_type="AddV2" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/add" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.314 = f16[] convert(s64[] %add.313), metadata={op_type="Cast" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/Cast_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %power.319 = f16[] power(f16[] %convert.296, f16[] %convert.314), metadata={op_type="Pow" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/Pow_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.322 = f16[] subtract(f16[] %constant.321, f16[] %power.319), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/sub" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %sqrt.323 = f16[] sqrt(f16[] %subtract.322), metadata={op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/Sqrt"}
  %constant.317 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/sub_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %power.315 = f16[] power(f16[] %convert.284, f16[] %convert.314), metadata={op_type="Pow" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/Pow" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.318 = f16[] subtract(f16[] %constant.317, f16[] %power.315), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/sub_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %divide.324 = f16[] divide(f16[] %sqrt.323, f16[] %subtract.318), metadata={op_type="RealDiv" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/truediv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.325 = f16[] multiply(f16[] %convert.308, f16[] %divide.324), metadata={op_type="Mul" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.326 = s64[] constant(1), metadata={op_type="AddV2" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/add" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.331 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/sub_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.335 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/sub" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.309 = f16[] convert(f32[] %get-tuple-element.242), metadata={op_type="Cast" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/Cast" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.336 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/sub" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.327 = s64[] constant(1), metadata={op_type="AddV2" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/add" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %add.328 = s64[] add(s64[] %get-tuple-element.243, s64[] %constant.327), metadata={op_type="AddV2" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/add" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.329 = f16[] convert(s64[] %add.328), metadata={op_type="Cast" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/Cast_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %power.334 = f16[] power(f16[] %convert.300, f16[] %convert.329), metadata={op_type="Pow" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/Pow_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.337 = f16[] subtract(f16[] %constant.336, f16[] %power.334), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/sub" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %sqrt.338 = f16[] sqrt(f16[] %subtract.337), metadata={op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/Sqrt"}
  %constant.332 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/sub_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %power.330 = f16[] power(f16[] %convert.288, f16[] %convert.329), metadata={op_type="Pow" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/Pow" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.333 = f16[] subtract(f16[] %constant.332, f16[] %power.330), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/sub_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %divide.339 = f16[] divide(f16[] %sqrt.338, f16[] %subtract.333), metadata={op_type="RealDiv" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/truediv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.340 = f16[] multiply(f16[] %convert.309, f16[] %divide.339), metadata={op_type="Mul" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.341 = s64[] constant(1), metadata={op_type="AddV2" op_name="while/AutomaticLossScalingOptimizer/add" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.346 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/sub_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.350 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/sub" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.310 = f16[] convert(f32[] %get-tuple-element.242), metadata={op_type="Cast" op_name="while/AutomaticLossScalingOptimizer/Cast" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.351 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/sub" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.342 = s64[] constant(1), metadata={op_type="AddV2" op_name="while/AutomaticLossScalingOptimizer/add" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %add.343 = s64[] add(s64[] %get-tuple-element.243, s64[] %constant.342), metadata={op_type="AddV2" op_name="while/AutomaticLossScalingOptimizer/add" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.344 = f16[] convert(s64[] %add.343), metadata={op_type="Cast" op_name="while/AutomaticLossScalingOptimizer/Cast_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %power.349 = f16[] power(f16[] %convert.304, f16[] %convert.344), metadata={op_type="Pow" op_name="while/AutomaticLossScalingOptimizer/Pow_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.352 = f16[] subtract(f16[] %constant.351, f16[] %power.349), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/sub" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %sqrt.353 = f16[] sqrt(f16[] %subtract.352), metadata={op_name="while/AutomaticLossScalingOptimizer/Sqrt"}
  %constant.347 = f16[] constant(1), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/sub_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %power.345 = f16[] power(f16[] %convert.292, f16[] %convert.344), metadata={op_type="Pow" op_name="while/AutomaticLossScalingOptimizer/Pow" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.348 = f16[] subtract(f16[] %constant.347, f16[] %power.345), metadata={op_type="Sub" op_name="while/AutomaticLossScalingOptimizer/sub_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %divide.354 = f16[] divide(f16[] %sqrt.353, f16[] %subtract.348), metadata={op_type="RealDiv" op_name="while/AutomaticLossScalingOptimizer/truediv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.355 = f16[] multiply(f16[] %convert.310, f16[] %divide.354), metadata={op_type="Mul" op_name="while/AutomaticLossScalingOptimizer/mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.373 = f32[] constant(1), metadata={op_type="Mul" op_name="while/mean_squared_error/weighted_loss/Mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.383 = f32[] constant(1), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.391 = f32[] constant(1), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.399 = f32[] constant(1), metadata={op_type="DivNoNan" op_name="while/mean_squared_error/weighted_loss/value" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.409 = f32[] constant(1), metadata={op_type="Mul" op_name="while/Mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.238 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.228), index=9
  %constant.413 = f32[] constant(1), metadata={op_type="AssignAddVariableOp" op_name="while/AssignAddVariableOp_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %add.414 = f32[] add(f32[] %get-tuple-element.238, f32[] %constant.413), metadata={op_type="AssignAddVariableOp" op_name="while/AssignAddVariableOp_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.415 = f32[] constant(0), metadata={op_type="DivNoNan" op_name="while/div_no_nan" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %compare.416 = pred[] compare(f32[] %add.414, f32[] %constant.415), direction=EQ, metadata={op_type="DivNoNan" op_name="while/div_no_nan" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.417 = f32[] constant(0), metadata={op_type="DivNoNan" op_name="while/div_no_nan" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.418 = f32[] broadcast(f32[] %constant.417), dimensions={}, metadata={op_type="DivNoNan" op_name="while/div_no_nan" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.237 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.228), index=8
  %constant.400 = f32[] constant(1), metadata={op_type="DivNoNan" op_name="while/mean_squared_error/weighted_loss/value" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.401 = f32[] constant(0), metadata={op_type="DivNoNan" op_name="while/mean_squared_error/weighted_loss/value" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %compare.402 = pred[] compare(f32[] %constant.400, f32[] %constant.401), direction=EQ, metadata={op_type="DivNoNan" op_name="while/mean_squared_error/weighted_loss/value" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.403 = f32[] constant(0), metadata={op_type="DivNoNan" op_name="while/mean_squared_error/weighted_loss/value" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.404 = f32[] broadcast(f32[] %constant.403), dimensions={}, metadata={op_type="DivNoNan" op_name="while/mean_squared_error/weighted_loss/value" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %after-all.277 = token[] after-all(), metadata={op_type="PopDatastreamInfeedDequeue" op_name="while/PopDatastreamInfeedDequeue" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %infeed.278 = ((f32[1,4]{1,0}, f32[1,128]{1,0}), token[]) infeed(token[] %after-all.277), infeed_config="\022\0011\"\002\001\001(\003", metadata={op_type="PopDatastreamInfeedDequeue" op_name="while/PopDatastreamInfeedDequeue" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.279 = (f32[1,4]{1,0}, f32[1,128]{1,0}) get-tuple-element(((f32[1,4]{1,0}, f32[1,128]{1,0}), token[]) %infeed.278), index=0, metadata={op_type="PopDatastreamInfeedDequeue" op_name="while/PopDatastreamInfeedDequeue" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.280 = f32[1,4]{1,0} get-tuple-element((f32[1,4]{1,0}, f32[1,128]{1,0}) %get-tuple-element.279), index=0, metadata={op_type="PopDatastreamInfeedDequeue" op_name="while/PopDatastreamInfeedDequeue" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.283 = f16[1,4]{1,0} convert(f32[1,4]{1,0} %get-tuple-element.280), metadata={op_type="Cast" op_name="while/model/dense/Cast" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.235 = f16[4,128]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.228), index=6
  %dot.356 = f16[1,128]{1,0} dot(f16[1,4]{1,0} %convert.283, f16[4,128]{1,0} %get-tuple-element.235), lhs_contracting_dims={1}, rhs_contracting_dims={0}, metadata={op_type="MatMul" op_name="while/model/dense/MatMul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %transpose.357 = f16[1,128]{1,0} transpose(f16[1,128]{1,0} %dot.356), dimensions={0,1}, metadata={op_type="MatMul" op_name="while/model/dense/MatMul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.236 = f16[128]{0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.228), index=7
  %broadcast.358 = f16[1,128]{1,0} broadcast(f16[128]{0} %get-tuple-element.236), dimensions={1}, metadata={op_type="BiasAdd" op_name="while/model/dense/BiasAdd" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %add.359 = f16[1,128]{1,0} add(f16[1,128]{1,0} %transpose.357, f16[1,128]{1,0} %broadcast.358), metadata={op_type="BiasAdd" op_name="while/model/dense/BiasAdd" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %custom-call.360 = f16[1,128]{1,0} custom-call(f16[1,128]{1,0} %add.359), custom_call_target="Relu", metadata={op_type="Relu" op_name="while/model/dense/Relu" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}, backend_config="null"
  %get-tuple-element.281 = f32[1,128]{1,0} get-tuple-element((f32[1,4]{1,0}, f32[1,128]{1,0}) %get-tuple-element.279), index=1, metadata={op_type="PopDatastreamInfeedDequeue" op_name="while/PopDatastreamInfeedDequeue" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.282 = f16[1,128]{1,0} convert(f32[1,128]{1,0} %get-tuple-element.281), metadata={op_type="Cast" op_name="while/Cast" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.361 = f16[1,128]{1,0} subtract(f16[1,128]{1,0} %custom-call.360, f16[1,128]{1,0} %convert.282), metadata={op_type="SquaredDifference" op_name="while/mean_squared_error/SquaredDifference" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.362 = f16[1,128]{1,0} multiply(f16[1,128]{1,0} %subtract.361, f16[1,128]{1,0} %subtract.361), metadata={op_type="SquaredDifference" op_name="while/mean_squared_error/SquaredDifference" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.363 = f32[1,128]{1,0} convert(f16[1,128]{1,0} %multiply.362), metadata={op_type="Mean" op_name="while/mean_squared_error/Mean" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.364 = f32[] constant(0), metadata={op_type="Mean" op_name="while/mean_squared_error/Mean" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.365 = f32[] convert(f32[] %constant.364), metadata={op_type="Mean" op_name="while/mean_squared_error/Mean" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reduce.366 = f32[1]{0} reduce(f32[1,128]{1,0} %convert.363, f32[] %convert.365), dimensions={1}, to_apply=%while_mean_squared_error_Mean-reduction.40, metadata={op_type="Mean" op_name="while/mean_squared_error/Mean" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.367 = s32[] constant(128), metadata={op_type="Mean" op_name="while/mean_squared_error/Mean" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.368 = f32[] convert(s32[] %constant.367), metadata={op_type="Mean" op_name="while/mean_squared_error/Mean" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.369 = f32[1]{0} broadcast(f32[] %convert.368), dimensions={}, metadata={op_type="Mean" op_name="while/mean_squared_error/Mean" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %divide.370 = f32[1]{0} divide(f32[1]{0} %reduce.366, f32[1]{0} %broadcast.369), metadata={op_type="Mean" op_name="while/mean_squared_error/Mean" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.371 = f16[1]{0} convert(f32[1]{0} %divide.370), metadata={op_type="Mean" op_name="while/mean_squared_error/Mean" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.372 = f32[1]{0} convert(f16[1]{0} %convert.371), metadata={op_type="Cast" op_name="while/mean_squared_error/weighted_loss/Cast" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.374 = f32[] constant(1), metadata={op_type="Mul" op_name="while/mean_squared_error/weighted_loss/Mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.375 = f32[1]{0} broadcast(f32[] %constant.374), dimensions={}, metadata={op_type="Mul" op_name="while/mean_squared_error/weighted_loss/Mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.376 = f32[1]{0} multiply(f32[1]{0} %convert.372, f32[1]{0} %broadcast.375), metadata={op_type="Mul" op_name="while/mean_squared_error/weighted_loss/Mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.377 = f32[1]{0} convert(f32[1]{0} %multiply.376), metadata={op_type="Sum" op_name="while/mean_squared_error/weighted_loss/Sum" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.378 = f32[] constant(0), metadata={op_type="Sum" op_name="while/mean_squared_error/weighted_loss/Sum" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.379 = f32[] convert(f32[] %constant.378), metadata={op_type="Sum" op_name="while/mean_squared_error/weighted_loss/Sum" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reduce.380 = f32[] reduce(f32[1]{0} %convert.377, f32[] %convert.379), dimensions={0}, to_apply=%while_mean_squared_error_weighted_loss_Sum-reduction.44, metadata={op_type="Sum" op_name="while/mean_squared_error/weighted_loss/Sum" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.381 = f32[] convert(f32[] %reduce.380), metadata={op_type="Sum" op_name="while/mean_squared_error/weighted_loss/Sum" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %divide.405 = f32[] divide(f32[] %convert.381, f32[] %constant.400), metadata={op_type="DivNoNan" op_name="while/mean_squared_error/weighted_loss/value" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %select.406 = f32[] select(pred[] %compare.402, f32[] %broadcast.404, f32[] %divide.405), metadata={op_type="DivNoNan" op_name="while/mean_squared_error/weighted_loss/value" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.407 = f16[] convert(f32[] %select.406), metadata={op_type="Cast" op_name="while/mean_squared_error/weighted_loss/Cast_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.408 = f32[] convert(f16[] %convert.407), metadata={op_type="Cast" op_name="while/Cast_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.410 = f32[] constant(1), metadata={op_type="Mul" op_name="while/Mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.411 = f32[] multiply(f32[] %convert.408, f32[] %constant.410), metadata={op_type="Mul" op_name="while/Mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %add.412 = f32[] add(f32[] %get-tuple-element.237, f32[] %multiply.411), metadata={op_type="AssignAddVariableOp" op_name="while/AssignAddVariableOp" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %divide.419 = f32[] divide(f32[] %add.412, f32[] %add.414), metadata={op_type="DivNoNan" op_name="while/div_no_nan" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %select.420 = f32[] select(pred[] %compare.416, f32[] %broadcast.418, f32[] %divide.419), metadata={op_type="DivNoNan" op_name="while/div_no_nan" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %after-all.421 = token[] after-all(), metadata={op_type="PopDatastreamOutfeedEnqueue" op_name="while/PopDatastreamOutfeedEnqueue" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %outfeed.422 = token[] outfeed(f32[] %select.420, token[] %after-all.421), outfeed_shape=f32[], outfeed_config="\022\0012\"\001\001(\003", metadata={op_type="PopDatastreamOutfeedEnqueue" op_name="while/PopDatastreamOutfeedEnqueue" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.423 = s32[] constant(1), metadata={op_type="AddV2" op_name="while/add" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.426 = s32[] constant(2), metadata={op_type="FloorMod" op_name="while/FloorMod" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.437 = s32[] constant(0), metadata={op_type="Equal" op_name="while/Equal" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.240 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.228), index=11
  %constant.427 = s32[] constant(2), metadata={op_type="FloorMod" op_name="while/FloorMod" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %remainder.429 = s32[] remainder(s32[] %get-tuple-element.240, s32[] %constant.427), metadata={op_type="FloorMod" op_name="while/FloorMod" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.428 = s32[] constant(0), metadata={op_type="FloorMod" op_name="while/FloorMod" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %compare.432 = pred[] compare(s32[] %remainder.429, s32[] %constant.428), direction=LT, metadata={op_type="FloorMod" op_name="while/FloorMod" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %compare.431 = pred[] compare(s32[] %constant.427, s32[] %constant.428), direction=LT, metadata={op_type="FloorMod" op_name="while/FloorMod" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %compare.433 = pred[] compare(pred[] %compare.432, pred[] %compare.431), direction=NE, metadata={op_type="FloorMod" op_name="while/FloorMod" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %compare.430 = pred[] compare(s32[] %remainder.429, s32[] %constant.428), direction=NE, metadata={op_type="FloorMod" op_name="while/FloorMod" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %and.434 = pred[] and(pred[] %compare.433, pred[] %compare.430), metadata={op_type="FloorMod" op_name="while/FloorMod" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %add.435 = s32[] add(s32[] %remainder.429, s32[] %constant.427), metadata={op_type="FloorMod" op_name="while/FloorMod" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %select.436 = s32[] select(pred[] %and.434, s32[] %add.435, s32[] %remainder.429), metadata={op_type="FloorMod" op_name="while/FloorMod" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.438 = s32[] constant(0), metadata={op_type="Equal" op_name="while/Equal" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %compare.439 = pred[] compare(s32[] %select.436, s32[] %constant.438), direction=EQ, metadata={op_type="Equal" op_name="while/Equal" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %tuple.440 = (s32[]) tuple(s32[] %get-tuple-element.240), metadata={op_type="StatelessIf" op_name="while/cond_4" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %conditional.441 = (s32[]) conditional(pred[] %compare.439, (s32[]) %tuple.440, (s32[]) %tuple.440), true_computation=%while_cond_4_true_962__.48, false_computation=%while_cond_4_false_963__.53, metadata={op_type="StatelessIf" op_name="while/cond_4" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.442 = s32[] get-tuple-element((s32[]) %conditional.441), index=0, metadata={op_type="StatelessIf" op_name="while/cond_4" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %call.443 = (s32[], s32[]) call(s32[] %get-tuple-element.240, s32[] %get-tuple-element.442), to_apply=%a_inference_f_999__.60
  %get-tuple-element.444 = s32[] get-tuple-element((s32[], s32[]) %call.443), index=0
  %constant.447 = f16[] constant(1), metadata={op_type="Mul" op_name="gradient_tape/while/mul_1/Mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.451 = f32[] constant(1), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.459 = s32[0]{0} constant({}), metadata={op_type="Reshape" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/Reshape" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.461 = s32[0]{0} constant({}), metadata={op_type="Reshape" op_name="gradient_tape/while/mean_squared_error/weighted_loss/Reshape" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.463 = s32[1]{0} constant({1}), metadata={op_type="Reshape" op_name="gradient_tape/while/mean_squared_error/weighted_loss/Reshape_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.465 = s32[1]{0} constant({1}), metadata={op_type="Tile" op_name="gradient_tape/while/mean_squared_error/weighted_loss/Tile_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.466 = f32[] constant(1), metadata={op_type="Mul" op_name="gradient_tape/while/mean_squared_error/weighted_loss/Mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.471 = s32[] constant(1), metadata={op_type="Reshape" op_name="gradient_tape/while/mean_squared_error/Reshape" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.472 = s32[2]{0} broadcast(s32[] %constant.471), dimensions={}, metadata={op_type="Reshape" op_name="gradient_tape/while/mean_squared_error/Reshape" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.474 = s32[2]{0} constant({1, 128}), metadata={op_type="Tile" op_name="gradient_tape/while/mean_squared_error/Tile" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.478 = f16[] constant(128), metadata={op_type="RealDiv" op_name="gradient_tape/while/mean_squared_error/truediv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.482 = f16[] constant(2), metadata={op_type="Mul" op_name="gradient_tape/while/mean_squared_error/Mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.483 = f16[] constant(2), metadata={op_type="Mul" op_name="gradient_tape/while/mean_squared_error/Mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.484 = f16[1,128]{1,0} broadcast(f16[] %constant.483), dimensions={}, metadata={op_type="Mul" op_name="gradient_tape/while/mean_squared_error/Mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.452 = f32[] constant(1), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.453 = f32[] constant(0), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %compare.454 = pred[] compare(f32[] %constant.452, f32[] %constant.453), direction=EQ, metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.455 = f32[] constant(0), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.456 = f32[] broadcast(f32[] %constant.455), dimensions={}, metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.239 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.228), index=10
  %convert.446 = f16[] convert(f32[] %get-tuple-element.239), metadata={op_type="Cast" op_name="while/Cast_3" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.448 = f16[] constant(1), metadata={op_type="Mul" op_name="gradient_tape/while/mul_1/Mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.449 = f16[] multiply(f16[] %convert.446, f16[] %constant.448), metadata={op_type="Mul" op_name="gradient_tape/while/mul_1/Mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.450 = f32[] convert(f16[] %multiply.449), metadata={op_type="Cast" op_name="gradient_tape/while/mean_squared_error/weighted_loss/Cast_1/Cast" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %divide.457 = f32[] divide(f32[] %convert.450, f32[] %constant.452), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %select.458 = f32[] select(pred[] %compare.454, f32[] %broadcast.456, f32[] %divide.457), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reshape.460 = f32[] reshape(f32[] %select.458), metadata={op_type="Reshape" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/Reshape" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reshape.462 = f32[] reshape(f32[] %reshape.460), metadata={op_type="Reshape" op_name="gradient_tape/while/mean_squared_error/weighted_loss/Reshape" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reshape.464 = f32[1]{0} reshape(f32[] %reshape.462), metadata={op_type="Reshape" op_name="gradient_tape/while/mean_squared_error/weighted_loss/Reshape_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.467 = f32[] constant(1), metadata={op_type="Mul" op_name="gradient_tape/while/mean_squared_error/weighted_loss/Mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.468 = f32[1]{0} broadcast(f32[] %constant.467), dimensions={}, metadata={op_type="Mul" op_name="gradient_tape/while/mean_squared_error/weighted_loss/Mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.469 = f32[1]{0} multiply(f32[1]{0} %reshape.464, f32[1]{0} %broadcast.468), metadata={op_type="Mul" op_name="gradient_tape/while/mean_squared_error/weighted_loss/Mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.470 = f16[1]{0} convert(f32[1]{0} %multiply.469), metadata={op_type="Cast" op_name="gradient_tape/while/mean_squared_error/weighted_loss/Cast/Cast" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reshape.473 = f16[1,1]{1,0} reshape(f16[1]{0} %convert.470), metadata={op_type="Reshape" op_name="gradient_tape/while/mean_squared_error/Reshape" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.475 = f16[1,1]{1,0} broadcast(f16[1,1]{1,0} %reshape.473), dimensions={0,1}, metadata={op_type="Tile" op_name="gradient_tape/while/mean_squared_error/Tile" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reshape.476 = f16[1]{0} reshape(f16[1,1]{1,0} %broadcast.475), metadata={op_type="Tile" op_name="gradient_tape/while/mean_squared_error/Tile" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.477 = f16[1,128]{1,0} broadcast(f16[1]{0} %reshape.476), dimensions={0}, metadata={op_type="Tile" op_name="gradient_tape/while/mean_squared_error/Tile" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.479 = f16[] constant(128), metadata={op_type="RealDiv" op_name="gradient_tape/while/mean_squared_error/truediv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.480 = f16[1,128]{1,0} broadcast(f16[] %constant.479), dimensions={}, metadata={op_type="RealDiv" op_name="gradient_tape/while/mean_squared_error/truediv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %divide.481 = f16[1,128]{1,0} divide(f16[1,128]{1,0} %broadcast.477, f16[1,128]{1,0} %broadcast.480), metadata={op_type="RealDiv" op_name="gradient_tape/while/mean_squared_error/truediv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.485 = f16[1,128]{1,0} multiply(f16[1,128]{1,0} %broadcast.484, f16[1,128]{1,0} %divide.481), metadata={op_type="Mul" op_name="gradient_tape/while/mean_squared_error/Mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.486 = f16[1,128]{1,0} subtract(f16[1,128]{1,0} %custom-call.360, f16[1,128]{1,0} %convert.282), metadata={op_type="Sub" op_name="gradient_tape/while/mean_squared_error/sub" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.487 = f16[1,128]{1,0} multiply(f16[1,128]{1,0} %multiply.485, f16[1,128]{1,0} %subtract.486), metadata={op_type="Mul" op_name="gradient_tape/while/mean_squared_error/mul_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %negate.488 = f16[1,128]{1,0} negate(f16[1,128]{1,0} %multiply.487), metadata={op_type="Neg" op_name="gradient_tape/while/mean_squared_error/Neg" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.241 = f32[2]{0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.228), index=12
  %constant.497 = pred[] constant(true), metadata={op_type="StatelessIf" op_name="while/cond" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %custom-call.489 = f16[1,128]{1,0} custom-call(f16[1,128]{1,0} %custom-call.360, f16[1,128]{1,0} %multiply.487), custom_call_target="ReluGrad", metadata={op_type="ReluGrad" op_name="gradient_tape/while/model/dense/ReluGrad" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}, backend_config="null"
  %dot.494 = f16[4,128]{1,0} dot(f16[1,4]{1,0} %convert.283, f16[1,128]{1,0} %custom-call.489), lhs_contracting_dims={0}, rhs_contracting_dims={0}, metadata={op_type="MatMul" op_name="gradient_tape/while/model/dense/MatMul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %transpose.495 = f16[4,128]{1,0} transpose(f16[4,128]{1,0} %dot.494), dimensions={0,1}, metadata={op_type="MatMul" op_name="gradient_tape/while/model/dense/MatMul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.233 = f32[1]{0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.228), index=4
  %tuple.496 = (f16[4,128]{1,0}, f32[2]{0}, f32[1]{0}) tuple(f16[4,128]{1,0} %transpose.495, f32[2]{0} %get-tuple-element.241, f32[1]{0} %get-tuple-element.233), metadata={op_type="StatelessIf" op_name="while/cond" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %conditional.498 = (f32[2]{0}) conditional(pred[] %constant.497, (f16[4,128]{1,0}, f32[2]{0}, f32[1]{0}) %tuple.496, (f16[4,128]{1,0}, f32[2]{0}, f32[1]{0}) %tuple.496), true_computation=%while_cond_true_805__.70, false_computation=%while_cond_false_806__.80, metadata={op_type="StatelessIf" op_name="while/cond" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.499 = f32[2]{0} get-tuple-element((f32[2]{0}) %conditional.498), index=0, metadata={op_type="StatelessIf" op_name="while/cond" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %call.500 = (f32[2]{0}, f32[2]{0}) call(f32[2]{0} %get-tuple-element.241, f32[2]{0} %get-tuple-element.499), to_apply=%a_inference_f_831__.86
  %get-tuple-element.501 = f32[2]{0} get-tuple-element((f32[2]{0}, f32[2]{0}) %call.500), index=0
  %get-tuple-element.502 = f32[2]{0} get-tuple-element((f32[2]{0}, f32[2]{0}) %call.500), index=1
  %constant.504 = pred[] constant(true), metadata={op_type="StatelessIf" op_name="while/cond_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.491 = f32[1,128]{1,0} convert(f16[1,128]{1,0} %custom-call.489), metadata={op_name="gradient_tape/while/model/dense/BiasAdd/BiasAddGrad"}
  %constant.490 = f32[] constant(0), metadata={op_type="BiasAddGrad" op_name="gradient_tape/while/model/dense/BiasAdd/BiasAddGrad" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reduce.492 = f32[128]{0} reduce(f32[1,128]{1,0} %convert.491, f32[] %constant.490), dimensions={0}, to_apply=%region_0.66, metadata={op_name="gradient_tape/while/model/dense/BiasAdd/BiasAddGrad"}
  %convert.493 = f16[128]{0} convert(f32[128]{0} %reduce.492), metadata={op_name="gradient_tape/while/model/dense/BiasAdd/BiasAddGrad"}
  %tuple.503 = (f16[128]{0}, f32[2]{0}, f32[1]{0}) tuple(f16[128]{0} %convert.493, f32[2]{0} %get-tuple-element.502, f32[1]{0} %get-tuple-element.233), metadata={op_type="StatelessIf" op_name="while/cond_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %conditional.505 = (f32[2]{0}) conditional(pred[] %constant.504, (f16[128]{0}, f32[2]{0}, f32[1]{0}) %tuple.503, (f16[128]{0}, f32[2]{0}, f32[1]{0}) %tuple.503), true_computation=%while_cond_1_true_839__.92, false_computation=%while_cond_1_false_840__.102, metadata={op_type="StatelessIf" op_name="while/cond_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.506 = f32[2]{0} get-tuple-element((f32[2]{0}) %conditional.505), index=0, metadata={op_type="StatelessIf" op_name="while/cond_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %call.507 = (f32[2]{0}, f32[2]{0}) call(f32[2]{0} %get-tuple-element.502, f32[2]{0} %get-tuple-element.506), to_apply=%a_inference_f_865__.108
  %get-tuple-element.508 = f32[2]{0} get-tuple-element((f32[2]{0}, f32[2]{0}) %call.507), index=0
  %get-tuple-element.509 = f32[2]{0} get-tuple-element((f32[2]{0}, f32[2]{0}) %call.507), index=1
  %tuple.510 = (f32[2]{0}) tuple(f32[2]{0} %get-tuple-element.509), metadata={op_type="StatelessIf" op_name="while/cond_3" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %conditional.511 = (f32[2]{0}) conditional(pred[] %compare.439, (f32[2]{0}) %tuple.510, (f32[2]{0}) %tuple.510), true_computation=%while_cond_3_true_951__.114, false_computation=%while_cond_3_false_952__.120, metadata={op_type="StatelessIf" op_name="while/cond_3" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.512 = f32[2]{0} get-tuple-element((f32[2]{0}) %conditional.511), index=0, metadata={op_type="StatelessIf" op_name="while/cond_3" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %call.513 = (f32[2]{0}, f32[2]{0}) call(f32[2]{0} %get-tuple-element.509, f32[2]{0} %get-tuple-element.512), to_apply=%a_inference_f_990__.124
  %get-tuple-element.514 = f32[2]{0} get-tuple-element((f32[2]{0}, f32[2]{0}) %call.513), index=0
  %constant.517 = s32[0]{0} constant({}), metadata={op_type="Reshape" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/Reshape_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.392 = f32[] constant(1), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.393 = f32[] constant(0), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %compare.394 = pred[] compare(f32[] %constant.392, f32[] %constant.393), direction=EQ, metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.395 = f32[] constant(0), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.396 = f32[] broadcast(f32[] %constant.395), dimensions={}, metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.384 = f32[] constant(1), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.385 = f32[] constant(0), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %compare.386 = pred[] compare(f32[] %constant.384, f32[] %constant.385), direction=EQ, metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.387 = f32[] constant(0), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.388 = f32[] broadcast(f32[] %constant.387), dimensions={}, metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %negate.382 = f32[] negate(f32[] %convert.381), metadata={op_type="Neg" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/Neg" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %divide.389 = f32[] divide(f32[] %negate.382, f32[] %constant.384), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %select.390 = f32[] select(pred[] %compare.386, f32[] %broadcast.388, f32[] %divide.389), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %divide.397 = f32[] divide(f32[] %select.390, f32[] %constant.392), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %select.398 = f32[] select(pred[] %compare.394, f32[] %broadcast.396, f32[] %divide.397), metadata={op_type="DivNoNan" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.516 = f32[] multiply(f32[] %convert.450, f32[] %select.398), metadata={op_type="Mul" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/mul" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reshape.518 = f32[] reshape(f32[] %multiply.516), metadata={op_type="Reshape" op_name="gradient_tape/while/mean_squared_error/weighted_loss/value/Reshape_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.519 = f16[] multiply(f16[] %convert.446, f16[] %convert.407), metadata={op_type="Mul" op_name="while/mul_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %tuple.582 = (f32[2]{0}, f32[]) tuple(f32[2]{0} %get-tuple-element.509, f32[] %get-tuple-element.239), metadata={op_type="StatelessIf" op_name="while/cond_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %conditional.583 = (f32[]) conditional(pred[] %compare.439, (f32[2]{0}, f32[]) %tuple.582, (f32[2]{0}, f32[]) %tuple.582), true_computation=%while_cond_2_true_875__.178, false_computation=%while_cond_2_false_876__.216, metadata={op_type="StatelessIf" op_name="while/cond_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.584 = f32[] get-tuple-element((f32[]) %conditional.583), index=0, metadata={op_type="StatelessIf" op_name="while/cond_2" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %call.585 = (f32[], f32[]) call(f32[] %get-tuple-element.239, f32[] %get-tuple-element.584), to_apply=%a_inference_f_981__.221
  %get-tuple-element.586 = f32[] get-tuple-element((f32[], f32[]) %call.585), index=0
  %constant.588 = s32[] constant(1), metadata={op_type="AddV2" op_name="while/add_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.229 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.228), index=0
  %constant.589 = s32[] constant(1), metadata={op_type="AddV2" op_name="while/add_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %add.590 = s32[] add(s32[] %get-tuple-element.229, s32[] %constant.589), metadata={op_type="AddV2" op_name="while/add_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.230 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.228), index=1
  %get-tuple-element.231 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.228), index=2
  %constant.424 = s32[] constant(1), metadata={op_type="AddV2" op_name="while/add" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %add.425 = s32[] add(s32[] %get-tuple-element.231, s32[] %constant.424), metadata={op_type="AddV2" op_name="while/add" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.232 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.228), index=3
  %get-tuple-element.234 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.228), index=5
  %get-tuple-element.246 = f16[4,128]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.228), index=17
  %broadcast.533 = f16[4,128]{1,0} broadcast(f16[] %convert.284), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.534 = f16[4,128]{1,0} multiply(f16[4,128]{1,0} %get-tuple-element.246, f16[4,128]{1,0} %broadcast.533), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.520 = f16[] convert(f32[] %get-tuple-element.239), metadata={op_type="Cast" op_name="while/Cast_4" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.521 = f16[4,128]{1,0} broadcast(f16[] %convert.520), dimensions={}, metadata={op_type="RealDiv" op_name="while/truediv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %divide.522 = f16[4,128]{1,0} divide(f16[4,128]{1,0} %transpose.495, f16[4,128]{1,0} %broadcast.521), metadata={op_type="RealDiv" op_name="while/truediv" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.524 = f16[] constant(1), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.530 = f16[] subtract(f16[] %constant.524, f16[] %convert.284), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.531 = f16[4,128]{1,0} broadcast(f16[] %subtract.530), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.532 = f16[4,128]{1,0} multiply(f16[4,128]{1,0} %divide.522, f16[4,128]{1,0} %broadcast.531), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %add.535 = f16[4,128]{1,0} add(f16[4,128]{1,0} %multiply.534, f16[4,128]{1,0} %multiply.532), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.526 = f16[] subtract(f16[] %constant.524, f16[] %power.319), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %sqrt.527 = f16[] sqrt(f16[] %subtract.526), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.528 = f16[] multiply(f16[] %convert.308, f16[] %sqrt.527), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.525 = f16[] subtract(f16[] %constant.524, f16[] %power.315), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %divide.529 = f16[] divide(f16[] %multiply.528, f16[] %subtract.525), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.546 = f16[4,128]{1,0} broadcast(f16[] %divide.529), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.547 = f16[4,128]{1,0} multiply(f16[4,128]{1,0} %add.535, f16[4,128]{1,0} %broadcast.546), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.247 = f16[4,128]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.228), index=18
  %broadcast.540 = f16[4,128]{1,0} broadcast(f16[] %convert.296), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.541 = f16[4,128]{1,0} multiply(f16[4,128]{1,0} %get-tuple-element.247, f16[4,128]{1,0} %broadcast.540), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.537 = f16[4,128]{1,0} multiply(f16[4,128]{1,0} %divide.522, f16[4,128]{1,0} %divide.522), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.536 = f16[] subtract(f16[] %constant.524, f16[] %convert.296), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.538 = f16[4,128]{1,0} broadcast(f16[] %subtract.536), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.539 = f16[4,128]{1,0} multiply(f16[4,128]{1,0} %multiply.537, f16[4,128]{1,0} %broadcast.538), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %add.542 = f16[4,128]{1,0} add(f16[4,128]{1,0} %multiply.541, f16[4,128]{1,0} %multiply.539), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %sqrt.543 = f16[4,128]{1,0} sqrt(f16[4,128]{1,0} %add.542), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.523 = f16[] constant(1.1921e-07), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.544 = f16[4,128]{1,0} broadcast(f16[] %constant.523), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %add.545 = f16[4,128]{1,0} add(f16[4,128]{1,0} %sqrt.543, f16[4,128]{1,0} %broadcast.544), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %divide.548 = f16[4,128]{1,0} divide(f16[4,128]{1,0} %multiply.547, f16[4,128]{1,0} %add.545), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.549 = f16[4,128]{1,0} subtract(f16[4,128]{1,0} %get-tuple-element.235, f16[4,128]{1,0} %divide.548), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %tuple.591 = (f16[4,128]{1,0}) tuple(f16[4,128]{1,0} %subtract.549), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.592 = f16[4,128]{1,0} get-tuple-element((f16[4,128]{1,0}) %tuple.591), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.248 = f16[128]{0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.228), index=19
  %broadcast.563 = f16[128]{0} broadcast(f16[] %convert.288), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.564 = f16[128]{0} multiply(f16[128]{0} %get-tuple-element.248, f16[128]{0} %broadcast.563), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %convert.550 = f16[] convert(f32[] %get-tuple-element.239), metadata={op_type="Cast" op_name="while/Cast_5" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.551 = f16[128]{0} broadcast(f16[] %convert.550), dimensions={}, metadata={op_type="RealDiv" op_name="while/truediv_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %divide.552 = f16[128]{0} divide(f16[128]{0} %convert.493, f16[128]{0} %broadcast.551), metadata={op_type="RealDiv" op_name="while/truediv_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.554 = f16[] constant(1), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.560 = f16[] subtract(f16[] %constant.554, f16[] %convert.288), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.561 = f16[128]{0} broadcast(f16[] %subtract.560), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.562 = f16[128]{0} multiply(f16[128]{0} %divide.552, f16[128]{0} %broadcast.561), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %add.565 = f16[128]{0} add(f16[128]{0} %multiply.564, f16[128]{0} %multiply.562), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.556 = f16[] subtract(f16[] %constant.554, f16[] %power.334), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %sqrt.557 = f16[] sqrt(f16[] %subtract.556), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.558 = f16[] multiply(f16[] %convert.309, f16[] %sqrt.557), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.555 = f16[] subtract(f16[] %constant.554, f16[] %power.330), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %divide.559 = f16[] divide(f16[] %multiply.558, f16[] %subtract.555), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.576 = f16[128]{0} broadcast(f16[] %divide.559), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.577 = f16[128]{0} multiply(f16[128]{0} %add.565, f16[128]{0} %broadcast.576), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.249 = f16[128]{0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.228), index=20
  %broadcast.570 = f16[128]{0} broadcast(f16[] %convert.300), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.571 = f16[128]{0} multiply(f16[128]{0} %get-tuple-element.249, f16[128]{0} %broadcast.570), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.567 = f16[128]{0} multiply(f16[128]{0} %divide.552, f16[128]{0} %divide.552), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.566 = f16[] subtract(f16[] %constant.554, f16[] %convert.300), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.568 = f16[128]{0} broadcast(f16[] %subtract.566), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.569 = f16[128]{0} multiply(f16[128]{0} %multiply.567, f16[128]{0} %broadcast.568), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %add.572 = f16[128]{0} add(f16[128]{0} %multiply.571, f16[128]{0} %multiply.569), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %sqrt.573 = f16[128]{0} sqrt(f16[128]{0} %add.572), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.553 = f16[] constant(1.1921e-07), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.574 = f16[128]{0} broadcast(f16[] %constant.553), dimensions={}, metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %add.575 = f16[128]{0} add(f16[128]{0} %sqrt.573, f16[128]{0} %broadcast.574), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %divide.578 = f16[128]{0} divide(f16[128]{0} %multiply.577, f16[128]{0} %add.575), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %subtract.579 = f16[128]{0} subtract(f16[128]{0} %get-tuple-element.236, f16[128]{0} %divide.578), metadata={op_type="ResourceApplyAdam" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/update_1/ResourceApplyAdam" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %tuple.593 = (f16[128]{0}) tuple(f16[128]{0} %subtract.579), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.594 = f16[128]{0} get-tuple-element((f16[128]{0}) %tuple.593), index=0, metadata={op_name="XLA_Retvals"}
  %tuple.595 = (f32[]) tuple(f32[] %add.412), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.596 = f32[] get-tuple-element((f32[]) %tuple.595), index=0, metadata={op_name="XLA_Retvals"}
  %tuple.597 = (f32[]) tuple(f32[] %add.414), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.598 = f32[] get-tuple-element((f32[]) %tuple.597), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.587 = f32[] get-tuple-element((f32[], f32[]) %call.585), index=1
  %tuple.599 = (f32[]) tuple(f32[] %get-tuple-element.587), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.600 = f32[] get-tuple-element((f32[]) %tuple.599), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.445 = s32[] get-tuple-element((s32[], s32[]) %call.443), index=1
  %tuple.601 = (s32[]) tuple(s32[] %get-tuple-element.445), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.602 = s32[] get-tuple-element((s32[]) %tuple.601), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.515 = f32[2]{0} get-tuple-element((f32[2]{0}, f32[2]{0}) %call.513), index=1
  %tuple.603 = (f32[2]{0}) tuple(f32[2]{0} %get-tuple-element.515), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.604 = f32[2]{0} get-tuple-element((f32[2]{0}) %tuple.603), index=0, metadata={op_name="XLA_Retvals"}
  %tuple.605 = (f32[]) tuple(f32[] %get-tuple-element.242), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.606 = f32[] get-tuple-element((f32[]) %tuple.605), index=0, metadata={op_name="XLA_Retvals"}
  %tuple.607 = (s64[]) tuple(s64[] %get-tuple-element.243), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.608 = s64[] get-tuple-element((s64[]) %tuple.607), index=0, metadata={op_name="XLA_Retvals"}
  %tuple.609 = (f32[]) tuple(f32[] %get-tuple-element.244), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.610 = f32[] get-tuple-element((f32[]) %tuple.609), index=0, metadata={op_name="XLA_Retvals"}
  %tuple.611 = (f32[]) tuple(f32[] %get-tuple-element.245), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.612 = f32[] get-tuple-element((f32[]) %tuple.611), index=0, metadata={op_name="XLA_Retvals"}
  %tuple.613 = (f16[4,128]{1,0}) tuple(f16[4,128]{1,0} %add.535), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.614 = f16[4,128]{1,0} get-tuple-element((f16[4,128]{1,0}) %tuple.613), index=0, metadata={op_name="XLA_Retvals"}
  %tuple.615 = (f16[4,128]{1,0}) tuple(f16[4,128]{1,0} %add.542), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.616 = f16[4,128]{1,0} get-tuple-element((f16[4,128]{1,0}) %tuple.615), index=0, metadata={op_name="XLA_Retvals"}
  %tuple.617 = (f16[128]{0}) tuple(f16[128]{0} %add.565), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.618 = f16[128]{0} get-tuple-element((f16[128]{0}) %tuple.617), index=0, metadata={op_name="XLA_Retvals"}
  %tuple.619 = (f16[128]{0}) tuple(f16[128]{0} %add.572), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.620 = f16[128]{0} get-tuple-element((f16[128]{0}) %tuple.619), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.250 = s64[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.228), index=21
  %constant.580 = s64[] constant(1), metadata={op_type="AssignAddVariableOp" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/AssignAddVariableOp" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %add.581 = s64[] add(s64[] %get-tuple-element.250, s64[] %constant.580), metadata={op_type="AssignAddVariableOp" op_name="while/AutomaticLossScalingOptimizer/AutomaticLossScalingOptimizer/AssignAddVariableOp" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %tuple.621 = (s64[]) tuple(s64[] %add.581), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.622 = s64[] get-tuple-element((s64[]) %tuple.621), index=0, metadata={op_name="XLA_Retvals"}
  ROOT %tuple.623 = (s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) tuple(s32[] %add.590, s32[] %get-tuple-element.230, s32[] %add.425, s32[] %get-tuple-element.232, f32[1]{0} %get-tuple-element.233, /*index=5*/s32[] %get-tuple-element.234, f16[4,128]{1,0} %get-tuple-element.592, f16[128]{0} %get-tuple-element.594, f32[] %get-tuple-element.596, f32[] %get-tuple-element.598, /*index=10*/f32[] %get-tuple-element.600, s32[] %get-tuple-element.602, f32[2]{0} %get-tuple-element.604, f32[] %get-tuple-element.606, s64[] %get-tuple-element.608, /*index=15*/f32[] %get-tuple-element.610, f32[] %get-tuple-element.612, f16[4,128]{1,0} %get-tuple-element.614, f16[4,128]{1,0} %get-tuple-element.616, f16[128]{0} %get-tuple-element.618, /*index=20*/f16[128]{0} %get-tuple-element.620, s64[] %get-tuple-element.622), metadata={op_name="XLA_Retvals"}
}

%while_cond_677_const_0_rearrange_0__.624 (arg_tuple.625: (s32[], s32[], s32[], s32[], f32[1], /*index=5*/s32[], f16[4,128], f16[128], f32[], f32[], /*index=10*/f32[], s32[], f32[2], f32[], s64[], /*index=15*/f32[], f32[], f16[4,128], f16[4,128], f16[128], /*index=20*/f16[128], s64[])) -> (pred[]) {
  %arg_tuple.625 = (s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.627 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.625), index=1
  %get-tuple-element.629 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.625), index=3
  %get-tuple-element.630 = f32[1]{0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.625), index=4
  %get-tuple-element.631 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.625), index=5
  %get-tuple-element.632 = f16[4,128]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.625), index=6
  %get-tuple-element.633 = f16[128]{0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.625), index=7
  %get-tuple-element.634 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.625), index=8
  %get-tuple-element.635 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.625), index=9
  %get-tuple-element.636 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.625), index=10
  %get-tuple-element.637 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.625), index=11
  %get-tuple-element.638 = f32[2]{0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.625), index=12
  %get-tuple-element.639 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.625), index=13
  %get-tuple-element.640 = s64[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.625), index=14
  %get-tuple-element.641 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.625), index=15
  %get-tuple-element.642 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.625), index=16
  %get-tuple-element.643 = f16[4,128]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.625), index=17
  %get-tuple-element.644 = f16[4,128]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.625), index=18
  %get-tuple-element.645 = f16[128]{0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.625), index=19
  %get-tuple-element.646 = f16[128]{0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.625), index=20
  %get-tuple-element.647 = s64[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.625), index=21
  %constant.648 = s32[] constant(1), metadata={op_type="Less" op_name="while/Less" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.651 = s32[] constant(1), metadata={op_type="Less" op_name="while/Less_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.626 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.625), index=0
  %constant.652 = s32[] constant(1), metadata={op_type="Less" op_name="while/Less_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %compare.653 = pred[] compare(s32[] %get-tuple-element.626, s32[] %constant.652), direction=LT, metadata={op_type="Less" op_name="while/Less_1" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.628 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %arg_tuple.625), index=2
  %constant.649 = s32[] constant(1), metadata={op_type="Less" op_name="while/Less" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %compare.650 = pred[] compare(s32[] %get-tuple-element.628, s32[] %constant.649), direction=LT, metadata={op_type="Less" op_name="while/Less" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %and.654 = pred[] and(pred[] %compare.653, pred[] %compare.650), metadata={op_type="LogicalAnd" op_name="while/LogicalAnd" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  ROOT %tuple.655 = (pred[]) tuple(pred[] %and.654), metadata={op_name="XLA_Retvals"}
}

%cond_wrapper.656 (inputs.657: (s32[], s32[], s32[], s32[], f32[1], /*index=5*/s32[], f16[4,128], f16[128], f32[], f32[], /*index=10*/f32[], s32[], f32[2], f32[], s64[], /*index=15*/f32[], f32[], f16[4,128], f16[4,128], f16[128], /*index=20*/f16[128], s64[])) -> pred[] {
  %inputs.657 = (s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) parameter(0)
  %call.658 = (pred[]) call((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %inputs.657), to_apply=%while_cond_677_const_0_rearrange_0__.624
  ROOT %get-tuple-element.659 = pred[] get-tuple-element((pred[]) %call.658), index=0
}

ENTRY %a_inference_train_function_1161__XlaMustCompile_true_config_proto___n_007_n_0...02_001_000__executor_type____.739 (arg0.1: f16[4,128], arg1.2: f16[128], arg2.3: f32[], arg3.4: f32[], arg4.5: f32[], arg5.6: s32[], arg6.7: f32[2], arg7.8: f32[1], arg8.9: f32[], arg9.10: s64[], arg10.11: f32[], arg11.12: f32[], arg12.13: f16[4,128], arg13.14: f16[4,128], arg14.15: f16[128], arg15.16: f16[128], arg16.17: s64[]) -> (f16[4,128], f16[128], f32[], f32[], f32[], /*index=5*/s32[], f32[2], f16[4,128], f16[4,128], f16[128], /*index=10*/f16[128], s64[]) {
  %constant.19 = s32[] constant(0), metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.20 = s32[] constant(1), metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.21 = s32[] constant(1), metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.26 = s32[] constant(0), metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.27 = s32[1]{0} broadcast(s32[] %constant.26), dimensions={}, metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.23 = s32[] constant(1), metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %broadcast.24 = s32[1]{0} broadcast(s32[] %constant.23), dimensions={}, metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %iota.22 = s32[1]{0} iota(), iota_dimension=0, metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %multiply.25 = s32[1]{0} multiply(s32[1]{0} %broadcast.24, s32[1]{0} %iota.22), metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %add.28 = s32[1]{0} add(s32[1]{0} %broadcast.27, s32[1]{0} %multiply.25), metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.29 = s32[] constant(0), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.30 = s32[] constant(1), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.31 = s32[] constant(0), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.32 = s32[] constant(1), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.33 = s32[] constant(1), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.34 = s32[] constant(0), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.35 = s32[] constant(1), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.36 = s32[] constant(0), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %constant.37 = s32[] constant(1), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %arg7.8 = f32[1]{0} parameter(7), parameter_replication={false}, metadata={op_name="XLA_Args/dummy_input"}
  %reshape.18 = f32[1]{0} reshape(f32[1]{0} %arg7.8)
  %constant.38 = s32[] constant(1), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %arg0.1 = f16[4,128]{1,0} parameter(0), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar3"}
  %arg1.2 = f16[128]{0} parameter(1), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar4"}
  %arg2.3 = f32[] parameter(2), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar8"}
  %arg3.4 = f32[] parameter(3), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar9"}
  %arg4.5 = f32[] parameter(4), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar2"}
  %arg5.6 = s32[] parameter(5), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar1"}
  %arg6.7 = f32[2]{0} parameter(6), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar0"}
  %arg8.9 = f32[] parameter(8), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar16"}
  %arg9.10 = s64[] parameter(9), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar12"}
  %arg10.11 = f32[] parameter(10), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar13"}
  %arg11.12 = f32[] parameter(11), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar14"}
  %arg12.13 = f16[4,128]{1,0} parameter(12), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar17"}
  %arg13.14 = f16[4,128]{1,0} parameter(13), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar19"}
  %arg14.15 = f16[128]{0} parameter(14), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar18"}
  %arg15.16 = f16[128]{0} parameter(15), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar20"}
  %arg16.17 = s64[] parameter(16), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar11"}
  %tuple.39 = (s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) tuple(s32[] %constant.34, s32[] %constant.35, s32[] %constant.36, s32[] %constant.37, f32[1]{0} %reshape.18, /*index=5*/s32[] %constant.38, f16[4,128]{1,0} %arg0.1, f16[128]{0} %arg1.2, f32[] %arg2.3, f32[] %arg3.4, /*index=10*/f32[] %arg4.5, s32[] %arg5.6, f32[2]{0} %arg6.7, f32[] %arg8.9, s64[] %arg9.10, /*index=15*/f32[] %arg10.11, f32[] %arg11.12, f16[4,128]{1,0} %arg12.13, f16[4,128]{1,0} %arg13.14, f16[128]{0} %arg14.15, /*index=20*/f16[128]{0} %arg15.16, s64[] %arg16.17), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %while.660 = (s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) while((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %tuple.39), condition=%cond_wrapper.656, body=%while_body_678_const_0_rearrange_0__.227, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.661 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %while.660), index=0, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.662 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %while.660), index=1, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.663 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %while.660), index=2, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.664 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %while.660), index=3, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.665 = f32[1]{0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %while.660), index=4, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.666 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %while.660), index=5, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.667 = f16[4,128]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %while.660), index=6, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.668 = f16[128]{0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %while.660), index=7, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.669 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %while.660), index=8, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.670 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %while.660), index=9, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.671 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %while.660), index=10, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.672 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %while.660), index=11, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.673 = f32[2]{0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %while.660), index=12, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.674 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %while.660), index=13, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.675 = s64[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %while.660), index=14, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.676 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %while.660), index=15, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.677 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %while.660), index=16, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.678 = f16[4,128]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %while.660), index=17, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.679 = f16[4,128]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %while.660), index=18, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.680 = f16[128]{0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %while.660), index=19, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.681 = f16[128]{0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %while.660), index=20, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.682 = s64[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %while.660), index=21, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %tuple.683 = (s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) tuple(s32[] %get-tuple-element.661, s32[] %get-tuple-element.662, s32[] %get-tuple-element.663, s32[] %get-tuple-element.664, f32[1]{0} %get-tuple-element.665, /*index=5*/s32[] %get-tuple-element.666, f16[4,128]{1,0} %get-tuple-element.667, f16[128]{0} %get-tuple-element.668, f32[] %get-tuple-element.669, f32[] %get-tuple-element.670, /*index=10*/f32[] %get-tuple-element.671, s32[] %get-tuple-element.672, f32[2]{0} %get-tuple-element.673, f32[] %get-tuple-element.674, s64[] %get-tuple-element.675, /*index=15*/f32[] %get-tuple-element.676, f32[] %get-tuple-element.677, f16[4,128]{1,0} %get-tuple-element.678, f16[4,128]{1,0} %get-tuple-element.679, f16[128]{0} %get-tuple-element.680, /*index=20*/f16[128]{0} %get-tuple-element.681, s64[] %get-tuple-element.682), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.684 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %tuple.683), index=0, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.685 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %tuple.683), index=1, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.686 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %tuple.683), index=2, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.687 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %tuple.683), index=3, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.688 = f32[1]{0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %tuple.683), index=4, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.689 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %tuple.683), index=5, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %get-tuple-element.690 = f16[4,128]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %tuple.683), index=6, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reshape.702 = f16[4,128]{1,0} reshape(f16[4,128]{1,0} %get-tuple-element.690), metadata={op_name="XLA_Retvals"}
  %tuple.703 = (f16[4,128]{1,0}) tuple(f16[4,128]{1,0} %reshape.702), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.704 = f16[4,128]{1,0} get-tuple-element((f16[4,128]{1,0}) %tuple.703), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.691 = f16[128]{0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %tuple.683), index=7, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reshape.705 = f16[128]{0} reshape(f16[128]{0} %get-tuple-element.691), metadata={op_name="XLA_Retvals"}
  %tuple.706 = (f16[128]{0}) tuple(f16[128]{0} %reshape.705), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.707 = f16[128]{0} get-tuple-element((f16[128]{0}) %tuple.706), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.692 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %tuple.683), index=8, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reshape.708 = f32[] reshape(f32[] %get-tuple-element.692), metadata={op_name="XLA_Retvals"}
  %tuple.709 = (f32[]) tuple(f32[] %reshape.708), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.710 = f32[] get-tuple-element((f32[]) %tuple.709), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.693 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %tuple.683), index=9, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reshape.711 = f32[] reshape(f32[] %get-tuple-element.693), metadata={op_name="XLA_Retvals"}
  %tuple.712 = (f32[]) tuple(f32[] %reshape.711), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.713 = f32[] get-tuple-element((f32[]) %tuple.712), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.694 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %tuple.683), index=10, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reshape.714 = f32[] reshape(f32[] %get-tuple-element.694), metadata={op_name="XLA_Retvals"}
  %tuple.715 = (f32[]) tuple(f32[] %reshape.714), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.716 = f32[] get-tuple-element((f32[]) %tuple.715), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.695 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %tuple.683), index=11, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reshape.717 = s32[] reshape(s32[] %get-tuple-element.695), metadata={op_name="XLA_Retvals"}
  %tuple.718 = (s32[]) tuple(s32[] %reshape.717), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.719 = s32[] get-tuple-element((s32[]) %tuple.718), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.696 = f32[2]{0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %tuple.683), index=12, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reshape.720 = f32[2]{0} reshape(f32[2]{0} %get-tuple-element.696), metadata={op_name="XLA_Retvals"}
  %tuple.721 = (f32[2]{0}) tuple(f32[2]{0} %reshape.720), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.722 = f32[2]{0} get-tuple-element((f32[2]{0}) %tuple.721), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.697 = f16[4,128]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %tuple.683), index=17, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reshape.723 = f16[4,128]{1,0} reshape(f16[4,128]{1,0} %get-tuple-element.697), metadata={op_name="XLA_Retvals"}
  %tuple.724 = (f16[4,128]{1,0}) tuple(f16[4,128]{1,0} %reshape.723), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.725 = f16[4,128]{1,0} get-tuple-element((f16[4,128]{1,0}) %tuple.724), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.698 = f16[4,128]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %tuple.683), index=18, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reshape.726 = f16[4,128]{1,0} reshape(f16[4,128]{1,0} %get-tuple-element.698), metadata={op_name="XLA_Retvals"}
  %tuple.727 = (f16[4,128]{1,0}) tuple(f16[4,128]{1,0} %reshape.726), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.728 = f16[4,128]{1,0} get-tuple-element((f16[4,128]{1,0}) %tuple.727), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.699 = f16[128]{0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %tuple.683), index=19, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reshape.729 = f16[128]{0} reshape(f16[128]{0} %get-tuple-element.699), metadata={op_name="XLA_Retvals"}
  %tuple.730 = (f16[128]{0}) tuple(f16[128]{0} %reshape.729), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.731 = f16[128]{0} get-tuple-element((f16[128]{0}) %tuple.730), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.700 = f16[128]{0} get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %tuple.683), index=20, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reshape.732 = f16[128]{0} reshape(f16[128]{0} %get-tuple-element.700), metadata={op_name="XLA_Retvals"}
  %tuple.733 = (f16[128]{0}) tuple(f16[128]{0} %reshape.732), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.734 = f16[128]{0} get-tuple-element((f16[128]{0}) %tuple.733), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.701 = s64[] get-tuple-element((s32[], s32[], s32[], s32[], f32[1]{0}, /*index=5*/s32[], f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], /*index=10*/f32[], s32[], f32[2]{0}, f32[], s64[], /*index=15*/f32[], f32[], f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=20*/f16[128]{0}, s64[]) %tuple.683), index=21, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/cache/bazel/_bazel_babakk/5cf55f21c58820ac4f0d4ab28d512618/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/ipu/keras_automatic_loss_scaling_optimizer_test.runfiles/org_tensorflow/tensorflow/python/util/tf_stack.py" source_line=195}
  %reshape.735 = s64[] reshape(s64[] %get-tuple-element.701), metadata={op_name="XLA_Retvals"}
  %tuple.736 = (s64[]) tuple(s64[] %reshape.735), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.737 = s64[] get-tuple-element((s64[]) %tuple.736), index=0, metadata={op_name="XLA_Retvals"}
  ROOT %tuple.738 = (f16[4,128]{1,0}, f16[128]{0}, f32[], f32[], f32[], /*index=5*/s32[], f32[2]{0}, f16[4,128]{1,0}, f16[4,128]{1,0}, f16[128]{0}, /*index=10*/f16[128]{0}, s64[]) tuple(f16[4,128]{1,0} %get-tuple-element.704, f16[128]{0} %get-tuple-element.707, f32[] %get-tuple-element.710, f32[] %get-tuple-element.713, f32[] %get-tuple-element.716, /*index=5*/s32[] %get-tuple-element.719, f32[2]{0} %get-tuple-element.722, f16[4,128]{1,0} %get-tuple-element.725, f16[4,128]{1,0} %get-tuple-element.728, f16[128]{0} %get-tuple-element.731, /*index=10*/f16[128]{0} %get-tuple-element.734, s64[] %get-tuple-element.737), metadata={op_name="XLA_Retvals"}
}
)";

#endif  // TENSORFLOW_COMPILER_PLUGIN_POPLAR_TESTS_HLO_SAMPLES_ALS_SIMPLE_TRAINING_ADAM_HLO_H_
