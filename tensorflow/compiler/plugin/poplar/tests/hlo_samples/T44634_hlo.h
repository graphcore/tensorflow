/* Copyright 2022 The TensorFlow Authors. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
==============================================================================*/

#ifndef TENSORFLOW_COMPILER_PLUGIN_POPLAR_TESTS_HLO_SAMPLES_T44634_HLO_H_
#define TENSORFLOW_COMPILER_PLUGIN_POPLAR_TESTS_HLO_SAMPLES_T44634_HLO_H_

const char* T44634_hlo = R"(
HloModule a_inference_train_function_880__XlaMustCompile_true_config_proto___n_007_n_0...02_001_000__executor_type____.699

%while_model_scores_layer_normalization_moments_mean-reduction.35 (x.36: f32[], y.37: f32[]) -> f32[] {
  %x.36 = f32[] parameter(0)
  %y.37 = f32[] parameter(1)
  ROOT %add.38 = f32[] add(f32[] %x.36, f32[] %y.37)
}

%while_model_scores_layer_normalization_moments_variance-reduction.39 (x.40: f32[], y.41: f32[]) -> f32[] {
  %x.40 = f32[] parameter(0)
  %y.41 = f32[] parameter(1)
  ROOT %add.42 = f32[] add(f32[] %x.40, f32[] %y.41)
}

%region_0.43 (Arg_0.44: f16[], Arg_1.45: f16[]) -> f16[] {
  %Arg_0.44 = f16[] parameter(0)
  %Arg_1.45 = f16[] parameter(1)
  ROOT %maximum.46 = f16[] maximum(f16[] %Arg_0.44, f16[] %Arg_1.45), metadata={op_name="while/model/scores/dense_1/Softmax"}
}

%region_1.47 (Arg_0.48: f32[], Arg_1.49: f32[]) -> f32[] {
  %Arg_0.48 = f32[] parameter(0)
  %Arg_1.49 = f32[] parameter(1)
  ROOT %add.50 = f32[] add(f32[] %Arg_0.48, f32[] %Arg_1.49), metadata={op_name="while/model/scores/dense_1/Softmax"}
}

%max_half_.51 (x.52: f16[], y.53: f16[]) -> f16[] {
  %x.52 = f16[] parameter(0)
  %y.53 = f16[] parameter(1)
  ROOT %maximum.54 = f16[] maximum(f16[] %x.52, f16[] %y.53)
}

%add_float_.55 (x.56: f32[], y.57: f32[]) -> f32[] {
  %x.56 = f32[] parameter(0)
  %y.57 = f32[] parameter(1)
  ROOT %add.58 = f32[] add(f32[] %x.56, f32[] %y.57)
}

%add_float_.59 (x.60: f32[], y.61: f32[]) -> f32[] {
  %x.60 = f32[] parameter(0)
  %y.61 = f32[] parameter(1)
  ROOT %add.62 = f32[] add(f32[] %x.60, f32[] %y.61)
}

%region_0.63 (Arg_0.64: f32[], Arg_1.65: f32[]) -> f32[] {
  %Arg_0.64 = f32[] parameter(0)
  %Arg_1.65 = f32[] parameter(1)
  ROOT %add.66 = f32[] add(f32[] %Arg_0.64, f32[] %Arg_1.65), metadata={op_name="gradient_tape/while/model/scores/dense_1/BiasAdd/BiasAddGrad"}
}

%sum.67 (x.68: f16[], y.69: f16[]) -> f16[] {
  %x.68 = f16[] parameter(0)
  %y.69 = f16[] parameter(1)
  ROOT %add.70 = f16[] add(f16[] %x.68, f16[] %y.69)
}

%gradient_tape_while_model_scores_layer_normalization_batchnorm_mul_2_Sum-reduction.71 (x.72: f32[], y.73: f32[]) -> f32[] {
  %x.72 = f32[] parameter(0)
  %y.73 = f32[] parameter(1)
  ROOT %add.74 = f32[] add(f32[] %x.72, f32[] %y.73)
}

%gradient_tape_while_model_scores_layer_normalization_batchnorm_mul_Sum-reduction.75 (x.76: f32[], y.77: f32[]) -> f32[] {
  %x.76 = f32[] parameter(0)
  %y.77 = f32[] parameter(1)
  ROOT %add.78 = f32[] add(f32[] %x.76, f32[] %y.77)
}

%gradient_tape_while_model_scores_layer_normalization_moments_Sum-reduction.79 (x.80: f32[], y.81: f32[]) -> f32[] {
  %x.80 = f32[] parameter(0)
  %y.81 = f32[] parameter(1)
  ROOT %add.82 = f32[] add(f32[] %x.80, f32[] %y.81)
}

%region_0.83 (Arg_0.84: f32[], Arg_1.85: f32[]) -> f32[] {
  %Arg_0.84 = f32[] parameter(0)
  %Arg_1.85 = f32[] parameter(1)
  ROOT %add.86 = f32[] add(f32[] %Arg_0.84, f32[] %Arg_1.85), metadata={op_name="gradient_tape/while/model/scores/dense/BiasAdd/BiasAddGrad"}
}

%sum.87 (x.88: f16[], y.89: f16[]) -> f16[] {
  %x.88 = f16[] parameter(0)
  %y.89 = f16[] parameter(1)
  ROOT %add.90 = f16[] add(f16[] %x.88, f16[] %y.89)
}

%region_0.91 (Arg_0.92: f32[], Arg_1.93: f32[]) -> f32[] {
  %Arg_0.92 = f32[] parameter(0)
  %Arg_1.93 = f32[] parameter(1)
  ROOT %add.94 = f32[] add(f32[] %Arg_0.92, f32[] %Arg_1.93), metadata={op_name="gradient_tape/while/model/scores/conv2d/BiasAdd/BiasAddGrad"}
}

%sum.95 (x.96: f16[], y.97: f16[]) -> f16[] {
  %x.96 = f16[] parameter(0)
  %y.97 = f16[] parameter(1)
  ROOT %add.98 = f16[] add(f16[] %x.96, f16[] %y.97)
}

%sum.99 (x.100: f16[], y.101: f16[]) -> f16[] {
  %x.100 = f16[] parameter(0)
  %y.101 = f16[] parameter(1)
  ROOT %add.102 = f16[] add(f16[] %x.100, f16[] %y.101)
}

%sum.103 (x.104: f16[], y.105: f16[]) -> f16[] {
  %x.104 = f16[] parameter(0)
  %y.105 = f16[] parameter(1)
  ROOT %add.106 = f16[] add(f16[] %x.104, f16[] %y.105)
}

%gradient_tape_while_model_scores_layer_normalization_batchnorm_mul_Sum_1-reduction.107 (x.108: f32[], y.109: f32[]) -> f32[] {
  %x.108 = f32[] parameter(0)
  %y.109 = f32[] parameter(1)
  ROOT %add.110 = f32[] add(f32[] %x.108, f32[] %y.109)
}

%sum.111 (x.112: f16[], y.113: f16[]) -> f16[] {
  %x.112 = f16[] parameter(0)
  %y.113 = f16[] parameter(1)
  ROOT %add.114 = f16[] add(f16[] %x.112, f16[] %y.113)
}

%gradient_tape_while_model_scores_layer_normalization_batchnorm_sub_Sum-reduction.115 (x.116: f32[], y.117: f32[]) -> f32[] {
  %x.116 = f32[] parameter(0)
  %y.117 = f32[] parameter(1)
  ROOT %add.118 = f32[] add(f32[] %x.116, f32[] %y.117)
}

%sum.119 (x.120: f16[], y.121: f16[]) -> f16[] {
  %x.120 = f16[] parameter(0)
  %y.121 = f16[] parameter(1)
  ROOT %add.122 = f16[] add(f16[] %x.120, f16[] %y.121)
}

%sum.123 (x.124: f16[], y.125: f16[]) -> f16[] {
  %x.124 = f16[] parameter(0)
  %y.125 = f16[] parameter(1)
  ROOT %add.126 = f16[] add(f16[] %x.124, f16[] %y.125)
}

%while_sparse_categorical_crossentropy_weighted_loss_Sum-reduction.127 (x.128: f32[], y.129: f32[]) -> f32[] {
  %x.128 = f32[] parameter(0)
  %y.129 = f32[] parameter(1)
  ROOT %add.130 = f32[] add(f32[] %x.128, f32[] %y.129)
}

%while_body_577_const_0_rearrange_0__.131 (arg_tuple.132: (s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64], f16[64], f16[153664,100], f16[100], f16[100], /*index=10*/f16[100], f16[100,10], f16[10], f16[], f16[], /*index=15*/f32[], s32[], s64[])) -> (s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64], f16[64], f16[153664,100], f16[100], f16[100], /*index=10*/f16[100], f16[100,10], f16[10], f16[], f16[], /*index=15*/f32[], s32[], s64[]) {
  %constant.151 = s32[] constant(1), metadata={op_type="BroadcastGradientArgs" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul/BroadcastGradientArgs" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.152 = s32[2]{0} broadcast(s32[] %constant.151), dimensions={}, metadata={op_type="BroadcastGradientArgs" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul/BroadcastGradientArgs" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.153 = s32[1]{0} constant({100}), metadata={op_type="BroadcastGradientArgs" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul/BroadcastGradientArgs" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.154 = s32[2]{0} constant({1, 100}), metadata={op_type="BroadcastGradientArgs" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul_1/BroadcastGradientArgs" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.155 = s32[2]{0} constant({1, 100}), metadata={op_type="BroadcastGradientArgs" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul_1/BroadcastGradientArgs" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.156 = s32[] constant(1), metadata={op_type="BroadcastGradientArgs" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul_2/BroadcastGradientArgs" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.157 = s32[2]{0} broadcast(s32[] %constant.156), dimensions={}, metadata={op_type="BroadcastGradientArgs" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul_2/BroadcastGradientArgs" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.158 = s32[2]{0} constant({1, 100}), metadata={op_type="BroadcastGradientArgs" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul_2/BroadcastGradientArgs" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.159 = s32[1]{0} constant({100}), metadata={op_type="BroadcastGradientArgs" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/sub/BroadcastGradientArgs" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.160 = s32[2]{0} constant({1, 100}), metadata={op_type="BroadcastGradientArgs" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/sub/BroadcastGradientArgs" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.161 = s32[2]{0} constant({1, 100}), metadata={op_type="BroadcastGradientArgs" op_name="gradient_tape/while/model/scores/layer_normalization/moments/BroadcastGradientArgs" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.162 = s32[] constant(1), metadata={op_type="BroadcastGradientArgs" op_name="gradient_tape/while/model/scores/layer_normalization/moments/BroadcastGradientArgs" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.163 = s32[2]{0} broadcast(s32[] %constant.162), dimensions={}, metadata={op_type="BroadcastGradientArgs" op_name="gradient_tape/while/model/scores/layer_normalization/moments/BroadcastGradientArgs" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.164 = s32[] constant(1), metadata={op_type="Maximum" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Maximum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.165 = s32[2]{0} broadcast(s32[] %constant.164), dimensions={}, metadata={op_type="Maximum" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Maximum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.166 = s32[] constant(1), metadata={op_type="Maximum" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Maximum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.172 = s32[2]{0} constant({1, 100}), metadata={op_type="FloorDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.173 = s32[2]{0} constant({1, 100}), metadata={op_type="FloorDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.167 = s32[] constant(1), metadata={op_type="Maximum" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Maximum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.168 = s32[2]{0} broadcast(s32[] %constant.167), dimensions={}, metadata={op_type="Maximum" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Maximum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.169 = s32[] constant(1), metadata={op_type="Maximum" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Maximum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.170 = s32[2]{0} broadcast(s32[] %constant.169), dimensions={}, metadata={op_type="Maximum" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Maximum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %maximum.171 = s32[2]{0} maximum(s32[2]{0} %broadcast.168, s32[2]{0} %broadcast.170), metadata={op_type="Maximum" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Maximum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %divide.176 = s32[2]{0} divide(s32[2]{0} %constant.173, s32[2]{0} %maximum.171), metadata={op_type="FloorDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %multiply.182 = s32[2]{0} multiply(s32[2]{0} %divide.176, s32[2]{0} %maximum.171), metadata={op_type="FloorDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %compare.183 = pred[2]{0} compare(s32[2]{0} %multiply.182, s32[2]{0} %constant.173), direction=NE, metadata={op_type="FloorDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.174 = s32[] constant(0), metadata={op_type="FloorDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.179 = s32[2]{0} broadcast(s32[] %constant.174), dimensions={}, metadata={op_type="FloorDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %compare.180 = pred[2]{0} compare(s32[2]{0} %constant.173, s32[2]{0} %broadcast.179), direction=LT, metadata={op_type="FloorDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.177 = s32[2]{0} broadcast(s32[] %constant.174), dimensions={}, metadata={op_type="FloorDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %compare.178 = pred[2]{0} compare(s32[2]{0} %maximum.171, s32[2]{0} %broadcast.177), direction=LT, metadata={op_type="FloorDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %compare.181 = pred[2]{0} compare(pred[2]{0} %compare.180, pred[2]{0} %compare.178), direction=NE, metadata={op_type="FloorDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %and.184 = pred[2]{0} and(pred[2]{0} %compare.183, pred[2]{0} %compare.181), metadata={op_type="FloorDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.175 = s32[] constant(1), metadata={op_type="FloorDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.185 = s32[2]{0} broadcast(s32[] %constant.175), dimensions={}, metadata={op_type="FloorDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %subtract.186 = s32[2]{0} subtract(s32[2]{0} %divide.176, s32[2]{0} %broadcast.185), metadata={op_type="FloorDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %select.187 = s32[2]{0} select(pred[2]{0} %and.184, s32[2]{0} %subtract.186, s32[2]{0} %divide.176), metadata={op_type="FloorDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/floordiv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.196 = s32[1]{0} constant({-1}), metadata={op_type="Reshape" op_name="while/sparse_categorical_crossentropy/Reshape" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=3406}
  %constant.198 = s32[] constant(1), metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %convert.199 = s32[] convert(s32[] %constant.198), metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.200 = s32[1]{0} broadcast(s32[] %convert.199), dimensions={}, metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.201 = s32[] constant(100), metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %convert.202 = s32[] convert(s32[] %constant.201), metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.203 = s32[1]{0} broadcast(s32[] %convert.202), dimensions={}, metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.204 = s32[] constant(100), metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %convert.205 = s32[] convert(s32[] %constant.204), metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.206 = s32[1]{0} broadcast(s32[] %convert.205), dimensions={}, metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.207 = s32[] constant(3), metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %convert.208 = s32[] convert(s32[] %constant.207), metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.209 = s32[1]{0} broadcast(s32[] %convert.208), dimensions={}, metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %concatenate.210 = s32[4]{0} concatenate(s32[1]{0} %broadcast.200, s32[1]{0} %broadcast.203, s32[1]{0} %broadcast.206, s32[1]{0} %broadcast.209), dimensions={0}, metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.211 = s32[] constant(3), metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %convert.212 = s32[] convert(s32[] %constant.211), metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.213 = s32[1]{0} broadcast(s32[] %convert.212), dimensions={}, metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.214 = s32[] constant(3), metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %convert.215 = s32[] convert(s32[] %constant.214), metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.216 = s32[1]{0} broadcast(s32[] %convert.215), dimensions={}, metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.217 = s32[] constant(3), metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %convert.218 = s32[] convert(s32[] %constant.217), metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.219 = s32[1]{0} broadcast(s32[] %convert.218), dimensions={}, metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.220 = s32[] constant(64), metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %convert.221 = s32[] convert(s32[] %constant.220), metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.222 = s32[1]{0} broadcast(s32[] %convert.221), dimensions={}, metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %concatenate.223 = s32[4]{0} concatenate(s32[1]{0} %broadcast.213, s32[1]{0} %broadcast.216, s32[1]{0} %broadcast.219, s32[1]{0} %broadcast.222), dimensions={0}, metadata={op_type="ShapeN" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/ShapeN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.229 = s32[2]{0} constant({-1, 153664}), metadata={op_type="Reshape" op_name="while/model/scores/flatten/Reshape" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/core.py" source_line=674}
  %constant.259 = f16[] constant(0.0010004), metadata={op_type="AddV2" op_name="while/model/scores/layer_normalization/batchnorm/add" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=294}
  %after-all.188 = token[] after-all(), metadata={op_type="PopDatastreamInfeedDequeue" op_name="while/PopDatastreamInfeedDequeue" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_pop_datastream_ops.py" source_line=1198}
  %infeed.189 = ((f16[1,100,100,3]{3,2,1,0}, s32[1]{0}), token[]) infeed(token[] %after-all.188), infeed_config="\022\0011\"\002\023\003(\003", metadata={op_type="PopDatastreamInfeedDequeue" op_name="while/PopDatastreamInfeedDequeue" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_pop_datastream_ops.py" source_line=1198}
  %get-tuple-element.190 = (f16[1,100,100,3]{3,2,1,0}, s32[1]{0}) get-tuple-element(((f16[1,100,100,3]{3,2,1,0}, s32[1]{0}), token[]) %infeed.189), index=0, metadata={op_type="PopDatastreamInfeedDequeue" op_name="while/PopDatastreamInfeedDequeue" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_pop_datastream_ops.py" source_line=1198}
  %get-tuple-element.191 = f16[1,100,100,3]{3,2,1,0} get-tuple-element((f16[1,100,100,3]{3,2,1,0}, s32[1]{0}) %get-tuple-element.190), index=0, metadata={op_type="PopDatastreamInfeedDequeue" op_name="while/PopDatastreamInfeedDequeue" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_pop_datastream_ops.py" source_line=1198}
  %arg_tuple.132 = (s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.138 = f16[3,3,3,64]{3,2,1,0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.132), index=5
  %convolution.224 = f16[1,98,98,64]{3,2,1,0} convolution(f16[1,100,100,3]{3,2,1,0} %get-tuple-element.191, f16[3,3,3,64]{3,2,1,0} %get-tuple-element.138), window={size=3x3}, dim_labels=b01f_01io->b01f, metadata={op_type="Conv2D" op_name="while/model/scores/conv2d/Conv2D" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/convolutional.py" source_line=249}
  %get-tuple-element.139 = f16[64]{0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.132), index=6
  %broadcast.225 = f16[1,98,98,64]{3,2,1,0} broadcast(f16[64]{0} %get-tuple-element.139), dimensions={3}, metadata={op_type="BiasAdd" op_name="while/model/scores/conv2d/BiasAdd" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/convolutional.py" source_line=268}
  %add.226 = f16[1,98,98,64]{3,2,1,0} add(f16[1,98,98,64]{3,2,1,0} %convolution.224, f16[1,98,98,64]{3,2,1,0} %broadcast.225), metadata={op_type="BiasAdd" op_name="while/model/scores/conv2d/BiasAdd" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/convolutional.py" source_line=268}
  %custom-call.227 = f16[1,98,98,64]{3,2,1,0} custom-call(f16[1,98,98,64]{3,2,1,0} %add.226), custom_call_target="Relu", metadata={op_type="Relu" op_name="while/model/scores/conv2d/Relu" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4712}, backend_config="null"
  %custom-call.228 = f16[1,49,49,64]{3,2,1,0} custom-call(f16[1,98,98,64]{3,2,1,0} %custom-call.227), custom_call_target="MaxPool", metadata={op_type="MaxPool" op_name="while/model/scores/max_pooling2d/MaxPool" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/pooling.py" source_line=360}, backend_config="{\n\t\"window\" : \"{\\\"dimensions\\\":[{\\\"size\\\":\\\"1\\\",\\\"stride\\\":\\\"1\\\",\\\"padding_low\\\":\\\"0\\\",\\\"padding_high\\\":\\\"0\\\",\\\"window_dilation\\\":\\\"1\\\",\\\"base_dilation\\\":\\\"1\\\",\\\"window_reversal\\\":false},{\\\"size\\\":\\\"2\\\",\\\"stride\\\":\\\"2\\\",\\\"padding_low\\\":\\\"0\\\",\\\"padding_high\\\":\\\"0\\\",\\\"window_dilation\\\":\\\"1\\\",\\\"base_dilation\\\":\\\"1\\\",\\\"window_reversal\\\":false},{\\\"size\\\":\\\"2\\\",\\\"stride\\\":\\\"2\\\",\\\"padding_low\\\":\\\"0\\\",\\\"padding_high\\\":\\\"0\\\",\\\"window_dilation\\\":\\\"1\\\",\\\"base_dilation\\\":\\\"1\\\",\\\"window_reversal\\\":false},{\\\"size\\\":\\\"1\\\",\\\"stride\\\":\\\"1\\\",\\\"padding_low\\\":\\\"0\\\",\\\"padding_high\\\":\\\"0\\\",\\\"window_dilation\\\":\\\"1\\\",\\\"base_dilation\\\":\\\"1\\\",\\\"window_reversal\\\":false}]}\"\n}"
  %reshape.230 = f16[1,153664]{1,0} reshape(f16[1,49,49,64]{3,2,1,0} %custom-call.228), metadata={op_type="Reshape" op_name="while/model/scores/flatten/Reshape" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/core.py" source_line=674}
  %get-tuple-element.140 = f16[153664,100]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.132), index=7
  %dot.231 = f16[1,100]{1,0} dot(f16[1,153664]{1,0} %reshape.230, f16[153664,100]{1,0} %get-tuple-element.140), lhs_contracting_dims={1}, rhs_contracting_dims={0}, metadata={op_type="MatMul" op_name="while/model/scores/dense/MatMul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/core.py" source_line=1229}
  %transpose.232 = f16[1,100]{1,0} transpose(f16[1,100]{1,0} %dot.231), dimensions={0,1}, metadata={op_type="MatMul" op_name="while/model/scores/dense/MatMul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/core.py" source_line=1229}
  %get-tuple-element.141 = f16[100]{0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.132), index=8
  %broadcast.233 = f16[1,100]{1,0} broadcast(f16[100]{0} %get-tuple-element.141), dimensions={1}, metadata={op_type="BiasAdd" op_name="while/model/scores/dense/BiasAdd" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/core.py" source_line=1240}
  %add.234 = f16[1,100]{1,0} add(f16[1,100]{1,0} %transpose.232, f16[1,100]{1,0} %broadcast.233), metadata={op_type="BiasAdd" op_name="while/model/scores/dense/BiasAdd" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/core.py" source_line=1240}
  %convert.235 = f32[1,100]{1,0} convert(f16[1,100]{1,0} %add.234), metadata={op_type="Mean" op_name="while/model/scores/layer_normalization/moments/mean" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %constant.236 = f32[] constant(0), metadata={op_type="Mean" op_name="while/model/scores/layer_normalization/moments/mean" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %convert.237 = f32[] convert(f32[] %constant.236), metadata={op_type="Mean" op_name="while/model/scores/layer_normalization/moments/mean" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %reduce.238 = f32[1]{0} reduce(f32[1,100]{1,0} %convert.235, f32[] %convert.237), dimensions={1}, to_apply=%while_model_scores_layer_normalization_moments_mean-reduction.35, metadata={op_type="Mean" op_name="while/model/scores/layer_normalization/moments/mean" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %constant.239 = s32[] constant(100), metadata={op_type="Mean" op_name="while/model/scores/layer_normalization/moments/mean" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %convert.240 = f32[] convert(s32[] %constant.239), metadata={op_type="Mean" op_name="while/model/scores/layer_normalization/moments/mean" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %broadcast.241 = f32[1]{0} broadcast(f32[] %convert.240), dimensions={}, metadata={op_type="Mean" op_name="while/model/scores/layer_normalization/moments/mean" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %divide.242 = f32[1]{0} divide(f32[1]{0} %reduce.238, f32[1]{0} %broadcast.241), metadata={op_type="Mean" op_name="while/model/scores/layer_normalization/moments/mean" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %convert.243 = f16[1]{0} convert(f32[1]{0} %divide.242), metadata={op_type="Mean" op_name="while/model/scores/layer_normalization/moments/mean" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %reshape.244 = f16[1,1]{1,0} reshape(f16[1]{0} %convert.243), metadata={op_type="Mean" op_name="while/model/scores/layer_normalization/moments/mean" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %reshape.245 = f16[1]{0} reshape(f16[1,1]{1,0} %reshape.244), metadata={op_type="SquaredDifference" op_name="while/model/scores/layer_normalization/moments/SquaredDifference" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %broadcast.246 = f16[1,100]{1,0} broadcast(f16[1]{0} %reshape.245), dimensions={0}, metadata={op_type="SquaredDifference" op_name="while/model/scores/layer_normalization/moments/SquaredDifference" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %subtract.247 = f16[1,100]{1,0} subtract(f16[1,100]{1,0} %add.234, f16[1,100]{1,0} %broadcast.246), metadata={op_type="SquaredDifference" op_name="while/model/scores/layer_normalization/moments/SquaredDifference" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %multiply.248 = f16[1,100]{1,0} multiply(f16[1,100]{1,0} %subtract.247, f16[1,100]{1,0} %subtract.247), metadata={op_type="SquaredDifference" op_name="while/model/scores/layer_normalization/moments/SquaredDifference" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %convert.249 = f32[1,100]{1,0} convert(f16[1,100]{1,0} %multiply.248), metadata={op_type="Mean" op_name="while/model/scores/layer_normalization/moments/variance" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %constant.250 = f32[] constant(0), metadata={op_type="Mean" op_name="while/model/scores/layer_normalization/moments/variance" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %convert.251 = f32[] convert(f32[] %constant.250), metadata={op_type="Mean" op_name="while/model/scores/layer_normalization/moments/variance" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %reduce.252 = f32[1]{0} reduce(f32[1,100]{1,0} %convert.249, f32[] %convert.251), dimensions={1}, to_apply=%while_model_scores_layer_normalization_moments_variance-reduction.39, metadata={op_type="Mean" op_name="while/model/scores/layer_normalization/moments/variance" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %constant.253 = s32[] constant(100), metadata={op_type="Mean" op_name="while/model/scores/layer_normalization/moments/variance" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %convert.254 = f32[] convert(s32[] %constant.253), metadata={op_type="Mean" op_name="while/model/scores/layer_normalization/moments/variance" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %broadcast.255 = f32[1]{0} broadcast(f32[] %convert.254), dimensions={}, metadata={op_type="Mean" op_name="while/model/scores/layer_normalization/moments/variance" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %divide.256 = f32[1]{0} divide(f32[1]{0} %reduce.252, f32[1]{0} %broadcast.255), metadata={op_type="Mean" op_name="while/model/scores/layer_normalization/moments/variance" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %convert.257 = f16[1]{0} convert(f32[1]{0} %divide.256), metadata={op_type="Mean" op_name="while/model/scores/layer_normalization/moments/variance" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %reshape.258 = f16[1,1]{1,0} reshape(f16[1]{0} %convert.257), metadata={op_type="Mean" op_name="while/model/scores/layer_normalization/moments/variance" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=283}
  %constant.260 = f16[] constant(0.0010004), metadata={op_type="AddV2" op_name="while/model/scores/layer_normalization/batchnorm/add" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=294}
  %broadcast.261 = f16[1,1]{1,0} broadcast(f16[] %constant.260), dimensions={}, metadata={op_type="AddV2" op_name="while/model/scores/layer_normalization/batchnorm/add" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=294}
  %add.262 = f16[1,1]{1,0} add(f16[1,1]{1,0} %reshape.258, f16[1,1]{1,0} %broadcast.261), metadata={op_type="AddV2" op_name="while/model/scores/layer_normalization/batchnorm/add" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=294}
  %rsqrt.263 = f16[1,1]{1,0} rsqrt(f16[1,1]{1,0} %add.262), metadata={op_name="while/model/scores/layer_normalization/batchnorm/Rsqrt"}
  %reshape.265 = f16[1]{0} reshape(f16[1,1]{1,0} %rsqrt.263), metadata={op_type="Mul" op_name="while/model/scores/layer_normalization/batchnorm/mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=294}
  %broadcast.266 = f16[1,100]{1,0} broadcast(f16[1]{0} %reshape.265), dimensions={0}, metadata={op_type="Mul" op_name="while/model/scores/layer_normalization/batchnorm/mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=294}
  %get-tuple-element.142 = f16[100]{0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.132), index=9
  %broadcast.264 = f16[1,100]{1,0} broadcast(f16[100]{0} %get-tuple-element.142), dimensions={1}, metadata={op_type="Mul" op_name="while/model/scores/layer_normalization/batchnorm/mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=294}
  %multiply.267 = f16[1,100]{1,0} multiply(f16[1,100]{1,0} %broadcast.266, f16[1,100]{1,0} %broadcast.264), metadata={op_type="Mul" op_name="while/model/scores/layer_normalization/batchnorm/mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=294}
  %multiply.268 = f16[1,100]{1,0} multiply(f16[1,100]{1,0} %add.234, f16[1,100]{1,0} %multiply.267), metadata={op_type="Mul" op_name="while/model/scores/layer_normalization/batchnorm/mul_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=294}
  %get-tuple-element.143 = f16[100]{0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.132), index=10
  %broadcast.272 = f16[1,100]{1,0} broadcast(f16[100]{0} %get-tuple-element.143), dimensions={1}, metadata={op_type="Sub" op_name="while/model/scores/layer_normalization/batchnorm/sub" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=294}
  %reshape.269 = f16[1]{0} reshape(f16[1,1]{1,0} %reshape.244), metadata={op_type="Mul" op_name="while/model/scores/layer_normalization/batchnorm/mul_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=294}
  %broadcast.270 = f16[1,100]{1,0} broadcast(f16[1]{0} %reshape.269), dimensions={0}, metadata={op_type="Mul" op_name="while/model/scores/layer_normalization/batchnorm/mul_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=294}
  %multiply.271 = f16[1,100]{1,0} multiply(f16[1,100]{1,0} %broadcast.270, f16[1,100]{1,0} %multiply.267), metadata={op_type="Mul" op_name="while/model/scores/layer_normalization/batchnorm/mul_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=294}
  %subtract.273 = f16[1,100]{1,0} subtract(f16[1,100]{1,0} %broadcast.272, f16[1,100]{1,0} %multiply.271), metadata={op_type="Sub" op_name="while/model/scores/layer_normalization/batchnorm/sub" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=294}
  %add.274 = f16[1,100]{1,0} add(f16[1,100]{1,0} %multiply.268, f16[1,100]{1,0} %subtract.273), metadata={op_type="AddV2" op_name="while/model/scores/layer_normalization/batchnorm/add_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/normalization/layer_normalization.py" source_line=294}
  %custom-call.275 = f16[1,100]{1,0} custom-call(f16[1,100]{1,0} %add.274), custom_call_target="Relu", metadata={op_type="Relu" op_name="while/model/scores/activation/Relu" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4712}, backend_config="null"
  %get-tuple-element.144 = f16[100,10]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.132), index=11
  %dot.276 = f16[1,10]{1,0} dot(f16[1,100]{1,0} %custom-call.275, f16[100,10]{1,0} %get-tuple-element.144), lhs_contracting_dims={1}, rhs_contracting_dims={0}, metadata={op_type="MatMul" op_name="while/model/scores/dense_1/MatMul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/core.py" source_line=1229}
  %transpose.277 = f16[1,10]{1,0} transpose(f16[1,10]{1,0} %dot.276), dimensions={0,1}, metadata={op_type="MatMul" op_name="while/model/scores/dense_1/MatMul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/core.py" source_line=1229}
  %get-tuple-element.145 = f16[10]{0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.132), index=12
  %broadcast.278 = f16[1,10]{1,0} broadcast(f16[10]{0} %get-tuple-element.145), dimensions={1}, metadata={op_type="BiasAdd" op_name="while/model/scores/dense_1/BiasAdd" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/core.py" source_line=1240}
  %add.279 = f16[1,10]{1,0} add(f16[1,10]{1,0} %transpose.277, f16[1,10]{1,0} %broadcast.278), metadata={op_type="BiasAdd" op_name="while/model/scores/dense_1/BiasAdd" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/layers/core.py" source_line=1240}
  %constant.281 = f16[] constant(-inf), metadata={op_type="Softmax" op_name="while/model/scores/dense_1/Softmax" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/activations.py" source_line=80}
  %reduce.282 = f16[1]{0} reduce(f16[1,10]{1,0} %add.279, f16[] %constant.281), dimensions={1}, to_apply=%region_0.43, metadata={op_name="while/model/scores/dense_1/Softmax"}
  %reshape.283 = f16[1,1]{1,0} reshape(f16[1]{0} %reduce.282), metadata={op_name="while/model/scores/dense_1/Softmax"}
  %broadcast.284 = f16[1,1]{1,0} broadcast(f16[1,1]{1,0} %reshape.283), dimensions={0,1}, metadata={op_name="while/model/scores/dense_1/Softmax"}
  %reshape.285 = f16[1]{0} reshape(f16[1,1]{1,0} %broadcast.284), metadata={op_name="while/model/scores/dense_1/Softmax"}
  %broadcast.286 = f16[1,10]{1,0} broadcast(f16[1]{0} %reshape.285), dimensions={0}, metadata={op_name="while/model/scores/dense_1/Softmax"}
  %subtract.287 = f16[1,10]{1,0} subtract(f16[1,10]{1,0} %add.279, f16[1,10]{1,0} %broadcast.286), metadata={op_name="while/model/scores/dense_1/Softmax"}
  %exponential.288 = f16[1,10]{1,0} exponential(f16[1,10]{1,0} %subtract.287), metadata={op_name="while/model/scores/dense_1/Softmax"}
  %convert.289 = f32[1,10]{1,0} convert(f16[1,10]{1,0} %exponential.288), metadata={op_name="while/model/scores/dense_1/Softmax"}
  %constant.280 = f32[] constant(0), metadata={op_type="Softmax" op_name="while/model/scores/dense_1/Softmax" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/activations.py" source_line=80}
  %reduce.290 = f32[1]{0} reduce(f32[1,10]{1,0} %convert.289, f32[] %constant.280), dimensions={1}, to_apply=%region_1.47, metadata={op_name="while/model/scores/dense_1/Softmax"}
  %convert.291 = f16[1]{0} convert(f32[1]{0} %reduce.290), metadata={op_name="while/model/scores/dense_1/Softmax"}
  %reshape.292 = f16[1,1]{1,0} reshape(f16[1]{0} %convert.291), metadata={op_name="while/model/scores/dense_1/Softmax"}
  %broadcast.293 = f16[1,1]{1,0} broadcast(f16[1,1]{1,0} %reshape.292), dimensions={0,1}, metadata={op_name="while/model/scores/dense_1/Softmax"}
  %reshape.294 = f16[1]{0} reshape(f16[1,1]{1,0} %broadcast.293), metadata={op_name="while/model/scores/dense_1/Softmax"}
  %broadcast.295 = f16[1,10]{1,0} broadcast(f16[1]{0} %reshape.294), dimensions={0}, metadata={op_name="while/model/scores/dense_1/Softmax"}
  %divide.296 = f16[1,10]{1,0} divide(f16[1,10]{1,0} %exponential.288, f16[1,10]{1,0} %broadcast.295), metadata={op_name="while/model/scores/dense_1/Softmax"}
  %constant.297 = s32[2]{0} constant({-1, 10}), metadata={op_type="Reshape" op_name="while/sparse_categorical_crossentropy/Reshape_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4952}
  %constant.348 = f16[1,1]{1,0} constant({ {1} }), metadata={op_type="Mul" op_name="gradient_tape/while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.353 = s32[2]{0} constant({1, 10}), metadata={op_type="Reshape" op_name="gradient_tape/while/sparse_categorical_crossentropy/Reshape" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.372 = s32[] constant(1), metadata={op_type="Reshape" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul_2/Reshape" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.373 = s32[2]{0} broadcast(s32[] %constant.372), dimensions={}, metadata={op_type="Reshape" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul_2/Reshape" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.375 = s32[] constant(1), metadata={op_type="Reshape" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Reshape_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.376 = s32[2]{0} broadcast(s32[] %constant.375), dimensions={}, metadata={op_type="Reshape" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Reshape_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.378 = s32[2]{0} constant({1, 100}), metadata={op_type="Tile" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Tile_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.382 = f16[] constant(100), metadata={op_type="RealDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/truediv_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.397 = s32[] constant(1), metadata={op_type="Reshape" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul/Reshape" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.398 = s32[2]{0} broadcast(s32[] %constant.397), dimensions={}, metadata={op_type="Reshape" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul/Reshape" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.406 = s32[] constant(1), metadata={op_type="Reshape" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Reshape" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.407 = s32[2]{0} broadcast(s32[] %constant.406), dimensions={}, metadata={op_type="Reshape" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Reshape" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.409 = s32[2]{0} constant({1, 100}), metadata={op_type="Tile" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Tile" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.413 = f16[] constant(100), metadata={op_type="RealDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/truediv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.417 = f16[] constant(2), metadata={op_type="Mul" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.430 = s32[] constant(1), metadata={op_type="Reshape" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Reshape_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.431 = s32[2]{0} broadcast(s32[] %constant.430), dimensions={}, metadata={op_type="Reshape" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Reshape_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.418 = f16[] constant(2), metadata={op_type="Mul" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.419 = f16[1,100]{1,0} broadcast(f16[] %constant.418), dimensions={}, metadata={op_type="Mul" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %multiply.403 = f16[1,1]{1,0} multiply(f16[1,1]{1,0} %rsqrt.263, f16[1,1]{1,0} %rsqrt.263), metadata={op_type="RsqrtGrad" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/RsqrtGrad" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %multiply.404 = f16[1,1]{1,0} multiply(f16[1,1]{1,0} %multiply.403, f16[1,1]{1,0} %rsqrt.263), metadata={op_type="RsqrtGrad" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/RsqrtGrad" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.349 = f16[1,1]{1,0} constant({ {1} }), metadata={op_type="Mul" op_name="gradient_tape/while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reshape.350 = f16[1]{0} reshape(f16[1,1]{1,0} %constant.349), metadata={op_type="Mul" op_name="gradient_tape/while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.351 = f16[1,10]{1,0} broadcast(f16[1]{0} %reshape.350), dimensions={0}, metadata={op_type="Mul" op_name="gradient_tape/while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reshape.298 = f16[1,10]{1,0} reshape(f16[1,10]{1,0} %add.279), metadata={op_type="Reshape" op_name="while/sparse_categorical_crossentropy/Reshape_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4952}
  %constant.321 = f16[] constant(-inf), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %reduce.322 = f16[1]{0} reduce(f16[1,10]{1,0} %reshape.298, f16[] %constant.321), dimensions={1}, to_apply=%max_half_.51, metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %broadcast.323 = f16[1,10]{1,0} broadcast(f16[1]{0} %reduce.322), dimensions={0}, metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %subtract.324 = f16[1,10]{1,0} subtract(f16[1,10]{1,0} %reshape.298, f16[1,10]{1,0} %broadcast.323), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %exponential.325 = f16[1,10]{1,0} exponential(f16[1,10]{1,0} %subtract.324), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %convert.326 = f32[1,10]{1,0} convert(f16[1,10]{1,0} %exponential.325), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %constant.327 = f32[] constant(0), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %reduce.328 = f32[1]{0} reduce(f32[1,10]{1,0} %convert.326, f32[] %constant.327), dimensions={1}, to_apply=%add_float_.55, metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %convert.329 = f16[1]{0} convert(f32[1]{0} %reduce.328), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %broadcast.345 = f16[1,10]{1,0} broadcast(f16[1]{0} %convert.329), dimensions={0}, metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %divide.346 = f16[1,10]{1,0} divide(f16[1,10]{1,0} %exponential.325, f16[1,10]{1,0} %broadcast.345), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %get-tuple-element.192 = s32[1]{0} get-tuple-element((f16[1,100,100,3]{3,2,1,0}, s32[1]{0}) %get-tuple-element.190), index=1, metadata={op_type="PopDatastreamInfeedDequeue" op_name="while/PopDatastreamInfeedDequeue" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_pop_datastream_ops.py" source_line=1198}
  %reshape.193 = s32[1,1]{1,0} reshape(s32[1]{0} %get-tuple-element.192), metadata={op_type="ExpandDims" op_name="while/ExpandDims" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/engine/data_adapter.py" source_line=1449}
  %convert.194 = f16[1,1]{1,0} convert(s32[1,1]{1,0} %reshape.193), metadata={op_type="Cast" op_name="while/sparse_categorical_crossentropy/Cast" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/losses.py" source_line=1737}
  %convert.195 = s64[1,1]{1,0} convert(f16[1,1]{1,0} %convert.194), metadata={op_type="Cast" op_name="while/sparse_categorical_crossentropy/Cast_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=1823}
  %reshape.197 = s64[1]{0} reshape(s64[1,1]{1,0} %convert.195), metadata={op_type="Reshape" op_name="while/sparse_categorical_crossentropy/Reshape" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=3406}
  %broadcast.304 = s64[1,10]{1,0} broadcast(s64[1]{0} %reshape.197), dimensions={0}, metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %iota.303 = s64[1,10]{1,0} iota(), iota_dimension=1, metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %compare.305 = pred[1,10]{1,0} compare(s64[1,10]{1,0} %broadcast.304, s64[1,10]{1,0} %iota.303), direction=EQ, metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %constant.300 = f16[] constant(1), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %broadcast.302 = f16[1,10]{1,0} broadcast(f16[] %constant.300), dimensions={}, metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %constant.299 = f16[] constant(0), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %broadcast.301 = f16[1,10]{1,0} broadcast(f16[] %constant.299), dimensions={}, metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %select.306 = f16[1,10]{1,0} select(pred[1,10]{1,0} %compare.305, f16[1,10]{1,0} %broadcast.302, f16[1,10]{1,0} %broadcast.301), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %constant.314 = s64[] constant(0), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %broadcast.315 = s64[1]{0} broadcast(s64[] %constant.314), dimensions={}, metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %compare.316 = pred[1]{0} compare(s64[1]{0} %broadcast.315, s64[1]{0} %reshape.197), direction=LE, metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %constant.311 = s64[] constant(10), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %broadcast.312 = s64[1]{0} broadcast(s64[] %constant.311), dimensions={}, metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %compare.313 = pred[1]{0} compare(s64[1]{0} %reshape.197, s64[1]{0} %broadcast.312), direction=LT, metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %and.317 = pred[1]{0} and(pred[1]{0} %compare.316, pred[1]{0} %compare.313), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %constant.309 = f16[] constant(0), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %broadcast.310 = f16[1]{0} broadcast(f16[] %constant.309), dimensions={}, metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %constant.307 = f16[] constant(nan), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %broadcast.308 = f16[1]{0} broadcast(f16[] %constant.307), dimensions={}, metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %select.318 = f16[1]{0} select(pred[1]{0} %and.317, f16[1]{0} %broadcast.310, f16[1]{0} %broadcast.308), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %broadcast.319 = f16[1,10]{1,0} broadcast(f16[1]{0} %select.318), dimensions={0}, metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %add.320 = f16[1,10]{1,0} add(f16[1,10]{1,0} %select.306, f16[1,10]{1,0} %broadcast.319), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %subtract.347 = f16[1,10]{1,0} subtract(f16[1,10]{1,0} %divide.346, f16[1,10]{1,0} %add.320), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %multiply.352 = f16[1,10]{1,0} multiply(f16[1,10]{1,0} %broadcast.351, f16[1,10]{1,0} %subtract.347), metadata={op_type="Mul" op_name="gradient_tape/while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reshape.354 = f16[1,10]{1,0} reshape(f16[1,10]{1,0} %multiply.352), metadata={op_type="Reshape" op_name="gradient_tape/while/sparse_categorical_crossentropy/Reshape" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %dot.360 = f16[1,100]{1,0} dot(f16[1,10]{1,0} %reshape.354, f16[100,10]{1,0} %get-tuple-element.144), lhs_contracting_dims={1}, rhs_contracting_dims={1}, metadata={op_type="MatMul" op_name="gradient_tape/while/model/scores/dense_1/MatMul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %transpose.361 = f16[1,100]{1,0} transpose(f16[1,100]{1,0} %dot.360), dimensions={0,1}, metadata={op_type="MatMul" op_name="gradient_tape/while/model/scores/dense_1/MatMul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %custom-call.362 = f16[1,100]{1,0} custom-call(f16[1,100]{1,0} %custom-call.275, f16[1,100]{1,0} %transpose.361), custom_call_target="ReluGrad", metadata={op_type="ReluGrad" op_name="gradient_tape/while/model/scores/activation/ReluGrad" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}, backend_config="null"
  %multiply.364 = f16[1,100]{1,0} multiply(f16[1,100]{1,0} %add.234, f16[1,100]{1,0} %custom-call.362), metadata={op_type="Mul" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul_1/Mul_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reshape.386 = f16[1]{0} reshape(f16[1,1]{1,0} %reshape.244), metadata={op_type="Mul" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul_2/Mul_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.387 = f16[1,100]{1,0} broadcast(f16[1]{0} %reshape.386), dimensions={0}, metadata={op_type="Mul" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul_2/Mul_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %negate.365 = f16[1,100]{1,0} negate(f16[1,100]{1,0} %custom-call.362), metadata={op_type="Neg" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/sub/Neg" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %multiply.388 = f16[1,100]{1,0} multiply(f16[1,100]{1,0} %broadcast.387, f16[1,100]{1,0} %negate.365), metadata={op_type="Mul" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul_2/Mul_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %add.389 = f16[1,100]{1,0} add(f16[1,100]{1,0} %multiply.364, f16[1,100]{1,0} %multiply.388), metadata={op_type="AddN" op_name="while/SGD/gradients/AddN" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.390 = f16[1,100]{1,0} broadcast(f16[100]{0} %get-tuple-element.142), dimensions={1}, metadata={op_type="Mul" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul/Mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %multiply.391 = f16[1,100]{1,0} multiply(f16[1,100]{1,0} %add.389, f16[1,100]{1,0} %broadcast.390), metadata={op_type="Mul" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul/Mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %convert.392 = f32[1,100]{1,0} convert(f16[1,100]{1,0} %multiply.391), metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.393 = f32[] constant(0), metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %convert.394 = f32[] convert(f32[] %constant.393), metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reduce.395 = f32[] reduce(f32[1,100]{1,0} %convert.392, f32[] %convert.394), dimensions={0,1}, to_apply=%gradient_tape_while_model_scores_layer_normalization_batchnorm_mul_Sum-reduction.75, metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %convert.396 = f16[] convert(f32[] %reduce.395), metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reshape.399 = f16[1,1]{1,0} reshape(f16[] %convert.396), metadata={op_type="Reshape" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul/Reshape" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.400 = f16[] constant(-2), metadata={op_type="RsqrtGrad" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/RsqrtGrad" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.401 = f16[1,1]{1,0} broadcast(f16[] %constant.400), dimensions={}, metadata={op_type="RsqrtGrad" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/RsqrtGrad" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %divide.402 = f16[1,1]{1,0} divide(f16[1,1]{1,0} %reshape.399, f16[1,1]{1,0} %broadcast.401), metadata={op_type="RsqrtGrad" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/RsqrtGrad" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %multiply.405 = f16[1,1]{1,0} multiply(f16[1,1]{1,0} %multiply.404, f16[1,1]{1,0} %divide.402), metadata={op_type="RsqrtGrad" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/RsqrtGrad" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reshape.408 = f16[1,1]{1,0} reshape(f16[1,1]{1,0} %multiply.405), metadata={op_type="Reshape" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Reshape" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.410 = f16[1,1]{1,0} broadcast(f16[1,1]{1,0} %reshape.408), dimensions={0,1}, metadata={op_type="Tile" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Tile" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reshape.411 = f16[1]{0} reshape(f16[1,1]{1,0} %broadcast.410), metadata={op_type="Tile" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Tile" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.412 = f16[1,100]{1,0} broadcast(f16[1]{0} %reshape.411), dimensions={0}, metadata={op_type="Tile" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Tile" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.414 = f16[] constant(100), metadata={op_type="RealDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/truediv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.415 = f16[1,100]{1,0} broadcast(f16[] %constant.414), dimensions={}, metadata={op_type="RealDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/truediv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %divide.416 = f16[1,100]{1,0} divide(f16[1,100]{1,0} %broadcast.412, f16[1,100]{1,0} %broadcast.415), metadata={op_type="RealDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/truediv" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %multiply.420 = f16[1,100]{1,0} multiply(f16[1,100]{1,0} %broadcast.419, f16[1,100]{1,0} %divide.416), metadata={op_type="Mul" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reshape.421 = f16[1]{0} reshape(f16[1,1]{1,0} %reshape.244), metadata={op_type="Sub" op_name="gradient_tape/while/model/scores/layer_normalization/moments/sub" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.422 = f16[1,100]{1,0} broadcast(f16[1]{0} %reshape.421), dimensions={0}, metadata={op_type="Sub" op_name="gradient_tape/while/model/scores/layer_normalization/moments/sub" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %subtract.423 = f16[1,100]{1,0} subtract(f16[1,100]{1,0} %add.234, f16[1,100]{1,0} %broadcast.422), metadata={op_type="Sub" op_name="gradient_tape/while/model/scores/layer_normalization/moments/sub" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %multiply.424 = f16[1,100]{1,0} multiply(f16[1,100]{1,0} %multiply.420, f16[1,100]{1,0} %subtract.423), metadata={op_type="Mul" op_name="gradient_tape/while/model/scores/layer_normalization/moments/mul_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %convert.425 = f32[1,100]{1,0} convert(f16[1,100]{1,0} %multiply.424), metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.426 = f32[] constant(0), metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %convert.427 = f32[] convert(f32[] %constant.426), metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reduce.428 = f32[] reduce(f32[1,100]{1,0} %convert.425, f32[] %convert.427), dimensions={0,1}, to_apply=%gradient_tape_while_model_scores_layer_normalization_moments_Sum-reduction.79, metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %convert.429 = f16[] convert(f32[] %reduce.428), metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reshape.432 = f16[1,1]{1,0} reshape(f16[] %convert.429), metadata={op_type="Reshape" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Reshape_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %negate.433 = f16[1,1]{1,0} negate(f16[1,1]{1,0} %reshape.432), metadata={op_type="Neg" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Neg" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.443 = s32[4]{0} constant({1, 49, 49, 64}), metadata={op_type="Reshape" op_name="gradient_tape/while/model/scores/flatten/Reshape" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %multiply.363 = f16[1,100]{1,0} multiply(f16[1,100]{1,0} %custom-call.362, f16[1,100]{1,0} %multiply.267), metadata={op_type="Mul" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul_1/Mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %add.434 = f16[1,100]{1,0} add(f16[1,100]{1,0} %multiply.363, f16[1,100]{1,0} %multiply.424), metadata={op_type="AddN" op_name="while/SGD/gradients/AddN_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %multiply.366 = f16[1,100]{1,0} multiply(f16[1,100]{1,0} %negate.365, f16[1,100]{1,0} %multiply.267), metadata={op_type="Mul" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul_2/Mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %convert.367 = f32[1,100]{1,0} convert(f16[1,100]{1,0} %multiply.366), metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul_2/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.368 = f32[] constant(0), metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul_2/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %convert.369 = f32[] convert(f32[] %constant.368), metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul_2/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reduce.370 = f32[] reduce(f32[1,100]{1,0} %convert.367, f32[] %convert.369), dimensions={0,1}, to_apply=%gradient_tape_while_model_scores_layer_normalization_batchnorm_mul_2_Sum-reduction.71, metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul_2/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %convert.371 = f16[] convert(f32[] %reduce.370), metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul_2/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reshape.374 = f16[1,1]{1,0} reshape(f16[] %convert.371), metadata={op_type="Reshape" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul_2/Reshape" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reshape.377 = f16[1,1]{1,0} reshape(f16[1,1]{1,0} %reshape.374), metadata={op_type="Reshape" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Reshape_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.379 = f16[1,1]{1,0} broadcast(f16[1,1]{1,0} %reshape.377), dimensions={0,1}, metadata={op_type="Tile" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Tile_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reshape.380 = f16[1]{0} reshape(f16[1,1]{1,0} %broadcast.379), metadata={op_type="Tile" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Tile_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.381 = f16[1,100]{1,0} broadcast(f16[1]{0} %reshape.380), dimensions={0}, metadata={op_type="Tile" op_name="gradient_tape/while/model/scores/layer_normalization/moments/Tile_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.383 = f16[] constant(100), metadata={op_type="RealDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/truediv_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.384 = f16[1,100]{1,0} broadcast(f16[] %constant.383), dimensions={}, metadata={op_type="RealDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/truediv_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %divide.385 = f16[1,100]{1,0} divide(f16[1,100]{1,0} %broadcast.381, f16[1,100]{1,0} %broadcast.384), metadata={op_type="RealDiv" op_name="gradient_tape/while/model/scores/layer_normalization/moments/truediv_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %add.435 = f16[1,100]{1,0} add(f16[1,100]{1,0} %add.434, f16[1,100]{1,0} %divide.385), metadata={op_type="AddN" op_name="while/SGD/gradients/AddN_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %dot.441 = f16[1,153664]{1,0} dot(f16[1,100]{1,0} %add.435, f16[153664,100]{1,0} %get-tuple-element.140), lhs_contracting_dims={1}, rhs_contracting_dims={1}, metadata={op_type="MatMul" op_name="gradient_tape/while/model/scores/dense/MatMul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %transpose.442 = f16[1,153664]{1,0} transpose(f16[1,153664]{1,0} %dot.441), dimensions={0,1}, metadata={op_type="MatMul" op_name="gradient_tape/while/model/scores/dense/MatMul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reshape.444 = f16[1,49,49,64]{3,2,1,0} reshape(f16[1,153664]{1,0} %transpose.442), metadata={op_type="Reshape" op_name="gradient_tape/while/model/scores/flatten/Reshape" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %custom-call.445 = f16[1,98,98,64]{3,2,1,0} custom-call(f16[1,98,98,64]{3,2,1,0} %custom-call.227, f16[1,49,49,64]{3,2,1,0} %custom-call.228, f16[1,49,49,64]{3,2,1,0} %reshape.444), custom_call_target="MaxPoolGrad", metadata={op_type="MaxPoolGrad" op_name="gradient_tape/while/model/scores/max_pooling2d/MaxPool/MaxPoolGrad" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}, backend_config="{\n\t\"window\" : \"{\\\"dimensions\\\":[{\\\"size\\\":\\\"1\\\",\\\"stride\\\":\\\"1\\\",\\\"padding_low\\\":\\\"0\\\",\\\"padding_high\\\":\\\"0\\\",\\\"window_dilation\\\":\\\"1\\\",\\\"base_dilation\\\":\\\"1\\\",\\\"window_reversal\\\":false},{\\\"size\\\":\\\"2\\\",\\\"stride\\\":\\\"2\\\",\\\"padding_low\\\":\\\"0\\\",\\\"padding_high\\\":\\\"0\\\",\\\"window_dilation\\\":\\\"1\\\",\\\"base_dilation\\\":\\\"1\\\",\\\"window_reversal\\\":false},{\\\"size\\\":\\\"2\\\",\\\"stride\\\":\\\"2\\\",\\\"padding_low\\\":\\\"0\\\",\\\"padding_high\\\":\\\"0\\\",\\\"window_dilation\\\":\\\"1\\\",\\\"base_dilation\\\":\\\"1\\\",\\\"window_reversal\\\":false},{\\\"size\\\":\\\"1\\\",\\\"stride\\\":\\\"1\\\",\\\"padding_low\\\":\\\"0\\\",\\\"padding_high\\\":\\\"0\\\",\\\"window_dilation\\\":\\\"1\\\",\\\"base_dilation\\\":\\\"1\\\",\\\"window_reversal\\\":false}]}\"\n}"
  %custom-call.446 = f16[1,98,98,64]{3,2,1,0} custom-call(f16[1,98,98,64]{3,2,1,0} %custom-call.227, f16[1,98,98,64]{3,2,1,0} %custom-call.445), custom_call_target="ReluGrad", metadata={op_type="ReluGrad" op_name="gradient_tape/while/model/scores/conv2d/ReluGrad" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}, backend_config="null"
  %reverse.454 = f16[3,3,3,64]{3,2,1,0} reverse(f16[3,3,3,64]{3,2,1,0} %get-tuple-element.138), dimensions={0,1}, metadata={op_type="Conv2DBackpropInput" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/Conv2DBackpropInput" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %convolution.455 = f16[1,100,100,3]{3,2,1,0} convolution(f16[1,98,98,64]{3,2,1,0} %custom-call.446, f16[3,3,3,64]{3,2,1,0} %reverse.454), window={size=3x3 pad=2_2x2_2}, dim_labels=b01f_01oi->b01f, metadata={op_type="Conv2DBackpropInput" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/Conv2DBackpropInput" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.467 = s32[1]{0} constant({100}), metadata={op_type="Reshape" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul/Reshape_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.475 = s32[1]{0} constant({100}), metadata={op_type="Reshape" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/sub/Reshape" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.482 = f32[] constant(1), metadata={op_type="Mul" op_name="while/sparse_categorical_crossentropy/weighted_loss/Mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=321}
  %constant.492 = f32[] constant(1), metadata={op_type="DivNoNan" op_name="gradient_tape/while/sparse_categorical_crossentropy/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.500 = f32[] constant(1), metadata={op_type="DivNoNan" op_name="gradient_tape/while/sparse_categorical_crossentropy/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.508 = f32[] constant(1), metadata={op_type="Mul" op_name="gradient_tape/while/sparse_categorical_crossentropy/weighted_loss/value/mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.511 = s32[0]{0} constant({}), metadata={op_type="Reshape" op_name="gradient_tape/while/sparse_categorical_crossentropy/weighted_loss/value/Reshape_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.509 = f32[] constant(1), metadata={op_type="Mul" op_name="gradient_tape/while/sparse_categorical_crossentropy/weighted_loss/value/mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.501 = f32[] constant(1), metadata={op_type="DivNoNan" op_name="gradient_tape/while/sparse_categorical_crossentropy/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.502 = f32[] constant(0), metadata={op_type="DivNoNan" op_name="gradient_tape/while/sparse_categorical_crossentropy/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %compare.503 = pred[] compare(f32[] %constant.501, f32[] %constant.502), direction=EQ, metadata={op_type="DivNoNan" op_name="gradient_tape/while/sparse_categorical_crossentropy/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.504 = f32[] constant(0), metadata={op_type="DivNoNan" op_name="gradient_tape/while/sparse_categorical_crossentropy/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.505 = f32[] broadcast(f32[] %constant.504), dimensions={}, metadata={op_type="DivNoNan" op_name="gradient_tape/while/sparse_categorical_crossentropy/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.493 = f32[] constant(1), metadata={op_type="DivNoNan" op_name="gradient_tape/while/sparse_categorical_crossentropy/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.494 = f32[] constant(0), metadata={op_type="DivNoNan" op_name="gradient_tape/while/sparse_categorical_crossentropy/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %compare.495 = pred[] compare(f32[] %constant.493, f32[] %constant.494), direction=EQ, metadata={op_type="DivNoNan" op_name="gradient_tape/while/sparse_categorical_crossentropy/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.496 = f32[] constant(0), metadata={op_type="DivNoNan" op_name="gradient_tape/while/sparse_categorical_crossentropy/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.497 = f32[] broadcast(f32[] %constant.496), dimensions={}, metadata={op_type="DivNoNan" op_name="gradient_tape/while/sparse_categorical_crossentropy/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %negate.339 = f16[1,10]{1,0} negate(f16[1,10]{1,0} %add.320), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %constant.335 = f16[] constant(0), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %broadcast.336 = f16[1,10]{1,0} broadcast(f16[] %constant.335), dimensions={}, metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %compare.337 = pred[1,10]{1,0} compare(f16[1,10]{1,0} %add.320, f16[1,10]{1,0} %broadcast.336), direction=EQ, metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %constant.333 = f16[] constant(0), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %broadcast.334 = f16[1,10]{1,0} broadcast(f16[] %constant.333), dimensions={}, metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %log.330 = f16[1]{0} log(f16[1]{0} %convert.329), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %broadcast.331 = f16[1,10]{1,0} broadcast(f16[1]{0} %log.330), dimensions={0}, metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %subtract.332 = f16[1,10]{1,0} subtract(f16[1,10]{1,0} %subtract.324, f16[1,10]{1,0} %broadcast.331), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %select.338 = f16[1,10]{1,0} select(pred[1,10]{1,0} %compare.337, f16[1,10]{1,0} %broadcast.334, f16[1,10]{1,0} %subtract.332), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %multiply.340 = f16[1,10]{1,0} multiply(f16[1,10]{1,0} %negate.339, f16[1,10]{1,0} %select.338), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %convert.342 = f32[1,10]{1,0} convert(f16[1,10]{1,0} %multiply.340), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %constant.341 = f32[] constant(0), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %reduce.343 = f32[1]{0} reduce(f32[1,10]{1,0} %convert.342, f32[] %constant.341), dimensions={1}, to_apply=%add_float_.59, metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %convert.344 = f16[1]{0} convert(f32[1]{0} %reduce.343), metadata={op_type="SparseSoftmaxCrossEntropyWithLogits" op_name="while/sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/backend.py" source_line=4957}
  %convert.481 = f32[1]{0} convert(f16[1]{0} %convert.344), metadata={op_type="Cast" op_name="while/sparse_categorical_crossentropy/weighted_loss/Cast" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=316}
  %constant.483 = f32[] constant(1), metadata={op_type="Mul" op_name="while/sparse_categorical_crossentropy/weighted_loss/Mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=321}
  %broadcast.484 = f32[1]{0} broadcast(f32[] %constant.483), dimensions={}, metadata={op_type="Mul" op_name="while/sparse_categorical_crossentropy/weighted_loss/Mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=321}
  %multiply.485 = f32[1]{0} multiply(f32[1]{0} %convert.481, f32[1]{0} %broadcast.484), metadata={op_type="Mul" op_name="while/sparse_categorical_crossentropy/weighted_loss/Mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=321}
  %convert.486 = f32[1]{0} convert(f32[1]{0} %multiply.485), metadata={op_type="Sum" op_name="while/sparse_categorical_crossentropy/weighted_loss/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=265}
  %constant.487 = f32[] constant(0), metadata={op_type="Sum" op_name="while/sparse_categorical_crossentropy/weighted_loss/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=265}
  %convert.488 = f32[] convert(f32[] %constant.487), metadata={op_type="Sum" op_name="while/sparse_categorical_crossentropy/weighted_loss/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=265}
  %reduce.489 = f32[] reduce(f32[1]{0} %convert.486, f32[] %convert.488), dimensions={0}, to_apply=%while_sparse_categorical_crossentropy_weighted_loss_Sum-reduction.127, metadata={op_type="Sum" op_name="while/sparse_categorical_crossentropy/weighted_loss/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=265}
  %convert.490 = f32[] convert(f32[] %reduce.489), metadata={op_type="Sum" op_name="while/sparse_categorical_crossentropy/weighted_loss/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=265}
  %negate.491 = f32[] negate(f32[] %convert.490), metadata={op_type="Neg" op_name="gradient_tape/while/sparse_categorical_crossentropy/weighted_loss/value/Neg" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %divide.498 = f32[] divide(f32[] %negate.491, f32[] %constant.493), metadata={op_type="DivNoNan" op_name="gradient_tape/while/sparse_categorical_crossentropy/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %select.499 = f32[] select(pred[] %compare.495, f32[] %broadcast.497, f32[] %divide.498), metadata={op_type="DivNoNan" op_name="gradient_tape/while/sparse_categorical_crossentropy/weighted_loss/value/div_no_nan_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %divide.506 = f32[] divide(f32[] %select.499, f32[] %constant.501), metadata={op_type="DivNoNan" op_name="gradient_tape/while/sparse_categorical_crossentropy/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %select.507 = f32[] select(pred[] %compare.503, f32[] %broadcast.505, f32[] %divide.506), metadata={op_type="DivNoNan" op_name="gradient_tape/while/sparse_categorical_crossentropy/weighted_loss/value/div_no_nan_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %multiply.510 = f32[] multiply(f32[] %constant.509, f32[] %select.507), metadata={op_type="Mul" op_name="gradient_tape/while/sparse_categorical_crossentropy/weighted_loss/value/mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reshape.512 = f32[] reshape(f32[] %multiply.510), metadata={op_type="Reshape" op_name="gradient_tape/while/sparse_categorical_crossentropy/weighted_loss/value/Reshape_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.513 = f32[] constant(1), metadata={op_type="DivNoNan" op_name="while/sparse_categorical_crossentropy/weighted_loss/value" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=250}
  %constant.522 = f16[] constant(1), metadata={op_type="Mul" op_name="while/Mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=421}
  %get-tuple-element.147 = f16[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.132), index=14
  %constant.526 = f16[] constant(1), metadata={op_type="AssignAddVariableOp" op_name="while/AssignAddVariableOp_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=444}
  %add.527 = f16[] add(f16[] %get-tuple-element.147, f16[] %constant.526), metadata={op_type="AssignAddVariableOp" op_name="while/AssignAddVariableOp_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=444}
  %constant.528 = f16[] constant(0), metadata={op_type="DivNoNan" op_name="while/div_no_nan" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=453}
  %compare.529 = pred[] compare(f16[] %add.527, f16[] %constant.528), direction=EQ, metadata={op_type="DivNoNan" op_name="while/div_no_nan" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=453}
  %constant.530 = f16[] constant(0), metadata={op_type="DivNoNan" op_name="while/div_no_nan" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=453}
  %broadcast.531 = f16[] broadcast(f16[] %constant.530), dimensions={}, metadata={op_type="DivNoNan" op_name="while/div_no_nan" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=453}
  %get-tuple-element.146 = f16[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.132), index=13
  %constant.514 = f32[] constant(1), metadata={op_type="DivNoNan" op_name="while/sparse_categorical_crossentropy/weighted_loss/value" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=250}
  %constant.515 = f32[] constant(0), metadata={op_type="DivNoNan" op_name="while/sparse_categorical_crossentropy/weighted_loss/value" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=250}
  %compare.516 = pred[] compare(f32[] %constant.514, f32[] %constant.515), direction=EQ, metadata={op_type="DivNoNan" op_name="while/sparse_categorical_crossentropy/weighted_loss/value" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=250}
  %constant.517 = f32[] constant(0), metadata={op_type="DivNoNan" op_name="while/sparse_categorical_crossentropy/weighted_loss/value" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=250}
  %broadcast.518 = f32[] broadcast(f32[] %constant.517), dimensions={}, metadata={op_type="DivNoNan" op_name="while/sparse_categorical_crossentropy/weighted_loss/value" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=250}
  %divide.519 = f32[] divide(f32[] %convert.490, f32[] %constant.514), metadata={op_type="DivNoNan" op_name="while/sparse_categorical_crossentropy/weighted_loss/value" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=250}
  %select.520 = f32[] select(pred[] %compare.516, f32[] %broadcast.518, f32[] %divide.519), metadata={op_type="DivNoNan" op_name="while/sparse_categorical_crossentropy/weighted_loss/value" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=250}
  %convert.521 = f16[] convert(f32[] %select.520), metadata={op_type="Cast" op_name="while/sparse_categorical_crossentropy/weighted_loss/Cast_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/utils/losses_utils.py" source_line=326}
  %constant.523 = f16[] constant(1), metadata={op_type="Mul" op_name="while/Mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=421}
  %multiply.524 = f16[] multiply(f16[] %convert.521, f16[] %constant.523), metadata={op_type="Mul" op_name="while/Mul" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=421}
  %add.525 = f16[] add(f16[] %get-tuple-element.146, f16[] %multiply.524), metadata={op_type="AssignAddVariableOp" op_name="while/AssignAddVariableOp" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=425}
  %divide.532 = f16[] divide(f16[] %add.525, f16[] %add.527), metadata={op_type="DivNoNan" op_name="while/div_no_nan" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=453}
  %select.533 = f16[] select(pred[] %compare.529, f16[] %broadcast.531, f16[] %divide.532), metadata={op_type="DivNoNan" op_name="while/div_no_nan" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/metrics.py" source_line=453}
  %after-all.534 = token[] after-all(), metadata={op_type="PopDatastreamOutfeedEnqueue" op_name="while/PopDatastreamOutfeedEnqueue" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_pop_datastream_ops.py" source_line=1519}
  %outfeed.535 = token[] outfeed(f16[] %select.533, token[] %after-all.534), outfeed_shape=f16[], outfeed_config="\022\0012\"\001\023(\003", metadata={op_type="PopDatastreamOutfeedEnqueue" op_name="while/PopDatastreamOutfeedEnqueue" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_pop_datastream_ops.py" source_line=1519}
  %constant.536 = s32[] constant(1), metadata={op_type="AddV2" op_name="while/add" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.149 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.132), index=16
  %convert.539 = f16[] convert(s32[] %get-tuple-element.149), metadata={op_type="Cast" op_name="while/SGD/Cast_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=793}
  %constant.567 = s32[] constant(1), metadata={op_type="AddV2" op_name="while/add_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.133 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.132), index=0
  %constant.568 = s32[] constant(1), metadata={op_type="AddV2" op_name="while/add_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %add.569 = s32[] add(s32[] %get-tuple-element.133, s32[] %constant.568), metadata={op_type="AddV2" op_name="while/add_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.134 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.132), index=1
  %get-tuple-element.135 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.132), index=2
  %constant.537 = s32[] constant(1), metadata={op_type="AddV2" op_name="while/add" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %add.538 = s32[] add(s32[] %get-tuple-element.135, s32[] %constant.537), metadata={op_type="AddV2" op_name="while/add" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.136 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.132), index=3
  %get-tuple-element.137 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.132), index=4
  %get-tuple-element.148 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.132), index=15
  %convert.540 = f16[] convert(f32[] %get-tuple-element.148), metadata={op_type="Cast" op_name="while/SGD/Cast" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=793}
  %broadcast.541 = f16[3,3,3,64]{3,2,1,0} broadcast(f16[] %convert.540), dimensions={}, metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %convolution.452 = f16[3,3,3,64]{3,2,1,0} convolution(f16[1,100,100,3]{3,2,1,0} %get-tuple-element.191, f16[1,98,98,64]{3,2,1,0} %custom-call.446), window={size=98x98}, dim_labels=f01b_i01o->01bf, metadata={op_type="Conv2DBackpropFilter" op_name="gradient_tape/while/model/scores/conv2d/Conv2D/Conv2DBackpropFilter" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %all-reduce.453 = f16[3,3,3,64]{3,2,1,0} all-reduce(f16[3,3,3,64]{3,2,1,0} %convolution.452), replica_groups={}, to_apply=%sum.99, metadata={op_type="IpuCrossReplicaSum" op_name="while/SGD/IpuCrossReplicaSum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_popops_ops.py" source_line=486}
  %multiply.542 = f16[3,3,3,64]{3,2,1,0} multiply(f16[3,3,3,64]{3,2,1,0} %broadcast.541, f16[3,3,3,64]{3,2,1,0} %all-reduce.453), metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %subtract.543 = f16[3,3,3,64]{3,2,1,0} subtract(f16[3,3,3,64]{3,2,1,0} %get-tuple-element.138, f16[3,3,3,64]{3,2,1,0} %multiply.542), metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %tuple.570 = (f16[3,3,3,64]{3,2,1,0}) tuple(f16[3,3,3,64]{3,2,1,0} %subtract.543), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.571 = f16[3,3,3,64]{3,2,1,0} get-tuple-element((f16[3,3,3,64]{3,2,1,0}) %tuple.570), index=0, metadata={op_name="XLA_Retvals"}
  %broadcast.544 = f16[64]{0} broadcast(f16[] %convert.540), dimensions={}, metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update_1/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %convert.448 = f32[1,98,98,64]{3,2,1,0} convert(f16[1,98,98,64]{3,2,1,0} %custom-call.446), metadata={op_name="gradient_tape/while/model/scores/conv2d/BiasAdd/BiasAddGrad"}
  %constant.447 = f32[] constant(0), metadata={op_type="BiasAddGrad" op_name="gradient_tape/while/model/scores/conv2d/BiasAdd/BiasAddGrad" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reduce.449 = f32[64]{0} reduce(f32[1,98,98,64]{3,2,1,0} %convert.448, f32[] %constant.447), dimensions={0,1,2}, to_apply=%region_0.91, metadata={op_name="gradient_tape/while/model/scores/conv2d/BiasAdd/BiasAddGrad"}
  %convert.450 = f16[64]{0} convert(f32[64]{0} %reduce.449), metadata={op_name="gradient_tape/while/model/scores/conv2d/BiasAdd/BiasAddGrad"}
  %all-reduce.451 = f16[64]{0} all-reduce(f16[64]{0} %convert.450), replica_groups={}, to_apply=%sum.95, metadata={op_type="IpuCrossReplicaSum" op_name="while/SGD/IpuCrossReplicaSum_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_popops_ops.py" source_line=486}
  %multiply.545 = f16[64]{0} multiply(f16[64]{0} %broadcast.544, f16[64]{0} %all-reduce.451), metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update_1/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %subtract.546 = f16[64]{0} subtract(f16[64]{0} %get-tuple-element.139, f16[64]{0} %multiply.545), metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update_1/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %tuple.572 = (f16[64]{0}) tuple(f16[64]{0} %subtract.546), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.573 = f16[64]{0} get-tuple-element((f16[64]{0}) %tuple.572), index=0, metadata={op_name="XLA_Retvals"}
  %broadcast.547 = f16[153664,100]{1,0} broadcast(f16[] %convert.540), dimensions={}, metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update_2/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %dot.456 = f16[153664,100]{1,0} dot(f16[1,153664]{1,0} %reshape.230, f16[1,100]{1,0} %add.435), lhs_contracting_dims={0}, rhs_contracting_dims={0}, metadata={op_type="MatMul" op_name="gradient_tape/while/model/scores/dense/MatMul_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %transpose.457 = f16[153664,100]{1,0} transpose(f16[153664,100]{1,0} %dot.456), dimensions={0,1}, metadata={op_type="MatMul" op_name="gradient_tape/while/model/scores/dense/MatMul_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %all-reduce.458 = f16[153664,100]{1,0} all-reduce(f16[153664,100]{1,0} %transpose.457), replica_groups={}, to_apply=%sum.103, metadata={op_type="IpuCrossReplicaSum" op_name="while/SGD/IpuCrossReplicaSum_2" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_popops_ops.py" source_line=486}
  %multiply.548 = f16[153664,100]{1,0} multiply(f16[153664,100]{1,0} %broadcast.547, f16[153664,100]{1,0} %all-reduce.458), metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update_2/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %subtract.549 = f16[153664,100]{1,0} subtract(f16[153664,100]{1,0} %get-tuple-element.140, f16[153664,100]{1,0} %multiply.548), metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update_2/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %tuple.574 = (f16[153664,100]{1,0}) tuple(f16[153664,100]{1,0} %subtract.549), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.575 = f16[153664,100]{1,0} get-tuple-element((f16[153664,100]{1,0}) %tuple.574), index=0, metadata={op_name="XLA_Retvals"}
  %broadcast.550 = f16[100]{0} broadcast(f16[] %convert.540), dimensions={}, metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update_3/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %convert.437 = f32[1,100]{1,0} convert(f16[1,100]{1,0} %add.435), metadata={op_name="gradient_tape/while/model/scores/dense/BiasAdd/BiasAddGrad"}
  %constant.436 = f32[] constant(0), metadata={op_type="BiasAddGrad" op_name="gradient_tape/while/model/scores/dense/BiasAdd/BiasAddGrad" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reduce.438 = f32[100]{0} reduce(f32[1,100]{1,0} %convert.437, f32[] %constant.436), dimensions={0}, to_apply=%region_0.83, metadata={op_name="gradient_tape/while/model/scores/dense/BiasAdd/BiasAddGrad"}
  %convert.439 = f16[100]{0} convert(f32[100]{0} %reduce.438), metadata={op_name="gradient_tape/while/model/scores/dense/BiasAdd/BiasAddGrad"}
  %all-reduce.440 = f16[100]{0} all-reduce(f16[100]{0} %convert.439), replica_groups={}, to_apply=%sum.87, metadata={op_type="IpuCrossReplicaSum" op_name="while/SGD/IpuCrossReplicaSum_3" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_popops_ops.py" source_line=486}
  %multiply.551 = f16[100]{0} multiply(f16[100]{0} %broadcast.550, f16[100]{0} %all-reduce.440), metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update_3/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %subtract.552 = f16[100]{0} subtract(f16[100]{0} %get-tuple-element.141, f16[100]{0} %multiply.551), metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update_3/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %tuple.576 = (f16[100]{0}) tuple(f16[100]{0} %subtract.552), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.577 = f16[100]{0} get-tuple-element((f16[100]{0}) %tuple.576), index=0, metadata={op_name="XLA_Retvals"}
  %broadcast.553 = f16[100]{0} broadcast(f16[] %convert.540), dimensions={}, metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update_4/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %reshape.459 = f16[1]{0} reshape(f16[1,1]{1,0} %rsqrt.263), metadata={op_type="Mul" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul/Mul_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %broadcast.460 = f16[1,100]{1,0} broadcast(f16[1]{0} %reshape.459), dimensions={0}, metadata={op_type="Mul" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul/Mul_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %multiply.461 = f16[1,100]{1,0} multiply(f16[1,100]{1,0} %broadcast.460, f16[1,100]{1,0} %add.389), metadata={op_type="Mul" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul/Mul_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %convert.462 = f32[1,100]{1,0} convert(f16[1,100]{1,0} %multiply.461), metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul/Sum_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.463 = f32[] constant(0), metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul/Sum_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %convert.464 = f32[] convert(f32[] %constant.463), metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul/Sum_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reduce.465 = f32[100]{0} reduce(f32[1,100]{1,0} %convert.462, f32[] %convert.464), dimensions={0}, to_apply=%gradient_tape_while_model_scores_layer_normalization_batchnorm_mul_Sum_1-reduction.107, metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul/Sum_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %convert.466 = f16[100]{0} convert(f32[100]{0} %reduce.465), metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul/Sum_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reshape.468 = f16[100]{0} reshape(f16[100]{0} %convert.466), metadata={op_type="Reshape" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/mul/Reshape_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %all-reduce.469 = f16[100]{0} all-reduce(f16[100]{0} %reshape.468), replica_groups={}, to_apply=%sum.111, metadata={op_type="IpuCrossReplicaSum" op_name="while/SGD/IpuCrossReplicaSum_4" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_popops_ops.py" source_line=486}
  %multiply.554 = f16[100]{0} multiply(f16[100]{0} %broadcast.553, f16[100]{0} %all-reduce.469), metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update_4/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %subtract.555 = f16[100]{0} subtract(f16[100]{0} %get-tuple-element.142, f16[100]{0} %multiply.554), metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update_4/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %tuple.578 = (f16[100]{0}) tuple(f16[100]{0} %subtract.555), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.579 = f16[100]{0} get-tuple-element((f16[100]{0}) %tuple.578), index=0, metadata={op_name="XLA_Retvals"}
  %broadcast.556 = f16[100]{0} broadcast(f16[] %convert.540), dimensions={}, metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update_5/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %convert.470 = f32[1,100]{1,0} convert(f16[1,100]{1,0} %custom-call.362), metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/sub/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %constant.471 = f32[] constant(0), metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/sub/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %convert.472 = f32[] convert(f32[] %constant.471), metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/sub/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reduce.473 = f32[100]{0} reduce(f32[1,100]{1,0} %convert.470, f32[] %convert.472), dimensions={0}, to_apply=%gradient_tape_while_model_scores_layer_normalization_batchnorm_sub_Sum-reduction.115, metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/sub/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %convert.474 = f16[100]{0} convert(f32[100]{0} %reduce.473), metadata={op_type="Sum" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/sub/Sum" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reshape.476 = f16[100]{0} reshape(f16[100]{0} %convert.474), metadata={op_type="Reshape" op_name="gradient_tape/while/model/scores/layer_normalization/batchnorm/sub/Reshape" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %all-reduce.477 = f16[100]{0} all-reduce(f16[100]{0} %reshape.476), replica_groups={}, to_apply=%sum.119, metadata={op_type="IpuCrossReplicaSum" op_name="while/SGD/IpuCrossReplicaSum_5" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_popops_ops.py" source_line=486}
  %multiply.557 = f16[100]{0} multiply(f16[100]{0} %broadcast.556, f16[100]{0} %all-reduce.477), metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update_5/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %subtract.558 = f16[100]{0} subtract(f16[100]{0} %get-tuple-element.143, f16[100]{0} %multiply.557), metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update_5/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %tuple.580 = (f16[100]{0}) tuple(f16[100]{0} %subtract.558), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.581 = f16[100]{0} get-tuple-element((f16[100]{0}) %tuple.580), index=0, metadata={op_name="XLA_Retvals"}
  %broadcast.559 = f16[100,10]{1,0} broadcast(f16[] %convert.540), dimensions={}, metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update_6/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %dot.478 = f16[100,10]{1,0} dot(f16[1,100]{1,0} %custom-call.275, f16[1,10]{1,0} %reshape.354), lhs_contracting_dims={0}, rhs_contracting_dims={0}, metadata={op_type="MatMul" op_name="gradient_tape/while/model/scores/dense_1/MatMul_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %transpose.479 = f16[100,10]{1,0} transpose(f16[100,10]{1,0} %dot.478), dimensions={0,1}, metadata={op_type="MatMul" op_name="gradient_tape/while/model/scores/dense_1/MatMul_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %all-reduce.480 = f16[100,10]{1,0} all-reduce(f16[100,10]{1,0} %transpose.479), replica_groups={}, to_apply=%sum.123, metadata={op_type="IpuCrossReplicaSum" op_name="while/SGD/IpuCrossReplicaSum_6" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_popops_ops.py" source_line=486}
  %multiply.560 = f16[100,10]{1,0} multiply(f16[100,10]{1,0} %broadcast.559, f16[100,10]{1,0} %all-reduce.480), metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update_6/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %subtract.561 = f16[100,10]{1,0} subtract(f16[100,10]{1,0} %get-tuple-element.144, f16[100,10]{1,0} %multiply.560), metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update_6/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %tuple.582 = (f16[100,10]{1,0}) tuple(f16[100,10]{1,0} %subtract.561), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.583 = f16[100,10]{1,0} get-tuple-element((f16[100,10]{1,0}) %tuple.582), index=0, metadata={op_name="XLA_Retvals"}
  %broadcast.562 = f16[10]{0} broadcast(f16[] %convert.540), dimensions={}, metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update_7/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %convert.356 = f32[1,10]{1,0} convert(f16[1,10]{1,0} %reshape.354), metadata={op_name="gradient_tape/while/model/scores/dense_1/BiasAdd/BiasAddGrad"}
  %constant.355 = f32[] constant(0), metadata={op_type="BiasAddGrad" op_name="gradient_tape/while/model/scores/dense_1/BiasAdd/BiasAddGrad" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=454}
  %reduce.357 = f32[10]{0} reduce(f32[1,10]{1,0} %convert.356, f32[] %constant.355), dimensions={0}, to_apply=%region_0.63, metadata={op_name="gradient_tape/while/model/scores/dense_1/BiasAdd/BiasAddGrad"}
  %convert.358 = f16[10]{0} convert(f32[10]{0} %reduce.357), metadata={op_name="gradient_tape/while/model/scores/dense_1/BiasAdd/BiasAddGrad"}
  %all-reduce.359 = f16[10]{0} all-reduce(f16[10]{0} %convert.358), replica_groups={}, to_apply=%sum.67, metadata={op_type="IpuCrossReplicaSum" op_name="while/SGD/IpuCrossReplicaSum_7" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/tensorflow/compiler/plugin/poplar/ops/gen_popops_ops.py" source_line=486}
  %multiply.563 = f16[10]{0} multiply(f16[10]{0} %broadcast.562, f16[10]{0} %all-reduce.359), metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update_7/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %subtract.564 = f16[10]{0} subtract(f16[10]{0} %get-tuple-element.145, f16[10]{0} %multiply.563), metadata={op_type="ResourceApplyGradientDescent" op_name="while/SGD/SGD/update_7/ResourceApplyGradientDescent" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/gradient_descent.py" source_line=145}
  %tuple.584 = (f16[10]{0}) tuple(f16[10]{0} %subtract.564), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.585 = f16[10]{0} get-tuple-element((f16[10]{0}) %tuple.584), index=0, metadata={op_name="XLA_Retvals"}
  %tuple.586 = (f16[]) tuple(f16[] %add.525), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.587 = f16[] get-tuple-element((f16[]) %tuple.586), index=0, metadata={op_name="XLA_Retvals"}
  %tuple.588 = (f16[]) tuple(f16[] %add.527), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.589 = f16[] get-tuple-element((f16[]) %tuple.588), index=0, metadata={op_name="XLA_Retvals"}
  %tuple.590 = (f32[]) tuple(f32[] %get-tuple-element.148), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.591 = f32[] get-tuple-element((f32[]) %tuple.590), index=0, metadata={op_name="XLA_Retvals"}
  %tuple.592 = (s32[]) tuple(s32[] %get-tuple-element.149), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.593 = s32[] get-tuple-element((s32[]) %tuple.592), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.150 = s64[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.132), index=17
  %constant.565 = s64[] constant(1), metadata={op_type="AssignAddVariableOp" op_name="while/SGD/SGD/AssignAddVariableOp" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=725}
  %add.566 = s64[] add(s64[] %get-tuple-element.150, s64[] %constant.565), metadata={op_type="AssignAddVariableOp" op_name="while/SGD/SGD/AssignAddVariableOp" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/optimizer_v2/optimizer_v2.py" source_line=725}
  %tuple.594 = (s64[]) tuple(s64[] %add.566), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.595 = s64[] get-tuple-element((s64[]) %tuple.594), index=0, metadata={op_name="XLA_Retvals"}
  ROOT %tuple.596 = (s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) tuple(s32[] %add.569, s32[] %get-tuple-element.134, s32[] %add.538, s32[] %get-tuple-element.136, s32[] %get-tuple-element.137, /*index=5*/f16[3,3,3,64]{3,2,1,0} %get-tuple-element.571, f16[64]{0} %get-tuple-element.573, f16[153664,100]{1,0} %get-tuple-element.575, f16[100]{0} %get-tuple-element.577, f16[100]{0} %get-tuple-element.579, /*index=10*/f16[100]{0} %get-tuple-element.581, f16[100,10]{1,0} %get-tuple-element.583, f16[10]{0} %get-tuple-element.585, f16[] %get-tuple-element.587, f16[] %get-tuple-element.589, /*index=15*/f32[] %get-tuple-element.591, s32[] %get-tuple-element.593, s64[] %get-tuple-element.595), metadata={op_name="XLA_Retvals"}
}

%while_cond_576_const_0_rearrange_0__.597 (arg_tuple.598: (s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64], f16[64], f16[153664,100], f16[100], f16[100], /*index=10*/f16[100], f16[100,10], f16[10], f16[], f16[], /*index=15*/f32[], s32[], s64[])) -> (pred[]) {
  %arg_tuple.598 = (s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) parameter(0), metadata={op_name="XLA_Args"}
  %get-tuple-element.600 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.598), index=1
  %get-tuple-element.602 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.598), index=3
  %get-tuple-element.603 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.598), index=4
  %get-tuple-element.604 = f16[3,3,3,64]{3,2,1,0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.598), index=5
  %get-tuple-element.605 = f16[64]{0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.598), index=6
  %get-tuple-element.606 = f16[153664,100]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.598), index=7
  %get-tuple-element.607 = f16[100]{0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.598), index=8
  %get-tuple-element.608 = f16[100]{0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.598), index=9
  %get-tuple-element.609 = f16[100]{0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.598), index=10
  %get-tuple-element.610 = f16[100,10]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.598), index=11
  %get-tuple-element.611 = f16[10]{0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.598), index=12
  %get-tuple-element.612 = f16[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.598), index=13
  %get-tuple-element.613 = f16[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.598), index=14
  %get-tuple-element.614 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.598), index=15
  %get-tuple-element.615 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.598), index=16
  %get-tuple-element.616 = s64[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.598), index=17
  %constant.617 = s32[] constant(250), metadata={op_type="Less" op_name="while/Less" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.620 = s32[] constant(250), metadata={op_type="Less" op_name="while/Less_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.599 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.598), index=0
  %constant.621 = s32[] constant(250), metadata={op_type="Less" op_name="while/Less_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %compare.622 = pred[] compare(s32[] %get-tuple-element.599, s32[] %constant.621), direction=LT, metadata={op_type="Less" op_name="while/Less_1" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.601 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %arg_tuple.598), index=2
  %constant.618 = s32[] constant(250), metadata={op_type="Less" op_name="while/Less" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %compare.619 = pred[] compare(s32[] %get-tuple-element.601, s32[] %constant.618), direction=LT, metadata={op_type="Less" op_name="while/Less" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %and.623 = pred[] and(pred[] %compare.622, pred[] %compare.619), metadata={op_type="LogicalAnd" op_name="while/LogicalAnd" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  ROOT %tuple.624 = (pred[]) tuple(pred[] %and.623), metadata={op_name="XLA_Retvals"}
}

%cond_wrapper.625 (inputs.626: (s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64], f16[64], f16[153664,100], f16[100], f16[100], /*index=10*/f16[100], f16[100,10], f16[10], f16[], f16[], /*index=15*/f32[], s32[], s64[])) -> pred[] {
  %inputs.626 = (s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) parameter(0)
  %call.627 = (pred[]) call((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %inputs.626), to_apply=%while_cond_576_const_0_rearrange_0__.597
  ROOT %get-tuple-element.628 = pred[] get-tuple-element((pred[]) %call.627), index=0
}

ENTRY %a_inference_train_function_880__XlaMustCompile_true_config_proto___n_007_n_0...02_001_000__executor_type____.699 (arg0.1: f16[3,3,3,64], arg1.2: f16[64], arg2.3: f16[153664,100], arg3.4: f16[100], arg4.5: f16[100], arg5.6: f16[100], arg6.7: f16[100,10], arg7.8: f16[10], arg8.9: f16[], arg9.10: f16[], arg10.11: f32[], arg11.12: s32[], arg12.13: s64[]) -> (f16[3,3,3,64], f16[64], f16[153664,100], f16[100], f16[100], /*index=5*/f16[100], f16[100,10], f16[10], f16[], f16[], /*index=10*/s64[]) {
  %constant.14 = s32[] constant(0), metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.15 = s32[] constant(250), metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.16 = s32[] constant(1), metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.21 = s32[] constant(0), metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %broadcast.22 = s32[250]{0} broadcast(s32[] %constant.21), dimensions={}, metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.18 = s32[] constant(1), metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %broadcast.19 = s32[250]{0} broadcast(s32[] %constant.18), dimensions={}, metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %iota.17 = s32[250]{0} iota(), iota_dimension=0, metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %multiply.20 = s32[250]{0} multiply(s32[250]{0} %broadcast.19, s32[250]{0} %iota.17), metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %add.23 = s32[250]{0} add(s32[250]{0} %broadcast.22, s32[250]{0} %multiply.20), metadata={op_type="Range" op_name="range" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.24 = s32[] constant(0), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.25 = s32[] constant(250), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.26 = s32[] constant(0), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.27 = s32[] constant(250), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.28 = s32[] constant(1), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.29 = s32[] constant(0), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.30 = s32[] constant(250), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.31 = s32[] constant(0), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.32 = s32[] constant(250), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %constant.33 = s32[] constant(1), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %arg0.1 = f16[3,3,3,64]{3,2,1,0} parameter(0), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar3"}
  %arg1.2 = f16[64]{0} parameter(1), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar4"}
  %arg2.3 = f16[153664,100]{1,0} parameter(2), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar5"}
  %arg3.4 = f16[100]{0} parameter(3), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar6"}
  %arg4.5 = f16[100]{0} parameter(4), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar7"}
  %arg5.6 = f16[100]{0} parameter(5), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar8"}
  %arg6.7 = f16[100,10]{1,0} parameter(6), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar9"}
  %arg7.8 = f16[10]{0} parameter(7), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar10"}
  %arg8.9 = f16[] parameter(8), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar14"}
  %arg9.10 = f16[] parameter(9), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar15"}
  %arg10.11 = f32[] parameter(10), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar19"}
  %arg11.12 = s32[] parameter(11), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar20"}
  %arg12.13 = s64[] parameter(12), parameter_replication={false}, metadata={op_name="XLA_Args/_AnonymousVar17"}
  %tuple.34 = (s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) tuple(s32[] %constant.29, s32[] %constant.30, s32[] %constant.31, s32[] %constant.32, s32[] %constant.33, /*index=5*/f16[3,3,3,64]{3,2,1,0} %arg0.1, f16[64]{0} %arg1.2, f16[153664,100]{1,0} %arg2.3, f16[100]{0} %arg3.4, f16[100]{0} %arg4.5, /*index=10*/f16[100]{0} %arg5.6, f16[100,10]{1,0} %arg6.7, f16[10]{0} %arg7.8, f16[] %arg8.9, f16[] %arg9.10, /*index=15*/f32[] %arg10.11, s32[] %arg11.12, s64[] %arg12.13), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %while.629 = (s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) while((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %tuple.34), condition=%cond_wrapper.625, body=%while_body_577_const_0_rearrange_0__.131, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.630 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %while.629), index=0, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.631 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %while.629), index=1, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.632 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %while.629), index=2, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.633 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %while.629), index=3, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.634 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %while.629), index=4, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.635 = f16[3,3,3,64]{3,2,1,0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %while.629), index=5, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.636 = f16[64]{0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %while.629), index=6, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.637 = f16[153664,100]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %while.629), index=7, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.638 = f16[100]{0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %while.629), index=8, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.639 = f16[100]{0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %while.629), index=9, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.640 = f16[100]{0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %while.629), index=10, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.641 = f16[100,10]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %while.629), index=11, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.642 = f16[10]{0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %while.629), index=12, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.643 = f16[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %while.629), index=13, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.644 = f16[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %while.629), index=14, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.645 = f32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %while.629), index=15, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.646 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %while.629), index=16, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.647 = s64[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %while.629), index=17, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %tuple.648 = (s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) tuple(s32[] %get-tuple-element.630, s32[] %get-tuple-element.631, s32[] %get-tuple-element.632, s32[] %get-tuple-element.633, s32[] %get-tuple-element.634, /*index=5*/f16[3,3,3,64]{3,2,1,0} %get-tuple-element.635, f16[64]{0} %get-tuple-element.636, f16[153664,100]{1,0} %get-tuple-element.637, f16[100]{0} %get-tuple-element.638, f16[100]{0} %get-tuple-element.639, /*index=10*/f16[100]{0} %get-tuple-element.640, f16[100,10]{1,0} %get-tuple-element.641, f16[10]{0} %get-tuple-element.642, f16[] %get-tuple-element.643, f16[] %get-tuple-element.644, /*index=15*/f32[] %get-tuple-element.645, s32[] %get-tuple-element.646, s64[] %get-tuple-element.647), metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.649 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %tuple.648), index=0, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.650 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %tuple.648), index=1, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.651 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %tuple.648), index=2, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.652 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %tuple.648), index=3, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.653 = s32[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %tuple.648), index=4, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %get-tuple-element.654 = f16[3,3,3,64]{3,2,1,0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %tuple.648), index=5, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %reshape.665 = f16[3,3,3,64]{3,2,1,0} reshape(f16[3,3,3,64]{3,2,1,0} %get-tuple-element.654), metadata={op_name="XLA_Retvals"}
  %tuple.666 = (f16[3,3,3,64]{3,2,1,0}) tuple(f16[3,3,3,64]{3,2,1,0} %reshape.665), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.667 = f16[3,3,3,64]{3,2,1,0} get-tuple-element((f16[3,3,3,64]{3,2,1,0}) %tuple.666), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.655 = f16[64]{0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %tuple.648), index=6, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %reshape.668 = f16[64]{0} reshape(f16[64]{0} %get-tuple-element.655), metadata={op_name="XLA_Retvals"}
  %tuple.669 = (f16[64]{0}) tuple(f16[64]{0} %reshape.668), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.670 = f16[64]{0} get-tuple-element((f16[64]{0}) %tuple.669), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.656 = f16[153664,100]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %tuple.648), index=7, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %reshape.671 = f16[153664,100]{1,0} reshape(f16[153664,100]{1,0} %get-tuple-element.656), metadata={op_name="XLA_Retvals"}
  %tuple.672 = (f16[153664,100]{1,0}) tuple(f16[153664,100]{1,0} %reshape.671), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.673 = f16[153664,100]{1,0} get-tuple-element((f16[153664,100]{1,0}) %tuple.672), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.657 = f16[100]{0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %tuple.648), index=8, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %reshape.674 = f16[100]{0} reshape(f16[100]{0} %get-tuple-element.657), metadata={op_name="XLA_Retvals"}
  %tuple.675 = (f16[100]{0}) tuple(f16[100]{0} %reshape.674), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.676 = f16[100]{0} get-tuple-element((f16[100]{0}) %tuple.675), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.658 = f16[100]{0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %tuple.648), index=9, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %reshape.677 = f16[100]{0} reshape(f16[100]{0} %get-tuple-element.658), metadata={op_name="XLA_Retvals"}
  %tuple.678 = (f16[100]{0}) tuple(f16[100]{0} %reshape.677), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.679 = f16[100]{0} get-tuple-element((f16[100]{0}) %tuple.678), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.659 = f16[100]{0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %tuple.648), index=10, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %reshape.680 = f16[100]{0} reshape(f16[100]{0} %get-tuple-element.659), metadata={op_name="XLA_Retvals"}
  %tuple.681 = (f16[100]{0}) tuple(f16[100]{0} %reshape.680), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.682 = f16[100]{0} get-tuple-element((f16[100]{0}) %tuple.681), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.660 = f16[100,10]{1,0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %tuple.648), index=11, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %reshape.683 = f16[100,10]{1,0} reshape(f16[100,10]{1,0} %get-tuple-element.660), metadata={op_name="XLA_Retvals"}
  %tuple.684 = (f16[100,10]{1,0}) tuple(f16[100,10]{1,0} %reshape.683), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.685 = f16[100,10]{1,0} get-tuple-element((f16[100,10]{1,0}) %tuple.684), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.661 = f16[10]{0} get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %tuple.648), index=12, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %reshape.686 = f16[10]{0} reshape(f16[10]{0} %get-tuple-element.661), metadata={op_name="XLA_Retvals"}
  %tuple.687 = (f16[10]{0}) tuple(f16[10]{0} %reshape.686), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.688 = f16[10]{0} get-tuple-element((f16[10]{0}) %tuple.687), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.662 = f16[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %tuple.648), index=13, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %reshape.689 = f16[] reshape(f16[] %get-tuple-element.662), metadata={op_name="XLA_Retvals"}
  %tuple.690 = (f16[]) tuple(f16[] %reshape.689), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.691 = f16[] get-tuple-element((f16[]) %tuple.690), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.663 = f16[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %tuple.648), index=14, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %reshape.692 = f16[] reshape(f16[] %get-tuple-element.663), metadata={op_name="XLA_Retvals"}
  %tuple.693 = (f16[]) tuple(f16[] %reshape.692), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.694 = f16[] get-tuple-element((f16[]) %tuple.693), index=0, metadata={op_name="XLA_Retvals"}
  %get-tuple-element.664 = s64[] get-tuple-element((s32[], s32[], s32[], s32[], s32[], /*index=5*/f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=10*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=15*/f32[], s32[], s64[]) %tuple.648), index=17, metadata={op_type="While" op_name="while" source_file="/localdata/babakk/tf2/test_env/lib/python3.6/site-packages/keras/ipu/extensions/extensions_base.py" source_line=503}
  %reshape.695 = s64[] reshape(s64[] %get-tuple-element.664), metadata={op_name="XLA_Retvals"}
  %tuple.696 = (s64[]) tuple(s64[] %reshape.695), metadata={op_name="XLA_Retvals"}
  %get-tuple-element.697 = s64[] get-tuple-element((s64[]) %tuple.696), index=0, metadata={op_name="XLA_Retvals"}
  ROOT %tuple.698 = (f16[3,3,3,64]{3,2,1,0}, f16[64]{0}, f16[153664,100]{1,0}, f16[100]{0}, f16[100]{0}, /*index=5*/f16[100]{0}, f16[100,10]{1,0}, f16[10]{0}, f16[], f16[], /*index=10*/s64[]) tuple(f16[3,3,3,64]{3,2,1,0} %get-tuple-element.667, f16[64]{0} %get-tuple-element.670, f16[153664,100]{1,0} %get-tuple-element.673, f16[100]{0} %get-tuple-element.676, f16[100]{0} %get-tuple-element.679, /*index=5*/f16[100]{0} %get-tuple-element.682, f16[100,10]{1,0} %get-tuple-element.685, f16[10]{0} %get-tuple-element.688, f16[] %get-tuple-element.691, f16[] %get-tuple-element.694, /*index=10*/s64[] %get-tuple-element.697), metadata={op_name="XLA_Retvals"}
}
)";

#endif  // TENSORFLOW_COMPILER_PLUGIN_POPLAR_TESTS_HLO_SAMPLES_T44634_HLO_H_
